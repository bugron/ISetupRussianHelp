<html><head><meta http-equiv=Content-Type content="text/html; charset=windows-1251"><title>Введение</title><style><!--@font-face{font-family:Helvetica;panose-1:2 11 5 4 2 2 2 2 2 4;}@font-face{font-family:Courier;panose-1:2 7 4 9 2 2 5 2 4 4;}@font-face{font-family:"Tms Rmn";panose-1:2 2 6 3 4 5 5 2 3 4;}@font-face{font-family:Helv;panose-1:2 11 6 4 2 2 2 3 2 4;}@font-face{font-family:"New York";panose-1:2 4 5 3 6 5 6 2 3 4;}@font-face{font-family:System;panose-1:0 0 0 0 0 0 0 0 0 0;}@font-face{font-family:Wingdings;panose-1:5 0 0 0 0 0 0 0 0 0;}@font-face{font-family:"MS Mincho";panose-1:2 2 6 9 4 2 5 8 3 4;}@font-face{font-family:Batang;panose-1:2 3 6 0 0 1 1 1 1 1;}@font-face{font-family:SimSun;panose-1:2 1 6 0 3 1 1 1 1 1;}@font-face{font-family:PMingLiU;panose-1:2 1 6 1 0 1 1 1 1 1;}@font-face{font-family:"MS Gothic";panose-1:2 11 6 9 7 2 5 8 2 4;}@font-face{font-family:Dotum;panose-1:2 11 6 0 0 1 1 1 1 1;}@font-face{font-family:SimHei;panose-1:2 1 6 0 3 1 1 1 1 1;}@font-face{font-family:MingLiU;panose-1:2 1 6 9 0 1 1 1 1 1;}@font-face{font-family:Mincho;panose-1:2 2 6 9 4 3 5 8 3 5;}@font-face{font-family:Gulim;panose-1:2 11 6 0 0 1 1 1 1 1;}@font-face{font-family:Century;panose-1:2 4 6 3 5 7 5 2 3 3;}@font-face{font-family:"Angsana New";panose-1:2 2 6 3 5 4 5 2 3 4;}@font-face{font-family:"Cordia New";panose-1:2 11 3 4 2 2 2 2 2 4;}@font-face{font-family:Mangal;panose-1:0 0 4 0 0 0 0 0 0 0;}@font-face{font-family:Latha;panose-1:2 0 4 0 0 0 0 0 0 0;}@font-face{font-family:Sylfaen;panose-1:1 10 5 2 5 3 6 3 3 3;}@font-face{font-family:Vrinda;panose-1:0 0 4 0 0 0 0 0 0 0;}@font-face{font-family:Raavi;panose-1:2 0 5 0 0 0 0 0 0 0;}@font-face{font-family:Shruti;panose-1:2 0 5 0 0 0 0 0 0 0;}@font-face{font-family:Sendnya;panose-1:0 0 4 0 0 0 0 0 0 0;}@font-face{font-family:Gautami;panose-1:2 0 5 0 0 0 0 0 0 0;}@font-face{font-family:Tunga;panose-1:0 0 4 0 0 0 0 0 0 0;}@font-face{font-family:"Estrangelo Edessa";panose-1:0 0 0 0 0 0 0 0 0 0;}@font-face{font-family:"Cambria Math";panose-1:2 4 5 3 5 4 6 3 2 4;}@font-face{font-family:"Arial Unicode MS";panose-1:2 11 6 4 2 2 2 2 2 4;}@font-face{font-family:Cambria;panose-1:2 4 5 3 5 4 6 3 2 4;}@font-face{font-family:Calibri;panose-1:2 15 5 2 2 2 4 3 2 4;}@font-face{font-family:Tahoma;panose-1:2 11 6 4 3 5 4 4 2 4;}@font-face{font-family:Verdana;panose-1:2 11 6 4 3 5 4 4 2 4;}p.MsoNormal,li.MsoNormal,div.MsoNormal{margin:0cm;margin-bottom:.0001pt;font-size:12.0pt;font-family:"Times New Roman","serif";}h1{margin:0cm;margin-bottom:.0001pt;text-indent:27.0pt;page-break-after:avoid;font-size:11.0pt;font-family:"Times New Roman","serif";}h2{margin:0cm;margin-bottom:.0001pt;text-indent:27.0pt;page-break-after:avoid;font-size:12.0pt;font-family:"Times New Roman","serif";}h3{margin:0cm;margin-bottom:.0001pt;text-align:center;text-indent:27.0pt;page-break-after:avoid;font-size:14.0pt;font-family:"Times New Roman","serif";}p.MsoTitle,li.MsoTitle,div.MsoTitle{margin:0cm;margin-bottom:.0001pt;text-align:center;text-indent:27.0pt;font-size:14.0pt;font-family:"Times New Roman","serif";}p.MsoBodyTextIndent,li.MsoBodyTextIndent,div.MsoBodyTextIndent{margin:0cm;margin-bottom:.0001pt;text-indent:27.0pt;font-size:11.0pt;font-family:"Times New Roman","serif";color:green;}p.MsoBodyTextIndent2,li.MsoBodyTextIndent2,div.MsoBodyTextIndent2{margin:0cm;margin-bottom:.0001pt;text-indent:27.0pt;font-size:11.0pt;font-family:"Times New Roman","serif";}p.MsoBodyTextIndent3,li.MsoBodyTextIndent3,div.MsoBodyTextIndent3{margin:0cm;margin-bottom:.0001pt;text-indent:27.0pt;font-size:11.0pt;font-family:"Times New Roman","serif";font-weight:bold;}a:link,span.MsoHyperlink{font-family:"Verdana","sans-serif";color:#0000C0;text-decoration:none none;}a:visited,span.MsoHyperlinkFollowed{color:purple;text-decoration:underline;}p.MsoAcetate,li.MsoAcetate,div.MsoAcetate{margin:0cm;margin-bottom:.0001pt;font-size:8.0pt;font-family:"Tahoma","sans-serif";}span.msoIns{mso-style-name:"";text-decoration:underline;color:teal;}span.msoDel{mso-style-name:"";text-decoration:line-through;color:red;}.MsoChpDefault{font-size:10.0pt;}@page WordSection1{size:595.3pt 841.9pt;margin:35.95pt 37.3pt 2.0cm 54.0pt;}div.WordSection1{page:WordSection1;}--></style></head><body lang=RU link=#0000C0 vlink=purple><div class=WordSection1><p class=MsoTitle align=left style=text-align:left><b><span style='font-size:
16.0pt'>Введение.</span></b></p><p class=MsoTitle>&nbsp;</p><p class=MsoTitle align=left style=text-align:left><b><span style='font-size:
11.0pt'>Кому предназначена статья?</span></b></p><p class=MsoTitle align=left style=text-align:left><span style='font-size:
11.0pt'>«Будешь читать литературу для «чайников» - станешь «чайником» - программистская мудрость. Моя статья написана для начинающих программистов (НЕ ДЛЯ «ЧАЙНИКОВ»!!!), ее цель – избавить их от долгих бесполезных кликаний мышью по кнопкам, пытаясь «вслепую» создать более-менее удобный инсталлятор для своей программы. Сразу предупреждаю: в статье не будет сложных примеров скриптов, заумных фраз и обилия терминов. Здесь собран только самый необходимый минимум, который сделает процесс написания инсталлятора простым и понятным.</span></p><p class=MsoTitle align=left style=text-align:left><span style='font-size:
12.0pt'>&nbsp;</span></p><p class=MsoTitle align=left style=text-align:left><b><span style='font-size:
11.0pt'>Зачем нужен </span></b><b><span lang=EN-US style=font-size:11.0pt>Inno</span></b><b><span lang=EN-US style=font-size:11.0pt> </span></b><b><span lang=EN-US style=font-size:11.0pt>Setup</span></b><b><span style=font-size:11.0pt>?</span></b></p><p class=MsoTitle align=left style=text-align:left><span style='font-size:
11.0pt'>Итак, после долгих дней, месяцев или даже лет кропотливой работы, вы все-таки написали рабочую программу. Да, возможно, она работает не совсем так, как вам хочется, но главное – ОНА РАБОТАЕТ! Теперь дело за малым: создать самораспаковывающийся архив и опубликовать ваше творение во всемирной паутине, чтобы человечество могло по достоинству оценить ваши труды. Но тут возникает вопрос: а что, если ваша программа имеет несколько вариантов установки (например, стандартная, минимальная и выборочная),  а еще хочется после установки программы поместить ее иконку на рабочий стол пользователя, добавить ее в автозапуск… А может быть после инсталляции пользователю следует перезагрузить компьютер… А может ему вообще не следует устанавливать вашу программу на свой компьютер, если он не наделен правами администратора? В принципе, многое можно реализовать при помощи тех же самораспаковывающихся архивов, но как долго вам придется с этим разбираться и не уйдет ли на создание инсталлятора времени больше, чем на создание самой программы? И не увеличится ли после этого в разы ее размер?</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Вот тут на помощь программисту и приходят готовые программы-инсталляторы, одним из которых является Inno Setup – с его помощью можно быстро создать удобный и простой инсталлятор.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>Совет.</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Для того, чтобы найти в статье ответ на интересующий Вас вопрос, автор советует прочесть ее всю. Это не займет много времени, зато Вы наверняка найдете то, что искали, совершенно в неожиданном месте – не потому, что статья не последовательна, а потому, что все секции </span><span lang=EN-US style=font-size:11.0pt>Inno</span><span lang=EN-US style=font-size:11.0pt> </span><span lang=EN-US style='font-size:
11.0pt'>Setup</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>связаны между собой настолько тесно, что очень трудно бывает отнести пример выполнения какой-либо задачи к описанию конкретной секции.</span></p><p class=MsoNormal align=center style=text-align:center><b><span style=font-size:16.0pt>&nbsp;</span></b></p><p class=MsoNormal align=center style=text-align:center><b><span style=font-size:16.0pt>Принятые обозначения</span></b></p><p class=MsoNormal align=center style=text-align:center><b><span style=font-size:16.0pt>&nbsp;</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Если имеется в виду </span><span lang=EN-US style=font-size:11.0pt>Inno</span><span lang=EN-US style=font-size:11.0pt> </span><span lang=EN-US style='font-size:
11.0pt'>Setup</span><span style=font-size:11.0pt>, в тексте он будет так и обозначен <b>– </b></span><b><span lang=EN-US style=font-size:11.0pt>Inno</span></b><b><span lang=EN-US style=font-size:11.0pt> </span></b><b><span lang=EN-US style=font-size:11.0pt>Setup</span></b><span style=font-size:11.0pt>, либо <b>инсталлятор </b></span><b><span lang=EN-US style=font-size:11.0pt>Inno</span></b><b><span lang=EN-US style=font-size:11.0pt> </span></b><b><span lang=EN-US style=font-size:11.0pt>Setup</span></b><span style=font-size:11.0pt>.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Если же имеется в виду скрипт (код), написанный программистом для </span><span lang=EN-US style=font-size:11.0pt>Inno</span><span lang=EN-US style=font-size:11.0pt> </span><span lang=EN-US style=font-size:11.0pt>Setup</span><span style=font-size:11.0pt>, он будет называться <b>скриптом</b>.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Программа-инсталлятор, полученная в результате обработки (компиляции) скрипта </span><span lang=EN-US style=font-size:11.0pt>Inno</span><span lang=EN-US style=font-size:11.0pt> </span><span lang=EN-US style=font-size:11.0pt>Setup</span><span style=font-size:11.0pt>’ом, будет именоваться <b>инсталлятором</b>.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Здесь и далее в статье сверху некоторых директив <span style=color:green>;таким образом</span> будет приведен комментарий к ним.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><h2 align=center style=text-align:center>&nbsp;</h2> <h2 align=center style=text-align:center><span style=font-size:16.0pt>Создание инсталлятора с помощью Мастера</span></h2><p class=MsoNormal>&nbsp;</p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>При выборе пункта меню Файл-&gt;Новый </span><span lang=EN-US style='font-size:
11.0pt'>Inno</span><span lang=EN-US style=font-size:11.0pt> </span><span lang=EN-US style=font-size:11.0pt>Setup</span><span style=font-size:11.0pt> предложит вам создать инсталляцию с помощью мастера (</span><span lang=EN-US style=font-size:11.0pt>Inno</span><span lang=EN-US style=font-size:11.0pt> </span><span lang=EN-US style=font-size:11.0pt>Setup</span><span lang=EN-US style=font-size:11.0pt> </span><span lang=EN-US style=font-size:11.0pt>Script</span><span lang=EN-US style=font-size:11.0pt> </span><span lang=EN-US style='font-size:
11.0pt'>Wizard</span><span style=font-size:11.0pt>). В большинстве случаев полученная с его помощью инсталляция вас не устроит, поэтому ее все равно нужно будет дорабатывать. Однако я не советую вам вообще пренебрегать мастером, т.к. он существенно облегчает создание хорошего инсталлятора, беря на себя всю «рутинную» работу.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Итак, для начала создадим простейший инсталлятор с помощью мастера </span><span lang=EN-US style=font-size:11.0pt>Inno</span><span lang=EN-US style=font-size:11.0pt> </span><span lang=EN-US style=font-size:11.0pt>Setup</span><span lang=EN-US style=font-size:11.0pt> </span><span lang=EN-US style='font-size:
11.0pt'>Script</span><span lang=EN-US style=font-size:11.0pt> </span><span lang=EN-US style=font-size:11.0pt>Wizard</span><span style=font-size:11.0pt>. Для этого не нужно в окне приветствия ставить галочку против строки «Создать пустой сценарий».</span></p><p class=MsoBodyTextIndent2>Строки, обязательные для заполнения, подписаны жирным шрифтом. В скобках написаны <b>[Имя секции]</b>-<b> </b><span style=color:blue>директива</span>. Директивам будут присвоены введенные значения.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>В окне </span><b><span lang=EN-US style=font-size:11.0pt>Application</span></b><b><span lang=EN-US style=font-size:11.0pt> </span></b><b><span lang=EN-US style=font-size:11.0pt>Information</span></b><span style=font-size:11.0pt> (Информация о приложении)  следует ввести:</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>Имя приложения</span></b><span style=font-size:11.0pt> (<b>[</b></span><b><span lang=EN-US style=font-size:11.0pt>Setup</span></b><b><span style='font-size:
11.0pt'>]-</span></b><span style=font-size:11.0pt;color:blue>AppName)</span><span style=font-size:11.0pt>;</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>Версия приложения</span></b><span style=font-size:11.0pt> (<b>[</b></span><b><span lang=EN-US style=font-size:11.0pt>Setup</span></b><b><span style='font-size:
11.0pt'>]-</span></b><span lang=EN-US style=font-size:11.0pt;color:blue>AppVerName</span><span style=font-size:11.0pt>);</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Авторское право (<b>[</b></span><b><span lang=EN-US style=font-size:11.0pt>Setup</span></b><b><span style=font-size:11.0pt>]-</span></b><span lang=EN-US style='font-size:11.0pt;
color:blue'>AppPublisher</span><span style=font-size:11.0pt>);</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Домашняя страница (<b>[</b></span><b><span lang=EN-US style=font-size:11.0pt>Setup</span></b><b><span style=font-size:11.0pt>]-</span></b><span lang=EN-US style='font-size:11.0pt;
color:blue'>AppPublisherURL</span><span lang=EN-US style='font-size:11.0pt;
color:blue'> </span><b><span style=font-size:11.0pt>[</span></b><b><span lang=EN-US style=font-size:11.0pt>Setup</span></b><b><span style='font-size:
11.0pt'>]-</span></b><span lang=EN-US style=font-size:11.0pt;color:blue>AppSupportURL</span><span lang=EN-US style=font-size:11.0pt;color:blue> </span><b><span style=font-size:11.0pt>[</span></b><b><span lang=EN-US style=font-size:11.0pt>Setup</span></b><b><span style=font-size:11.0pt>]-</span></b><span lang=EN-US style='font-size:11.0pt;
color:blue'>AppUpdatesURL</span><span style=font-size:11.0pt>);</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>В окне </span><b><span lang=EN-US style=font-size:11.0pt>Application</span></b><b><span lang=EN-US style=font-size:11.0pt> </span></b><b><span lang=EN-US style=font-size:11.0pt>Directory</span></b><b><span lang=EN-US style=font-size:11.0pt> </span></b><span style=font-size:11.0pt>(Размещение приложения):</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>Базовый путь установки </span></b><span style=font-size:11.0pt>(<b>[</b></span><b><span lang=EN-US style=font-size:11.0pt>Setup</span></b><b><span style='font-size:
11.0pt'>]-</span></b><span lang=EN-US style=font-size:11.0pt;color:blue>DefaultDirName</span><span style=font-size:11.0pt>):</span></p><p class=MsoNormal style=text-indent:45.0pt><span style=font-size:11.0pt>при выборе </span><b><span lang=EN-US style=font-size:11.0pt>Program</span></b><b><span lang=EN-US style=font-size:11.0pt> </span></b><b><span lang=EN-US style=font-size:11.0pt>Files</span></b><b><span lang=EN-US style='font-size:
11.0pt'> </span></b><b><span lang=EN-US style=font-size:11.0pt>Directory</span></b><span style=font-size:11.0pt> по умолчанию программа будет установлена в папку </span><b><span lang=EN-US style=font-size:11.0pt>Program</span></b><b><span lang=EN-US style=font-size:11.0pt> </span></b><b><span lang=EN-US style=font-size:11.0pt>Files</span></b><span style=font-size:11.0pt>, путь к которой буден взят из значения константы {</span><span lang=EN-US style=font-size:11.0pt>pf</span><span style=font-size:11.0pt>};</span></p><p class=MsoNormal style=text-indent:45.0pt><span style=font-size:11.0pt>при выборе </span><b><span lang=EN-US style=font-size:11.0pt>Custom</span></b><span style=font-size:11.0pt> программа будет установлена в папку, расположение которой нужно будет указать ниже.</span></p><h1>Папка приложения <span style=font-weight:normal>(</span>[<span lang=EN-US>Setup</span>]-<span style=color:blue;font-weight:normal>DefaultGroupName</span><span style=font-weight:normal>) - имя группы меню Пуск по умолчанию</span></h1><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>При снятом флажке <i>Разрешить Изменение Пути Пользователем</i> инсталятор не будет отображать страницу выбора папки. В этом случае папка по умолчанию не изменится (<b>[</b></span><b><span lang=EN-US style=font-size:11.0pt>Setup</span></b><b><span style=font-size:11.0pt>]-</span></b><span style=font-size:11.0pt;color:blue>DisableDirPage</span><span style=font-size:11.0pt>=</span><span lang=EN-US style=font-size:11.0pt>yes</span><span style=font-size:11.0pt>).</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>При выставленном флажке <i>Приложение Не Нуждается В Каталоге</i> папка приложения создаваться не будет, выбор последней предлагаться не будет, программа будет установлена в ту же папку, что и </span><span lang=EN-US style=font-size:11.0pt>Windows</span><span style=font-size:11.0pt> (<b>[</b></span><b><span lang=EN-US style='font-size:
11.0pt'>Setup</span></b><b><span style=font-size:11.0pt>]-</span></b><span style=font-size:11.0pt;color:blue>CreateAppDir</span><span style='font-size:
11.0pt'>=</span><span lang=EN-US style=font-size:11.0pt>no</span><span style=font-size:11.0pt>).</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>В окне </span><b><span lang=EN-US style=font-size:11.0pt>Application</span></b><b><span lang=EN-US style=font-size:11.0pt> </span></b><b><span lang=EN-US style=font-size:11.0pt>Files</span></b><span style=font-size:11.0pt>:</span></p><h1>Главный файл приложения <span style=font-weight:normal>(</span>[Files]<span style=font-weight:normal>- <span style=color:blue>Source</span>) – здесь будет прописан полный путь к главному файлу вашего приложения (главный файл в секции </span>[<span lang=EN-US>Files</span>] <span style=font-weight:normal>скрипта записывается первым). Также будут установлена папка, куда приложение устанавливается и необходимые (по мнению мастера) флаги, которые можно будет поменять или удалить.</span></h1><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Галочка против строки <b>Разрешить запуск приложения после установки </b>означает, что после установки инсталлятор предложит пользователю (по желанию) сразу запустить программу. В этом случае в скрипт добавится секция <b>[</b></span><b><span lang=EN-US style=font-size:11.0pt>Run</span></b><b><span style='font-size:
11.0pt'>]</span></b><span style=font-size:11.0pt> с указанием на запуск установленной программы.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>В дополнение к главному файлу приложения можно добавить как угодно много дополнительных файлов, а также папок с вложенными в них файлами. Для этого достаточно щелкнуть на <b>Добавить файл(ы)</b> или <b>Добавить папку</b> и указать путь к ним в появившемся окне. После добавления установку файлов можно редактировать и удалить (при выделении файла из списка станут доступными кнопки <b>Правка</b> и <b>Удалить</b>).</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>При нажатии кнопки <b>Правка </b>откроется окно, в котором будет представлен достаточно широкий выбор параметров установки файла или папки. Рассмотрим его детально.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Опция <b>Включая подкаталоги</b> актуальна, понятно, для папок и говорит сама за себя.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>В разделе <b>Путь</b> из выпадающего меню следует <b>Указать базовый каталог</b>, т.е. каталог, куда инсталлятор должен будет установить выбранный файл или папку. Это может быть:</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span lang=EN-US style=font-size:11.0pt>Application</span></b><b><span lang=EN-US style=font-size:11.0pt> </span></b><b><span lang=EN-US style=font-size:11.0pt>Directory</span></b><span style=font-size:11.0pt> – папка приложения (выбирается по умолчанию, равен константе {</span><span lang=EN-US style=font-size:11.0pt>app</span><span style=font-size:11.0pt>});</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span lang=EN-US style=font-size:11.0pt>Program Files Directory</span></b><span lang=EN-US style=font-size:11.0pt> – </span><span style=font-size:11.0pt>папка</span><span lang=EN-US style=font-size:11.0pt> Program Files (</span><span style=font-size:11.0pt>равен</span><span style=font-size:11.0pt> </span><span style=font-size:11.0pt>константе</span><span lang=EN-US style='font-size:
11.0pt'> {pf});</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span lang=EN-US style=font-size:11.0pt>Common Files Directory</span></b><span lang=EN-US style=font-size:11.0pt> – </span><span style=font-size:11.0pt>папка</span><span lang=EN-US style=font-size:11.0pt> Common Files (</span><span style=font-size:11.0pt>равен</span><span style=font-size:11.0pt> </span><span style=font-size:11.0pt>константе</span><span lang=EN-US style='font-size:
11.0pt'> {cf});</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span lang=EN-US style=font-size:11.0pt>Windows Directory</span></b><span lang=EN-US style=font-size:11.0pt> – </span><span style=font-size:11.0pt>папка</span><span lang=EN-US style=font-size:11.0pt> Windows (</span><span style='font-size:
11.0pt'>равен</span><span style=font-size:11.0pt> </span><span style=font-size:11.0pt>константе</span><span lang=EN-US style='font-size:
11.0pt'> {win});</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span lang=EN-US style=font-size:11.0pt>Windows System Directory</span></b><span lang=EN-US style=font-size:11.0pt> – </span><span style=font-size:11.0pt>системная</span><span style=font-size:11.0pt> </span><span style=font-size:11.0pt>папка</span><span lang=EN-US style=font-size:11.0pt> Windows (</span><span style='font-size:
11.0pt'>равен</span><span style=font-size:11.0pt> </span><span style=font-size:11.0pt>константе</span><span lang=EN-US style='font-size:
11.0pt'> {sys});</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span lang=EN-US style=font-size:11.0pt>Setup Source Directory</span></b><span lang=EN-US style=font-size:11.0pt> – </span><span style=font-size:11.0pt>папка</span><span style=font-size:11.0pt> </span><span style=font-size:11.0pt>инсталлятора</span><span lang=EN-US style=font-size:11.0pt> (</span><span style=font-size:11.0pt>равен</span><span style=font-size:11.0pt> </span><span style=font-size:11.0pt>константе</span><span lang=EN-US style=font-size:11.0pt> {src});</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span lang=EN-US style=font-size:11.0pt>System Drive Root Directory</span></b><span lang=EN-US style=font-size:11.0pt> – </span><span style=font-size:11.0pt>системный</span><span style=font-size:11.0pt> </span><span style=font-size:11.0pt>диск</span><span lang=EN-US style=font-size:11.0pt>, </span><span style=font-size:11.0pt>на</span><span style=font-size:11.0pt> </span><span style=font-size:11.0pt>котором</span><span style=font-size:11.0pt> </span><span style=font-size:11.0pt>установлена</span><span lang=EN-US style=font-size:11.0pt> Windows (</span><span style='font-size:
11.0pt'>равен</span><span style=font-size:11.0pt> </span><span style=font-size:11.0pt>константе</span><span lang=EN-US style='font-size:
11.0pt'> {sd});</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span lang=EN-US style=font-size:11.0pt>Common Startup Folder</span></b><span lang=EN-US style=font-size:11.0pt> – </span><span style=font-size:11.0pt>папка</span><span style=font-size:11.0pt> </span><span style=font-size:11.0pt>Автозагрузка</span><span style=font-size:11.0pt> </span><span style=font-size:11.0pt>меню</span><span style=font-size:11.0pt> </span><span style=font-size:11.0pt>Пуск</span><span lang=EN-US style=font-size:11.0pt> (</span><span style=font-size:11.0pt>равен</span><span style=font-size:11.0pt> </span><span style=font-size:11.0pt>константе</span><span lang=EN-US style=font-size:11.0pt> {commonstartup});</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span lang=EN-US style=font-size:11.0pt>User Startup Folder</span></b><span lang=EN-US style=font-size:11.0pt> – </span><span style=font-size:11.0pt>папка</span><span style=font-size:11.0pt> </span><span style=font-size:11.0pt>Автозагрузка</span><span style=font-size:11.0pt> </span><span style=font-size:11.0pt>меню</span><span style=font-size:11.0pt> </span><span style=font-size:11.0pt>Пуск для текущего пользователя (равен константе {</span><span lang=EN-US style=font-size:11.0pt>userstartup</span><span style=font-size:11.0pt>});</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>[</span></b><b><span lang=EN-US style=font-size:11.0pt>Custom</span></b><b><span style='font-size:
11.0pt'>]</span></b><span style=font-size:11.0pt> – здесь можно указать другой каталог для установки файла (папки).</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Ниже можно <b>Определить подкаталог</b> для устанавливаемого файла (папки) – в этом случае инсталлятор создаст подкаталог в каталоге устанавливаемой программы и установит файл (папку) туда. В скрипте это будет выглядеть так:</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Source</span><span style=font-size:11.0pt>: &quot;</span><span lang=EN-US style=font-size:11.0pt>C</span><span style=font-size:11.0pt>:\</span><span lang=EN-US style=font-size:11.0pt>Program</span><span style=font-size:11.0pt>.</span><span lang=EN-US style=font-size:11.0pt>EXE</span><span style=font-size:11.0pt>&quot;; </span><span lang=EN-US style='font-size:11.0pt;
color:blue'>DestDir</span><span style=font-size:11.0pt>: &quot;{</span><span lang=EN-US style=font-size:11.0pt>app</span><span style=font-size:11.0pt>}\</span><span lang=EN-US style=font-size:11.0pt>KatalogProgram</span><span style=font-size:11.0pt>&quot;;</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>В окне </span><b><span lang=EN-US style=font-size:11.0pt>Application</span></b><b><span lang=EN-US style=font-size:11.0pt> </span></b><b><span lang=EN-US style=font-size:11.0pt>Icons</span></b><span style=font-size:11.0pt>:</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>В строке <b>Папка меню Пуск</b> задается имя устанавливаемой программы – так оно будет отображаться в меню Пуск.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Значение флажков, расположенных ниже, понятно. А вот что при их установке добавится в скрипт:</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>Разрешить пользователю изменять имя папки меню Пуск</span></b><span style='font-size:
11.0pt'>:</span></p><p class=MsoNormal style=text-indent:27.0pt><span style='font-size:11.0pt;
color:blue'>DisableProgramGroupPage</span><span style=font-size:11.0pt>=</span><span lang=EN-US style=font-size:11.0pt>yes</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>И как следствие этого флажок на следующей строчке станет недоступным, а в скрипт добавится:</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>AllowNoIcons</span><span style='font-size:
11.0pt'>=</span><span lang=EN-US style=font-size:11.0pt>no</span><span style=font-size:11.0pt> (значение по умолчанию – не будет отображаться в скрипте)</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>Разрешить отмену создания папки меню Пуск</span></b><span style=font-size:11.0pt>:</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>AllowNoIcons</span><span style='font-size:
11.0pt'>=</span><span lang=EN-US style=font-size:11.0pt>yes</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoBodyTextIndent2><b>Совет</b>: следующие параметры инсталляции легче задавать вручную. Как именно это сделать, не прибегая к помощи мастера, будет рассмотрено позже, а пока просто вкратце перечислим, что значат установленные флажки в следующих строках.</p><p class=MsoBodyTextIndent2><b>Создавать ярлык Интернет в папке меню Пуск</b> (в меню Пуск в папке устанавливаемой программы будет добавлена ссылка на сайт, указанный в <span lang=EN-US style=color:blue>AppPublisherURL</span>);</p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>Создавать значок </span></b><b><span lang=EN-US style=font-size:11.0pt>Uninstall</span></b><b><span style=font-size:11.0pt> в папке меню Пуск </span></b><span style='font-size:
11.0pt'>(устанавливаемую программу можно будет удалить из меню Пуск);</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoBodyTextIndent3>Другое:</p><p class=MsoBodyTextIndent3>Разрешить пользователю создавать значки Рабочего Стола<span style=font-weight:normal> (пользователь может отказаться от установки значка программы на его рабочем столе);</span></p><p class=MsoBodyTextIndent3>Разрешить пользователю создание значков быстрого запуска<span style=font-weight:normal> (по желанию пользователь может добавить значок быстрого запуска программы, который будет располагаться в левом углу панели задач, справа от кнопки меню Пуск).</span></p><p class=MsoBodyTextIndent3><span style=font-weight:normal>&nbsp;</span></p><p class=MsoBodyTextIndent3><span style=font-weight:normal>В окне </span><span lang=EN-US>Application</span><span lang=EN-US> </span><span lang=EN-US>Documentation</span><span style=font-weight:normal>:</span></p><p class=MsoBodyTextIndent3><span style=font-weight:normal>Здесь следует указать путь к Файлу, задать </span>Информационный файл, выводимый перед установкой<span style=font-weight:normal> и </span>Информационный файл, выводимый после установки<span style=font-weight:normal>. Желательно, чтобы это были текстовые файлы (</span><span lang=EN-US style=font-weight:normal>txt</span><span style=font-weight:normal>).</span></p><p class=MsoBodyTextIndent3><span style=font-weight:normal>Следующее окно – </span>Финиш<span style=font-weight:normal>. На нем работа мастера завершается. Думаете, написание инсталлятора на этом завершается? Ах, как вы ошибаетесь. С помощью мастера мы создали остов, фундамент будущего инсталлятора, то есть избавили себя от нудной работы. Впереди – самое интересное: сделать ваш инсталлятор действительно удобным, простым и красивым. В путь!</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal align=center style=text-align:center><b><span style=font-size:16.0pt>Секция [</span></b><b><span lang=EN-US style=font-size:16.0pt>Setup</span></b><b><span style=font-size:16.0pt>]</span></b></p><p class=MsoNormal align=center style=text-align:center><b>&nbsp;</b></p><p class=MsoNormal align=center style=text-align:center;text-indent:27.0pt><b>Основные параметры секции [</b><b><span lang=EN-US>Setup</span>].</b></p><p class=MsoNormal align=center style=text-align:center;text-indent:27.0pt><b>&nbsp;</b></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Ниже приведена секция <b>[</b></span><b><span lang=EN-US style=font-size:11.0pt>Setup</span></b><b><span style=font-size:11.0pt>] </span></b><span style=font-size:11.0pt>с самыми необходимыми директивами. Это – минимальный набор для написания инсталятора.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>[</span></b><b><span lang=EN-US style=font-size:11.0pt>Setup</span></b><b><span style='font-size:
11.0pt'>]</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span style='font-size:11.0pt;
color:green'>; Имя программы</span></p><p class=MsoNormal style=text-indent:27.0pt><span style='font-size:11.0pt;
color:blue'>AppName</span><span style=font-size:11.0pt>=</span><span lang=EN-US style=font-size:11.0pt>Programma</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:green>; </span><span style='font-size:11.0pt;
color:green'>Версия</span><span style=font-size:11.0pt;color:green> </span><span style=font-size:11.0pt;color:green>программы</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>AppVerName</span><span lang=EN-US style=font-size:11.0pt>= Programma ver.1.0</span></p><p class=MsoNormal style=text-indent:27.0pt><span style='font-size:11.0pt;
color:green'>; Определяет папку, в которую инсталятор предложит установить программу по умолчанию</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>DefaultDirName</span><span style=font-size:11.0pt>={</span><span lang=EN-US style=font-size:11.0pt>pf</span><span style=font-size:11.0pt>}\ </span><span lang=EN-US style=font-size:11.0pt>Programma</span><span style=font-size:11.0pt> 1.0</span></p><p class=MsoBodyTextIndent>; Имя группы меню Пуск по умолчанию, которое используется на странице Выбора программной группы мастера</p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>DefaultGroupName</span><span style=font-size:11.0pt>= </span><span lang=EN-US style=font-size:11.0pt>Programma</span><span style=font-size:11.0pt> 1.0</span></p><p class=MsoNormal style=text-indent:27.0pt><span style='font-size:11.0pt;
color:green'>; Следующая строка задает базовое имя для получаемого файла установки</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>OutputBaseFilename</span><span style=font-size:11.0pt>= </span><span lang=EN-US style=font-size:11.0pt>Programma</span><span lang=EN-US style=font-size:11.0pt> </span><span lang=EN-US style='font-size:
11.0pt'>Setup</span><span style=font-size:11.0pt> 1.0</span></p><p class=MsoBodyTextIndent>; Папка, в которой будут создаваться файлы установки относительно папки скрипта.</p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>OutputDir</span><span style='font-size:
11.0pt'>=</span><span lang=EN-US style=font-size:11.0pt>c</span><span style=font-size:11.0pt>:\</span><span lang=EN-US style=font-size:11.0pt>Proba</span><span style=font-size:11.0pt>\</span></p><p class=MsoBodyTextIndent>; Рабочая папка скрипта (откуда брать программулину, для которой пишется инсталлятор)</p><p class=MsoNormal style=text-indent:27.0pt><span style='font-size:11.0pt;
color:blue'>SourceDir</span><span style=font-size:11.0pt>=C:\</span></p><p class=MsoNormal style=text-indent:27.0pt><span style='font-size:11.0pt;
color:green'>; Определяет, что флажок &quot;Не создавать значков&quot; на странице выбора программной группы будет отображаться</span></p><p class=MsoNormal style=text-indent:27.0pt><span style='font-size:11.0pt;
color:blue'>AllowNoIcons</span><span style=font-size:11.0pt>=yes</span></p><p class=MsoBodyTextIndent>; инсталятор всегда будет показывать папку для установки в списке настроек на странице Всё готово к установке</p><p class=MsoNormal style=text-indent:27.0pt><span style='font-size:11.0pt;
color:blue'>AlwaysShowDirOnReadyPage</span><span style=font-size:11.0pt>=yes</span></p><p class=MsoBodyTextIndent>&nbsp;</p><p class=MsoBodyTextIndent>;Эти директивы используются для определения содержимого вкладки &quot;Поддержка&quot; диалога Установка и удаление программ на Панели управления в Windows 2000/XP</p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>AppPublisher</span><span lang=EN-US style=font-size:11.0pt>=My Company, Inc.</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>AppPublisherURL</span><span lang=EN-US style=font-size:11.0pt>=http://www.mycompany.com/</span></p><p class=MsoNormal style=text-indent:27.0pt><span style='font-size:11.0pt;
color:blue'>AppVersion</span><span style=font-size:11.0pt>=1.5</span></p><p class=MsoBodyTextIndent>; При отрицательном значении (no), инсталятор не будет создавать пункта программы в диалоге Установка и удаление программ</p><p class=MsoNormal style=text-indent:27.0pt><span style='font-size:11.0pt;
color:blue'>CreateUninstallRegKey</span><span style=font-size:11.0pt>=yes</span></p><p class=MsoNormal style=text-indent:27.0pt><span style='font-size:11.0pt;
color:green'>; При значении auto инсталятор выдаст сообщение &quot;Папка: … уже существует. Вы хотите продолжить установку в эту папку?&quot; (&quot;</span><span lang=EN-US style=font-size:11.0pt;color:green>The</span><span lang=EN-US style=font-size:11.0pt;color:green> </span><span lang=EN-US style='font-size:
11.0pt;color:green'>directory</span><span style=font-size:11.0pt;color:green> ... </span><span lang=EN-US style=font-size:11.0pt;color:green>already</span><span lang=EN-US style=font-size:11.0pt;color:green> </span><span lang=EN-US style=font-size:11.0pt;color:green>exists</span><span style='font-size:11.0pt;
color:green'>. </span><span lang=EN-US style=font-size:11.0pt;color:green>Would you like to install to that directory anyway?&quot;)</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>DirExistsWarning</span><span lang=EN-US style=font-size:11.0pt>=auto</span></p><p class=MsoNormal style=text-indent:27.0pt><span style='font-size:11.0pt;
color:green'>; Условия лицензии</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>LicenseFile</span><span style='font-size:
11.0pt'>=</span><span lang=EN-US style=font-size:11.0pt>license</span><span style=font-size:11.0pt>.</span><span lang=EN-US style=font-size:11.0pt>txt</span></p><p class=MsoNormal style=text-indent:27.0pt><span style='font-size:11.0pt;
color:green'>; При значении yes, установка отобразит страницу для ввода информации о пользователе. Полученные значения будут в константах {</span><span lang=EN-US style=font-size:11.0pt;color:green>userinfoname</span><span style=font-size:11.0pt;color:green>} и {</span><span lang=EN-US style=font-size:11.0pt;color:green>userinfoorg</span><span style='font-size:
11.0pt;color:green'>}</span></p><p class=MsoNormal style=text-indent:27.0pt><span style='font-size:11.0pt;
color:blue'>UserInfoPage</span><span style=font-size:11.0pt>=yes</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Некоторые директивы в этом примере указаны со значениями, принятыми по умолчанию – это значит, что их можно было не указывать.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>Перезагрузка компьютера после удачной установки или удаления приложения</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>&nbsp;</span></b></p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>Для секции [</span></b><b><span lang=EN-US style=font-size:11.0pt>Setup</span></b><b><span style=font-size:11.0pt>]:</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span style='font-size:11.0pt;
color:blue'>UninstallRestartComputer</span><span style=font-size:11.0pt>=</span><span lang=EN-US style=font-size:11.0pt>yes</span><span style=font-size:11.0pt> – компьютер будет перезагружен после удачного удаления программы, даже если в этом нет необходимости</span></p><p class=MsoBodyTextIndent2><span style=color:blue>AlwaysRestart</span>=<span lang=EN-US>yes</span><b> – </b>компьютер будет перезагружен после удачной установки программы, даже если в этом нет необходимости</p><p class=MsoNormal style=text-indent:27.0pt><span style='font-size:11.0pt;
color:blue'>RestartIfNeededByRun</span><span style=font-size:11.0pt>=</span><span lang=EN-US style=font-size:11.0pt>yes</span><span style=font-size:11.0pt> – компьютер будет перезагружен только если в этом нуждаются файлы, запускаемые из секции <b>[</b></span><b><span lang=EN-US style=font-size:11.0pt>Run</span></b><b><span style=font-size:11.0pt>]</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Также инсталятор всегда будет предлагать пользователю перезагрузить компьютер, если для файлов секции <b>[</b></span><b><span lang=EN-US style=font-size:11.0pt>Files</span></b><b><span style=font-size:11.0pt>] </span></b><span style=font-size:11.0pt>применяются флаги  </span><b><span lang=EN-US style=font-size:11.0pt>r</span></b><b><span style=font-size:11.0pt>estartreplace</span></b><span style=font-size:11.0pt> или </span><b><span lang=EN-US style=font-size:11.0pt>uninsrestartdelete</span></b><span style=font-size:11.0pt>.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>В секции <b>[</b></span><b><span lang=EN-US style=font-size:11.0pt>Components</span></b><b><span style=font-size:11.0pt>] </span></b><span style=font-size:11.0pt>за перезагрузку отвечает флаг <b>restart</b> – если при установке пользователь выберет компонент с этим флагом, после успешной установки инсталлятор предложит ему перезагрузить компьютер. Этот флаг следует использовать, если в секции <b>[</b></span><b><span lang=EN-US style=font-size:11.0pt>Files</span></b><b><span style='font-size:
11.0pt'>]</span></b><span style=font-size:11.0pt> имеются файлы с флагом </span><b><span lang=EN-US style=font-size:11.0pt>r</span></b><b><span style=font-size:11.0pt>estartreplace</span></b><span style=font-size:11.0pt>.</span></p><p class=MsoNormal style=text-indent:27.0pt><b>&nbsp;</b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>&nbsp;</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>Использовать настройки предыдущей установки</span></b></p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>Все директивы, перечисленные ниже, имеют данные значения по умолчанию, так что их указывать нет необходимости. Указываются они только в том случае, когда вам не нужно, чтобы инсталятор использовал какие-либо настройки предыдущей установки – тогда директивам присваивается значение <span lang=EN-US>no</span>.</p><p class=MsoBodyTextIndent2>Инсталятор поищет в реестре, устанавливалось ли данное приложение на данный компьютер раньше, и если да, то по умолчанию предложит:</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>UsePreviousAppDir</span>=<span lang=EN-US>yes</span> – папку, которую пользователь выбрал при прошлой установке</p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>UsePreviousGroup</span>=<span lang=EN-US>yes</span> – группу меню Пуск, которую указал пользователь при прошлой установке</p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>UsePreviousSetupType</span>=<span lang=EN-US>yes</span> – тип и компоненты предыдущей установки</p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>UsePreviousTasks</span>=<span lang=EN-US>yes</span> – задания, выбранные пользователем при  предыдущей установке</p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>UsePreviousUserInfo</span>=<span lang=EN-US>yes</span> – имя пользователя, название организации и серийный номер, которые ввел пользователь при предыдущей установке</p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>&nbsp;</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>Использование значений по умолчанию</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center>&nbsp;</p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>DefaultDirName</span>={<span lang=EN-US>pf</span>}\<span lang=EN-US>MyProg</span> – папка, в которую инсталятор предложит установить приложение по умолчанию. Это значение пользователь может изменить, если это предусмотрено инсталлятором</p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>DefaultGroupName</span>=<span lang=EN-US>MyProg</span> – имя программы в меню Пуск, которое предложит инсталятор по умолчанию</p><p class=MsoBodyTextIndent2>Для того, чтобы работали приведенные далее директивы, нужно включить запрос имени пользователя и организации:</p><p class=MsoBodyTextIndent2><span style=color:blue>UserInfoPage</span>=yes</p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>DefaultUserInfoName</span>=<span lang=EN-US>Lamer</span> – имя пользователя, которое предложит инсталятор по умолчанию</p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>DefaultUserInfoOrg</span>=<span lang=EN-US>LamerLand</span> – название организации, которое предложит инсталятор по умолчанию</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>&nbsp;</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>«Косметические»</span></b></p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><span style=color:blue>WizardImageFile</span>=Image.bmp – картинка на приветствие (должна находиться в каталоге, обозначенном как <span style=color:blue>SourceDir</span>, либо к ней должен быть прописан полный путь).<span style=color:blue> </span> </p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>WizardImageStretch</span>=<span lang=EN-US>no</span> – картинку лучше не растягивать под отведенный ей в окне инсталлятора размер</p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>WizardSmallImageFile</span>=<span lang=EN-US>SmallImage</span>.<span lang=EN-US>bmp</span> – маленькая картинка, во время инсталляции будет находиться в правом верхнем углу.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><span lang=EN-US>C</span><span lang=EN-US> </span>помощью следующих директив можно изменить цвет фона за картинками:</p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>WizardImageBackColor</span>= <span lang=EN-US>clTeal</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>WizardSmallImageBackColor</span>=<span lang=EN-US>clNavy</span></p><p class=MsoBodyTextIndent2>Значения цветов могут быть следующими:</p><p class=MsoBodyTextIndent2><span lang=EN-US>clRed</span> (красный)</p><p class=MsoBodyTextIndent2><span lang=EN-US>clYellow</span> (желтый)</p><p class=MsoBodyTextIndent2><span lang=EN-US>clOlive</span> (оливковый)</p><p class=MsoBodyTextIndent2><span lang=EN-US>clLime</span> (ярко зеленый)</p><p class=MsoBodyTextIndent2><span lang=EN-US>clGreen</span> (зеленый)</p><p class=MsoBodyTextIndent2><span lang=EN-US>clTeal</span> (салатовый)</p><p class=MsoBodyTextIndent2><span lang=EN-US>clAqua</span> (зелено-голубой)</p><p class=MsoBodyTextIndent2><span lang=EN-US>clBlue</span> (ярко-синий)</p><p class=MsoBodyTextIndent2><span lang=EN-US>clNavy</span> (синий)</p><p class=MsoBodyTextIndent2><span lang=EN-US>clPurple</span> (фиолетовый)</p><p class=MsoBodyTextIndent2><span lang=EN-US>clFuchsia</span> (розовый)</p><p class=MsoBodyTextIndent2><span lang=EN-US>clMaroon</span> (коричневый)</p><p class=MsoBodyTextIndent2><span lang=EN-US>clBlack</span> (черный)</p><p class=MsoBodyTextIndent2><span lang=EN-US>clGray</span> (серый)</p><p class=MsoBodyTextIndent2><span lang=EN-US>clSilver</span> (серебряный)</p><p class=MsoBodyTextIndent2><span lang=EN-US>clWhite</span> (белый)</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>Поработаем с фоновым окном инсталлятора.</p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>WindowVisible</span>=<span lang=EN-US>yes</span> – включить поддержку фонового окна инсталлятора.</p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AppCopyright</span>=<span lang=EN-US>Copyright</span> ©  2004 <span lang=EN-US>Zuka</span>-<span lang=EN-US>Buka</span>, <span lang=EN-US>Inc</span>. - выводит сообщение об авторских правах в правом нижнем углу фонового окна инсталятора</p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>BackColor</span>=<span lang=EN-US>clLime</span> – начальный цвет градиентной заливки фонового окна</p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>BackColor</span><span style=color:blue>2</span>=<span lang=EN-US>clOlive</span> – конечный цвет градиентной заливки фонового окна</p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>BackColorDirection</span>= lefttoright – направление градиентной заливки</p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>BackSolid</span>=<span lang=EN-US>no</span> – это значение по умолчанию (градиентная заливка включена). При значении <span lang=EN-US>yes</span><span lang=EN-US> </span>цвет фона будет сплошным и равным <span lang=EN-US>BackColor</span>.</p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>WindowShowCaption</span>=<span lang=EN-US>no</span> – инсталятор будет по-настоящему полноэкранным, фоновое окно закроет собой панель задач.</p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>WindowStartMaximized</span>=<span lang=EN-US>yes</span> – фоновое окно инсталлятора будет развернуто на весь экран, но не перекроет панель задач (значение по умолчанию).</p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>WindowResizable</span>=<span lang=EN-US>no</span> – пользователь не сможет поменять размер фонового окна инсталлятора, когда оно развернуто.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>Прочие «косметические» директивы:</p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>FlatComponentsList</span>=<span lang=EN-US>yes</span> – задает внешний вид <span lang=EN-US>checkbox</span>’ов (<span lang=EN-US>yes</span> – «плоские», <span lang=EN-US>no</span> – «3<span lang=EN-US>D</span>»).</p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>SetupIconFile</span>=<span lang=EN-US>Ikonka</span>.<span lang=EN-US>ico</span> – задает иконку для полученного инсталлятора</p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>ShowComponentSizes</span>=<span lang=EN-US>yes</span> – показывать размер устанавливаемых компонентов (значение по умолчанию). Удобная опция, лучше не отключать ее.</p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>ShowTasksTreeLines</span>=<span lang=EN-US>yes</span> – инсталятор соединит линиями главное задание и относящиеся к нему подзадания.</p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>Деинсталятор</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>&nbsp;</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Ниже приведены примеры использования директив деинсталлятора с краткими пояснениями. Для долее детальной информации обратитесь к русскому файлу справки (раздел Секция <b>[</b></span><b><span lang=EN-US style=font-size:11.0pt>Setup</span></b><b><span style=font-size:11.0pt>]</span></b><span style=font-size:11.0pt>)</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Приведенные ниже директивы полезно использовать, если ваша программа является обновлением или дополнением к какой-либо другой программе.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>CreateUninstallRegKey</span><span style=font-size:11.0pt>=</span><span lang=EN-US style=font-size:11.0pt>no</span><span style=font-size:11.0pt> – не создавать запись в меню <i>Установка и удаление программ </i>Панели управления</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Uninstallable</span><span style='font-size:
11.0pt'>=</span><span lang=EN-US style=font-size:11.0pt>no</span><span style=font-size:11.0pt> – не создавать деинсталлятор</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>UninstallLogMode</span><span style=font-size:11.0pt>=</span><span lang=EN-US style=font-size:11.0pt>append</span><span style=font-size:11.0pt> – по возможности дополнить деинсталлятор – в этом случае при удалении отменяются все изменения, внесенные различными инсталяторами</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>UpdateUninstallLogAppName</span><span style=font-size:11.0pt>=</span><span lang=EN-US style=font-size:11.0pt>no</span><span style=font-size:11.0pt> – при дополнении деинсталлятора его заголовок не изменится</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>А эти директивы являются «косметическими» - определяют внешний вид деинсталлятора:</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>UninstallDisplayIcon</span><span style=font-size:11.0pt>=</span> <span style=font-size:11.0pt>&quot;C:\Ikonka1.ico&quot; – значок для деинсталлятора в диалоге <i>Установка и удаление программ </i>Панели управления</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>UninstallDisplayName</span><span style=font-size:11.0pt>=Удалить Proga 1.0 – название программы в диалоге <i>Установка и удаление программ </i>Панели управления</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>UninstallFilesDir</span><span style=font-size:11.0pt>=</span> <span style=font-size:11.0pt>&quot;C:\UninstProga&quot; – папка, в которую будет помещен деинсталятор</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>UninstallIconFile</span><span style=font-size:11.0pt>=</span> <span style=font-size:11.0pt>&quot;</span><span lang=EN-US style=font-size:11.0pt>C</span><span style=font-size:11.0pt>:\</span><span lang=EN-US style=font-size:11.0pt>Ikonka</span><span style=font-size:11.0pt>2.</span><span lang=EN-US style=font-size:11.0pt>ico</span><span style=font-size:11.0pt>&quot; – иконка, которая будет отображаться в правом верхнем углу окна <i>Процесс удаления</i></span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>UninstallStyle</span><span style=font-size:11.0pt>=</span><span lang=EN-US style=font-size:11.0pt>classic</span><span style=font-size:11.0pt> – стиль деинсталятора</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Остальные параметры секции <b>[</b></span><b><span lang=EN-US style=font-size:11.0pt>Setup</span></b><b><span style=font-size:11.0pt>]</span></b><span style=font-size:11.0pt> подробно описаны в </span><b><span lang=EN-US style=font-size:11.0pt>ISetup</span></b><b><span style=font-size:11.0pt>.</span></b><b><span lang=EN-US style=font-size:11.0pt>hlp</span></b><span style=font-size:11.0pt> – файле справки </span><span lang=EN-US style=font-size:11.0pt>Inno</span><span lang=EN-US style=font-size:11.0pt> </span><span lang=EN-US style=font-size:11.0pt>Setup</span><span style=font-size:11.0pt>.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><h3>Примеры использования</h3><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><h2 align=center style=text-align:center>Отключить приветствие</h2><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>&nbsp;</span></b></p><h1><span style=color:blue;font-weight:normal>DisableStartupPrompt</span><span style=font-weight:normal>=</span><span lang=EN-US style=font-weight:normal>no</span></h1><p class=MsoBodyTextIndent2>При значении yes, инсталлятор не будет отображать сообщение &quot;Эта программа установит… на ваш компьютер…&quot; <span lang=EN-US>(&quot;This will install... Do you wish to continue?). </span>Игнорируется когда <span lang=EN-US style=color:blue>UseSetupLdr</span><span lang=EN-US>=no.</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>&nbsp;</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>Изменение приложения из панели управления</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b>&nbsp;</b></p><p class=MsoBodyTextIndent2>При использовании директивы <span lang=EN-US style=color:blue>AppModifyPath</span> в <span lang=EN-US>Windows</span> 2000/<span lang=EN-US>XP</span> на странице <i>Установка и удаление программ</i> Панели управления против заголовка программы рядом с кнопкой <b>Удалить</b> добавится кнопка <b>Изменить</b>. Нажав на нее, пользователь сможет установить понадобившиеся ему компоненты программы, и для этого ему не придется переустанавливать приложение целиком. Сейчас рассмотрим скрипт, который просто покажет работу этой директивы.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b>Задача</b>: приложение состоит из трех .<span lang=EN-US>exe</span>-файлов: <span lang=EN-US>Matrix</span>.<span lang=EN-US>exe</span>, 2<span lang=EN-US>X</span>.<span lang=EN-US>exe</span> и <span lang=EN-US>Plus</span>.<span lang=EN-US>exe</span>. Для него возможны два типа установки: полная и выборочная (если выбраны все 3 компонента программы, установка полная, если не все – выборочная). С помощью директивы <span lang=EN-US style=color:blue>AppModifyPath</span> дадим возможность пользователю устанавливать нужные ему компоненты приложения.</p><p class=MsoBodyTextIndent2><b>Решение:</b></p><p class=MsoBodyTextIndent2>В этом примере местонахождение программы-инсталлятора будет определено в секции <b>[</b><b><span lang=EN-US>Code</span></b><b>]</b>. При установке программы в реестре системы пользователя создастся ключ, с помощью которого в дальнейшем определится путь к инсталлятору.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Setup]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AppName</span><span lang=EN-US>=Vibor</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AppVerName</span><span lang=EN-US>=Vibor 1.0</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>DefaultDirName</span><span lang=EN-US>={pf}\Vibor 1.0</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>DefaultGroupName</span><span lang=EN-US>=Vibor 1.0</span></p><p class=MsoBodyTextIndent2><span style=color:green>;Имя полученного инсталятора</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>OutputBaseFilename</span>=<span lang=EN-US>Vibor</span> 1.0</p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>SourceDir</span>=<span lang=EN-US>C</span>:\</p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AllowNoIcons</span>=<span lang=EN-US>yes</span></p><p class=MsoBodyTextIndent2><span style=color:green>;Во избежание каких-либо недоразумений отключим использование настроек предыдущей установки:</span></p><p class=MsoBodyTextIndent2><span style=color:green>;не использовать папку, которую выбрал пользователь в прошлый раз</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>UsePreviousAppDir</span>=<span lang=EN-US>no</span></p><p class=MsoBodyTextIndent2><span style=color:green>;не использовать группу меню Пуск, выбранную пользователем при предыдущей установке</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>UsePreviousGroup</span>=<span lang=EN-US>no</span></p><p class=MsoBodyTextIndent2><span style=color:green>;не использовать тип установки, выбранный пользователем в прошлый раз</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>UsePreviousSetupType</span>=<span lang=EN-US>no</span></p><p class=MsoBodyTextIndent2><span style=color:green>;не использовать задания, которые выбрал пользователь при прошлой установке</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>UsePreviousTasks</span>=<span lang=EN-US>no</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AlwaysShowDirOnReadyPage</span>=<span lang=EN-US>yes</span></p><p class=MsoBodyTextIndent2><span style=color:green>; директива </span><span lang=EN-US style=color:green>AppModifyPath</span><span style=color:green> определит местонахождение программы-инсталлятора с помощью описанной в секции <b>[</b></span><b><span lang=EN-US style=color:green>Code</span></b><b><span style=color:green>]</span></b><span style=color:green> константы </span><span lang=EN-US style=color:green>MyConst</span><span lang=EN-US style=color:green></span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AppModifyPath</span><span lang=EN-US>=&quot;{code:MyConst}&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Types]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span><span lang=EN-US>: &quot;polnaya&quot;; <span style=color:blue>Description</span>: &quot;Все компоненты&quot;</span></p><p class=MsoBodyTextIndent2><span style=color:green>;флаг </span><span lang=EN-US style=color:green>iscustom</span><span style=color:green> означает, что именно этот тип установки является выборочным</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span><span lang=EN-US>: &quot;viborochnaya&quot;; <span style=color:blue>Description</span>: &quot;Выбрать компоненты&quot;; <span style=color:blue>Flags</span>: iscustom</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:green>;</span><span style=color:green>создаем</span><span style=color:green> </span><span style=color:green>список</span><span style=color:green> </span><span style=color:green>компонентов</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Components]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span><span lang=EN-US>: &quot;Matrix&quot;; <span style=color:blue>Description</span>: &quot;Программа Matrix 1.0&quot;; <span style=color:blue>Types</span>: polnaya viborochnaya</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span><span lang=EN-US>: &quot;2X&quot;;<span style=color:blue> Description</span>: &quot;Программа 2Х&quot;;<span style=color:blue> Types</span>: polnaya viborochnaya</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span><span lang=EN-US>: &quot;Plus&quot;; <span style=color:blue>Description</span>: &quot;Программа сложения&quot;; <span style=color:blue>Types</span>: polnaya viborochnaya</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Files]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: &quot;Matrix.exe&quot;; <span style=color:blue>Components</span>: Matrix; <span style=color:blue>DestDir</span>: &quot;{app}&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: &quot;2X.exe&quot;; <span style=color:blue>Components</span>: 2X; <span style=color:blue>DestDir</span>: &quot;{app}&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: &quot;Plus.exe&quot;; <span style=color:blue>Components</span>: Plus; <span style=color:blue>DestDir</span>: &quot;{app}&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:green>;</span><span style=color:green>создаем</span><span style=color:green> </span><span style=color:green>ключ</span><span style=color:green> </span><span style=color:green>реестра</span><span lang=EN-US style=color:green>: </span><span style=color:green>корневой</span><span style=color:green> </span><span style=color:green>ключ</span><span lang=EN-US style=color:green> HKEY_CURRENT_USER, </span><span style=color:green>раздел</span><span style=color:green> <span lang=EN-US>Software\Vibor, </span></span><span style=color:green>параметр</span><span style=color:green> <span lang=EN-US>InstallSettings </span></span><span style=color:green>со</span><span style=color:green> </span><span style=color:green>строковым</span><span style=color:green> </span><span style=color:green>значением</span><span lang=EN-US style=color:green>, </span><span style=color:green>которое</span><span style=color:green> </span><span style=color:green>содержит</span><span style=color:green> </span><span style=color:green>полный</span><span style=color:green> </span><span style=color:green>путь</span><span style=color:green> </span><span style=color:green>к</span><span style=color:green> </span><span style=color:green>файлу</span><span style=color:green> </span><span style=color:green>инсталлятора</span><span lang=EN-US style=color:green> ({src}\Vibor 1.0.exe)</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Registry]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Root</span><span lang=EN-US>: HKCU; <span style=color:blue>Subkey</span>: &quot;Software\Vibor&quot;; <span style=color:blue>ValueType</span>: String; <span style=color:blue>ValueName</span>: InstallSettings; <span style=color:blue>ValueData</span>: &quot;{src}\Vibor 1.0.exe&quot;; <span style=color:blue>Flags</span>: uninsdeletekey</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><span style=color:green>;и небольшой код, в котором описывается константа </span><span lang=EN-US style=color:green>MyConst</span><span style=color:green> – с ее помощью будет определен путь к инсталлятору, которым будет пользоваться директива </span><span lang=EN-US style=color:green>AppModifyPath</span><span style=color:green> при изменении программы из Панели управления</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Code]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>function</span><span lang=EN-US> MyConst(Default: String): String;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>var</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>ResultStr</span><span lang=EN-US>: String;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>  begin</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>    RegQueryStringValue(HKCU, 'Software\Vibor', 'InstallSettings', ResultStr);</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>    Result</span>:=<span lang=EN-US>ResultStr</span>;</p><p class=MsoBodyTextIndent2><span style=color:blue>  </span><span lang=EN-US style=color:blue>end</span>;</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>Скрипт считывает из реестра значение параметра <span lang=EN-US>InstallSettings</span> и присваивает его строковой переменной <span lang=EN-US>ResultStr</span>, после чего она присваивается значению функции <span lang=EN-US>Result</span>.</p><p class=MsoBodyTextIndent2>Директива <span lang=EN-US style=color:blue>AppModifyPath</span><span lang=EN-US style=color:blue> </span>может по-разному вычислять местонахождение инсталлятора (не только с помощью записи в реестре) – применяйте методы на свой вкус.</p><p class=MsoBodyTextIndent2>Работа всех секций, приведенных в данном примере, будет подробнее рассмотрена ниже.</p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>&nbsp;</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>Если приложение не нуждается в директории</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>&nbsp;</span></b></p><p class=MsoBodyTextIndent2>Допустим, что написанное вами приложение не нуждается в собственной директории, а входящие в него файлы должны установиться в разные уже существующие директории в системе пользователя. Рассмотрим задачу на это тему.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b>Задача</b>: Приложение является надстройкой для <span lang=EN-US>Windows</span>. Естественно, все его файлы должны быть установлены в папку <span lang=EN-US>Windows</span>.</p><p class=MsoBodyTextIndent2><b>Решение</b>:</p><p class=MsoNormal><span style=font-size:11.0pt>Директива <span style=color:blue>CreateAppDir</span> отвечает за создание папки приложения. Если <span style=color:blue>CreateAppDir</span>=</span><span lang=EN-US style=font-size:11.0pt>yes</span><span style=font-size:11.0pt> (по умолчанию), для приложения нужно будет обязательно указывать <span style=color:blue>DefaultDirName</span>. Если же <span style=color:blue>CreateAppDir</span>=</span><span lang=EN-US style=font-size:11.0pt>no</span><span style=font-size:11.0pt>, папка для приложения создаваться не будет, выбор последней предлагаться не будет, константа {</span><span lang=EN-US style=font-size:11.0pt>app</span><span style=font-size:11.0pt>} будет равна {</span><span lang=EN-US style=font-size:11.0pt>win</span><span style=font-size:11.0pt>}, т.е. приложение установится в папку </span><span lang=EN-US style=font-size:11.0pt>Windows</span><span style=font-size:11.0pt>. Если при этом включено создание деинсталлятора, он будет создан в системной папке </span><span lang=EN-US style=font-size:11.0pt>Windows</span><span style=font-size:11.0pt>. Скрипт</span><span style=font-size:11.0pt> </span><span style=font-size:11.0pt>будет</span><span style=font-size:11.0pt> </span><span style=font-size:11.0pt>примерно</span><span style=font-size:11.0pt> </span><span style=font-size:11.0pt>следующий</span><span lang=EN-US style='font-size:
11.0pt'>:</span></p><p class=MsoNormal><span lang=EN-US style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal><b><span lang=EN-US style=font-size:11.0pt>[Setup]</span></b></p><p class=MsoNormal><span lang=EN-US style=font-size:11.0pt;color:blue>AppName</span><span lang=EN-US style=font-size:11.0pt>=Proga</span></p><p class=MsoNormal><span lang=EN-US style=font-size:11.0pt;color:blue>AppVerName</span><span lang=EN-US style=font-size:11.0pt>=Proga 1.0</span></p><p class=MsoNormal><span lang=EN-US style=font-size:11.0pt;color:blue>AppPublisher</span><span lang=EN-US style=font-size:11.0pt>=My Company, Inc.</span></p><p class=MsoNormal><span lang=EN-US style=font-size:11.0pt;color:blue>AppPublisherURL</span><span style=font-size:11.0pt>=</span><span lang=EN-US style=font-size:11.0pt>http</span><span style=font-size:11.0pt>://</span><span lang=EN-US style=font-size:11.0pt>www</span><span style=font-size:11.0pt>.</span><span lang=EN-US style=font-size:11.0pt>mycompany</span><span style=font-size:11.0pt>.</span><span lang=EN-US style=font-size:11.0pt>com</span></p><p class=MsoNormal><span style=font-size:11.0pt;color:green>;задаем не создавать папки для приложения (оно будет установлено в папку </span><span lang=EN-US style=font-size:11.0pt;color:green>Windows</span><span style=font-size:11.0pt;color:green>)</span></p><p class=MsoNormal><span lang=EN-US style=font-size:11.0pt;color:blue>CreateAppDir</span><span style=font-size:11.0pt>=</span><span lang=EN-US style=font-size:11.0pt>no</span></p><p class=MsoNormal><span lang=EN-US style=font-size:11.0pt;color:blue>Compression</span><span style=font-size:11.0pt>=</span><span lang=EN-US style=font-size:11.0pt>lzma</span></p><p class=MsoNormal><span style=font-size:11.0pt;color:green>;деинсталлятор будет создан и помещен в системную папку</span></p><p class=MsoNormal><span lang=EN-US style=font-size:11.0pt;color:blue>UninstallFilesDir</span><span style=font-size:11.0pt>=&quot;{</span><span lang=EN-US style=font-size:11.0pt>app</span><span style=font-size:11.0pt>}\</span><span lang=EN-US style=font-size:11.0pt>System</span><span style=font-size:11.0pt>&quot;</span></p><p class=MsoNormal><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal><b><span style=font-size:11.0pt>[</span></b><b><span lang=EN-US style=font-size:11.0pt>Files</span></b><b><span style='font-size:
11.0pt'>]</span></b></p><p class=MsoNormal><span style=font-size:11.0pt;color:green>;флаг </span><span lang=EN-US style=font-size:11.0pt;color:green>ignoreversion</span><span style=font-size:11.0pt;color:green> означает, что версии файлов будут игнорироваться</span></p><p class=MsoNormal><span lang=EN-US style=font-size:11.0pt;color:blue>Source</span><span lang=EN-US style=font-size:11.0pt>: &quot;C:\File1.EXE&quot;; <span style=color:blue>DestDir</span>: &quot;{win}&quot;; <span style=color:blue>Flags</span>: ignoreversion</span></p><p class=MsoNormal><span lang=EN-US style=font-size:11.0pt;color:blue>Source</span><span lang=EN-US style=font-size:11.0pt>: &quot;C:\File2.EXE&quot;; <span style=color:blue>DestDir</span>: &quot;{win}&quot;; <span style=color:blue>Flags</span>: ignoreversion</span></p><p class=MsoNormal><span lang=EN-US style=font-size:11.0pt;color:blue>Source</span><span lang=EN-US style=font-size:11.0pt>: &quot;C:\File3.EXE&quot;; <span style=color:blue>DestDir</span>: &quot;{app}\System32&quot;; <span style=color:blue>Flags</span>: ignoreversion</span></p><p class=MsoNormal><span lang=EN-US style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>В данном скрипте специально используются две константы: {</span><span lang=EN-US style=font-size:11.0pt>app</span><span style=font-size:11.0pt>} и {</span><span lang=EN-US style=font-size:11.0pt>win</span><span style=font-size:11.0pt>}, для того, чтобы продемонстрировать, что при </span><span lang=EN-US style=font-size:11.0pt;color:blue>CreateAppDir</span><span style='font-size:
11.0pt'>=</span><span lang=EN-US style=font-size:11.0pt>no</span><span style=font-size:11.0pt> они означают одно и то же.</span></p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Если же ваш инсталятор должен установить файлы не в папку </span><span lang=EN-US style=font-size:11.0pt>Windows</span><span style=font-size:11.0pt>, то в <span style=color:blue>DefaultDirName</span> указывается корневой каталог, а в секции <b>[</b></span><b><span lang=EN-US style=font-size:11.0pt>Files</span></b><b><span style=font-size:11.0pt>] </span></b><span style=font-size:11.0pt>в <span style=color:blue>DestDir</span> после {</span><span lang=EN-US style=font-size:11.0pt>app</span><span style=font-size:11.0pt>} указываются папки, в которые должны установиться файлы. Например</span><span lang=EN-US style=font-size:11.0pt>, </span><span style=font-size:11.0pt>инсталятор</span></p><p class=MsoNormal><span lang=EN-US style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal><b><span lang=EN-US style=font-size:11.0pt>[Setup]</span></b></p><p class=MsoNormal><span lang=EN-US style=font-size:11.0pt;color:blue>AppName</span><span lang=EN-US style=font-size:11.0pt>=Proga</span></p><p class=MsoNormal><span lang=EN-US style=font-size:11.0pt;color:blue>AppVerName</span><span lang=EN-US style=font-size:11.0pt>=Proga 1.0</span></p><p class=MsoNormal><span lang=EN-US style=font-size:11.0pt;color:blue>AppPublisher</span><span lang=EN-US style=font-size:11.0pt>=My Company, Inc.</span></p><p class=MsoNormal><span lang=EN-US style=font-size:11.0pt;color:blue>AppPublisherURL</span><span lang=EN-US style=font-size:11.0pt>=http://www.mycompany.com</span></p><p class=MsoNormal><span lang=EN-US style=font-size:11.0pt;color:blue>DefaultDirName</span><span lang=EN-US style=font-size:11.0pt>={pf}</span></p><p class=MsoNormal><span lang=EN-US style=font-size:11.0pt;color:blue>UsePreviousAppDir</span><span lang=EN-US style=font-size:11.0pt>=no</span></p><p class=MsoNormal><span lang=EN-US style=font-size:11.0pt;color:blue>UsePreviousGroup</span><span lang=EN-US style=font-size:11.0pt>=no</span></p><p class=MsoNormal><span lang=EN-US style=font-size:11.0pt;color:blue>Compression</span><span lang=EN-US style=font-size:11.0pt>=lzma</span></p><p class=MsoNormal><span lang=EN-US style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal><b><span lang=EN-US style=font-size:11.0pt>[Files]</span></b></p><p class=MsoNormal><span lang=EN-US style=font-size:11.0pt;color:blue>Source</span><span lang=EN-US style=font-size:11.0pt>: &quot;C:\File1.EXE&quot;; <span style=color:blue>DestDir</span>: &quot;{app}\Directory1&quot;; <span style=color:blue>Flags</span>: ignoreversion</span></p><p class=MsoNormal><span lang=EN-US style=font-size:11.0pt;color:blue>Source</span><span lang=EN-US style=font-size:11.0pt>: &quot;C:\File2.EXE&quot;; <span style=color:blue>DestDir</span>: &quot;{app}\Directory2&quot;; <span style=color:blue>Flags</span>: ignoreversion</span></p><p class=MsoNormal><span lang=EN-US style=font-size:11.0pt;color:blue>Source</span><span lang=EN-US style=font-size:11.0pt>: &quot;C:\File3.EXE&quot;; <span style=color:blue>DestDir</span>: &quot;{app}&quot;; <span style=color:blue>Flags</span>: ignoreversion</span></p><p class=MsoNormal><span lang=EN-US style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal><span style=font-size:11.0pt>установит</span><span style=font-size:11.0pt> </span><span style=font-size:11.0pt>файл</span><span lang=EN-US style=font-size:11.0pt> File1.exe </span><span style='font-size:
11.0pt'>в</span><span style=font-size:11.0pt> </span><span style='font-size:
11.0pt'>папку</span><span lang=EN-US style=font-size:11.0pt> C:\Program Files\Directory1, </span><span style=font-size:11.0pt>файл</span><span lang=EN-US style=font-size:11.0pt> File2.exe </span><span style='font-size:
11.0pt'>в</span><span style=font-size:11.0pt> </span><span style='font-size:
11.0pt'>папку</span><span lang=EN-US style=font-size:11.0pt> C:\Program Files\Directory2, </span><span style=font-size:11.0pt>файл</span><span lang=EN-US style=font-size:11.0pt> File3.exe </span><span style='font-size:
11.0pt'>в</span><span style=font-size:11.0pt> </span><span style='font-size:
11.0pt'>папку</span><span lang=EN-US style=font-size:11.0pt> C:\Program Files. </span><span style=font-size:11.0pt>Деинсталлятор будет расположен в папке </span><span lang=EN-US style=font-size:11.0pt>C</span><span style=font-size:11.0pt>:\</span><span lang=EN-US style=font-size:11.0pt>Program</span><span lang=EN-US style=font-size:11.0pt> </span><span lang=EN-US style='font-size:
11.0pt'>Files</span><span style=font-size:11.0pt>. Создание деинсталлятора можно отключить с помощью директивы <span style=color:blue>Uninstallable</span> (если эта директива равна </span><span lang=EN-US style=font-size:11.0pt>no</span><span style=font-size:11.0pt>, деинсталлятор создаваться не будет – автоматическое удаление приложения будет невозможно).</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Если пользователю нельзя менять путь установки приложения, используйте директиву <span style=color:blue>DisableDirPage</span> – при значении </span><span lang=EN-US style=font-size:11.0pt>yes</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>страница <i>Выбор папки назначения</i> отображаться не будет, а приложение установится в папку, заданную в </span><span lang=EN-US style=font-size:11.0pt;color:blue>DefaultDirName</span><span style=font-size:11.0pt>.</span></p><p class=MsoNormal><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Если приложение является обновлением для установленной программы, разумнее будет воспользоваться директивой </span><span lang=EN-US style='font-size:11.0pt;
color:blue'>AppId</span><span style=font-size:11.0pt> – о ней подробнее написано ниже. Если же вы создали обновление для программы, уже установленной в системе пользователя, у вас нет возможности воспользоваться директивой </span><span lang=EN-US style=font-size:11.0pt;color:blue>AppId</span><span style=font-size:11.0pt>, и вы не знаете, где именно установлена эта программа на компьютере пользователя, ему придется самому указать путь к папке программы на странице <i>Выбор папки установки</i>. Хотя именно в этом случае местонахождение уже установленного приложения в системе пользователя можно найти программно – с помощью секции <b>[</b></span><b><span lang=EN-US style=font-size:11.0pt>Code</span></b><b><span style=font-size:11.0pt>]</span></b><span style=font-size:11.0pt>. В данной статье приведено несколько таких способов: ниже, при описании секции <b>[</b></span><b><span lang=EN-US style='font-size:
11.0pt'>Ini</span></b><b><span style=font-size:11.0pt>]</span></b><span style=font-size:11.0pt>, и выше, при описании директивы<b> </b></span><span lang=EN-US style=color:blue>AppModifyPath</span><b><span lang=EN-US style=font-size:11.0pt> </span></b><span style=font-size:11.0pt>секции <b>[</b></span><b><span lang=EN-US style=font-size:11.0pt>Setup</span></b><b><span style='font-size:
11.0pt'>]</span></b></p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>Предупреждения при установке в существующую папку</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>&nbsp;</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>За появление сообщения «Папка … уже существует. Вы хотите продолжить установку в эту папку?» отвечает директива <span style=color:blue>DirExistsWarning</span>. При <span style=color:blue>DirExistsWarning</span>=</span><span lang=EN-US style=font-size:11.0pt>auto</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>инсталятор выдаст это сообщение, если <span style=color:blue>UsePreviousAppDir</span>=</span><span lang=EN-US style=font-size:11.0pt>no</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>или установка производится в папку впервые. При <span style=color:blue>UsePreviousAppDir</span>=</span><span lang=EN-US style=font-size:11.0pt>yes</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>сообщение появится только при первой установке. Если <span style=color:blue>DirExistsWarning</span>=</span><span lang=EN-US style=font-size:11.0pt>yes</span><span style=font-size:11.0pt>, сообщение будет появляться всегда, а если <span style=color:blue>DirExistsWarning</span>=</span><span lang=EN-US style=font-size:11.0pt>no</span><span style=font-size:11.0pt>, то не будет появляться никогда.</span></p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>Предупреждение при установке в несуществующую папку</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>&nbsp;</span></b></p><p class=MsoNormal style=text-indent:27.0pt>За появление сообщения «Папка … не существует. Создать?» отвечает директива <span style='font-size:11.0pt;
color:blue'>EnableDirDoesntExistWarning</span><span style=font-size:11.0pt>. Если <span style=color:blue>EnableDirDoesntExistWarning</span>=</span><span lang=EN-US style=font-size:11.0pt>yes</span><span style=font-size:11.0pt>, сообщение будет появляться, а если <span style=color:blue>EnableDirDoesntExistWarning</span>=</span><span lang=EN-US style=font-size:11.0pt>no</span><span style=font-size:11.0pt>, то не будет. Также стоит обратить внимание на то, что директива эта будет действовать только при <span style=color:blue>DirExistsWarning</span>=no.</span></p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>Информация, отображаемая до и после установки</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>&nbsp;</span></b></p><p class=MsoBodyTextIndent2>Информацию можно отобразить несколькими способами: в лицензионном соглашении, информации на странице самого инсталлятора или в открывающемся окне Блокнота. Текстовые файлы, используемые при этом, должны находиться либо в папке скрипта, либо к ним должен быть указан полный путь. Рассмотрим каждый из вариантов подробнее.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span style=font-size:12.0pt>1. Лицензионное соглашение</span></b></p><p class=MsoBodyTextIndent2><b>&nbsp;</b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>LicenseFile</span>=<span lang=EN-US>license</span>.<span lang=EN-US>txt</span>. Для файла лицензии лучше всего использовать текстовый файл. В файле лицензии указываются авторские права, правила распространения программы и другая подобная информация, но никак не руководство по установке программы и комментарии автора.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span style=font-size:12.0pt>2. Информация перед установкой</span></b></p><p class=MsoBodyTextIndent2><b><span style=font-size:12.0pt>&nbsp;</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span style='font-size:11.0pt;
color:blue'>InfoBeforeFile</span><span style=font-size:11.0pt>=</span><span lang=EN-US style=font-size:11.0pt>MyInfoBefore</span><span style='font-size:
11.0pt'>.</span><span lang=EN-US style=font-size:11.0pt>txt</span><span style=font-size:11.0pt>. Эта информация будет отображена перед страницей <i>Выбор папки установки</i> прямо в окне инсталлятора. Здесь можно поместить советы по установке программы и другую информацию, которая будет полезна пользователю для успешной инсталляции вашего приложения.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><b>3. Информация после установки</b></p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoNormal style=text-indent:27.0pt><span style='font-size:11.0pt;
color:blue'>InfoAfterFile</span><span style=font-size:11.0pt>=</span><span lang=EN-US style=font-size:11.0pt>MyInfoAfter</span><span style='font-size:
11.0pt'>.</span><span lang=EN-US style=font-size:11.0pt>txt</span><span style=font-size:11.0pt>. Эта информация будет отображена после успешной установки приложения прямо в окне инсталлятора.</span></p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span style=font-size:12.0pt>4. Информация на странице Блокнота</span></b></p><p class=MsoBodyTextIndent2><b><span style=font-size:12.0pt>А) отображается после удачной установки (перед страницей <i>Установка завершена</i>)</span></b></p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>За запуск приложений после удачной установки отвечает секция <b>[</b><b><span lang=EN-US>Run</span></b><b>]</b>. Скрипт может быть следующим:</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b>[Run]</b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Filename</span>: &quot;{<span lang=EN-US>app</span>}\<span lang=EN-US>ReadMe</span>.<span lang=EN-US>txt</span>&quot;; <span lang=EN-US style=color:blue>Flags</span>: <span lang=EN-US>shellexec</span><span lang=EN-US> </span><span lang=EN-US>skipifsilent</span></p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>В этом случае файл <span lang=EN-US>ReadMe</span>.<span lang=EN-US>txt</span><span lang=EN-US> </span>запустится, хочет того пользователь или нет.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Run]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Filename</span><span lang=EN-US>: &quot;{app}\ReadMe.txt&quot;; <span style=color:blue>Description</span>: &quot;</span>Хочу прочитать файл<span lang=EN-US> ReadMe&quot;; Flags: postinstall shellexec skipifsilent</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2>В случае использования флага <b><span lang=EN-US>postinstall</span></b><b><span lang=EN-US> </span></b>файл <span lang=EN-US>ReadMe</span>.<span lang=EN-US>txt</span><span lang=EN-US> </span>отобразится только в том случае, если пользователь поставит галочку против строки «Хочу прочитать файл <span lang=EN-US>ReadMe</span>».</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>Кроме того, файл, который должен будет отобразиться после удачной установки, можно включить и в секцию <b>[</b><b><span lang=EN-US>Files</span></b><b>]</b>:</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b>[</b><b><span lang=EN-US>Files</span></b><b>]</b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span>: &quot;<span lang=EN-US>C</span>:\<span lang=EN-US>ReadMe</span>.<span lang=EN-US>txt</span>&quot;; <span lang=EN-US style=color:blue>DestDir</span>: &quot;{<span lang=EN-US>app</span>}&quot;</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>В этом случае файл <span lang=EN-US>ReadMe</span>.<span lang=EN-US>txt</span><span lang=EN-US> </span>будет установлен в папку приложения, и пользователь сможет его прочитать позже.</p><p class=MsoBodyTextIndent2>Также эта задача может быть решена проще: с помощью флага <b><span lang=EN-US>isreadme</span></b><span lang=EN-US> </span>секции <b>[</b><b><span lang=EN-US>Files</span></b><b>]</b>. Но это возможно только в случае, когда ваш инсталятор не должен перезагрузить компьютер пользователя после успешной установки. В противном случае пользователь не сможет прочитать информацию сразу после установки программы.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:16.0pt>Секция [Tasks]</span></b></p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>Бывает так, что в ходе установки инсталятор должен выполнить какие-либо задания. Эти задания описываются в секции <b>[</b><b><span lang=EN-US>Tasks</span></b><b>]</b>. Следует помнить, что сама по себе секция <b>[</b><b><span lang=EN-US>Tasks</span></b><b>]</b> ничего не запускает и не создает. Чтобы задание действительно выполнилось, его надо вызвать из той секции, к которой оно относится. Для того чтобы стал понятен принцип работы этой секции, рассмотрим несколько практических задач.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>Задания для создания ярлыков</span></b></p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>Для задания для вынесения ярлыка на рабочий стол используем секции <b>[</b><b><span lang=EN-US>Tasks</span></b><b>] </b>и <b>[</b><b><span lang=EN-US>Icons</span></b><b>]</b>.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span lang=EN-US>… … … … … … … … … …</span></b></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Tasks]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span><span lang=EN-US>: &quot;DesktopIcon&quot;; <span style=color:blue>Description</span>: &quot;</span>Вынести ярлык на рабочий стол<span lang=EN-US>&quot;;  <span style=color:blue>Flags</span>: unchecked</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Icons]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span><span lang=EN-US>: &quot;{userdesktop}\Program&quot;; <span style=color:blue>IconFilename</span>: &quot;C:\Ikonka.ico&quot;; <span style=color:blue>Filename</span>: &quot;{app}\Program.EXE&quot;; <span style=color:blue>Tasks</span>: DesktopIcon</span></p><p class=MsoBodyTextIndent2><b>… … … … … … … … … …</b></p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>В секции <b>[</b><b><span lang=EN-US>Tasks</span></b><b>] </b>задание описывается. В окне инсталлятора оно появится после удачной установки приложения, перед страницей <i>Установка завершена</i>, и будет иметь вид строки, значение которой определит параметр <span lang=EN-US style=color:blue>Description</span>. Задание выполнится, если пользователь поставит флажок в <span lang=EN-US>checkbox</span>’е в начале этой строки.</p><p class=MsoBodyTextIndent2>В секции <b>[</b><b><span lang=EN-US>Icons</span></b><b>]</b> описывается, куда следует поместить ярлык, как ярлык будет озаглавлен и (по желанию) как он будет выглядеть, для какого именно файла он создается (подробнее работа этой секции будет рассмотрена далее). Параметр <span lang=EN-US style=color:blue>Tasks</span> секции <b>[</b><b><span lang=EN-US>Icons</span></b><b>]</b> вызывает задание, описанное в секции <b>[</b><b><span lang=EN-US>Tasks</span></b><b>]</b>. Если этот параметр не указать, то ярлык будет вынесен на рабочий стол, даже если пользователь не поставил флажок против строки «Вынести ярлык на рабочий стол».</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>Так выглядит задание для добавления программы в автозапуск:</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span lang=EN-US>… … … … … … … … … …</span></b></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Tasks]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span><span lang=EN-US>: &quot;AutoLaunch&quot;; <span style=color:blue>Description</span>: &quot;</span>Добавить в автозапуск<span lang=EN-US>&quot;; <span style=color:blue>Flags</span>: unchecked</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Icons]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span><span lang=EN-US>: &quot;{commonstartup}\Proga&quot;; <span style=color:blue>IconFilename</span>: &quot;C:\Ikonka.ico&quot;; <span style=color:blue>Filename</span>: &quot;{app}\Program.EXE&quot;; <span style=color:blue>Tasks</span>: AutoLaunch</span></p><p class=MsoBodyTextIndent2><b>… … … … … … … … … …</b></p><p class=MsoBodyTextIndent2><b>&nbsp;</b></p><p class=MsoBodyTextIndent2>Таким же образом создаются задания для помещения ярлыков в папку Мои документы (в секции <b>[</b><b><span lang=EN-US>Icons</span></b><b>]</b> используется константа {userdocs}), Избранное (в секции <b>[</b><b><span lang=EN-US>Icons</span></b><b>]</b> используется константа {userfavorites}), а также для добавления имени программы в контекстное меню <b>Отправить</b> (в секции <b>[</b><b><span lang=EN-US>Icons</span></b><b>]</b> используется константа {<span lang=EN-US>sendto</span>}).</p><p class=MsoBodyTextIndent2>Для добавления ярлыка программы в меню Пуск задание создавать не придется – достаточно присвоить директиве <span style=color:blue>AllowNoIcons</span> секции <b>[</b><b><span lang=EN-US>Setup</span></b><b>]</b> значение <span lang=EN-US>yes</span> – тогда пользователь на странице <i>Выбор программной группы </i>может выбрать, помещать ли ярлык программы в меню Пуск. Куда именно будет размещен ярлык программы – в главное меню Пуск или какую-то его папку, нужно указать в секции <b>[</b><b><span lang=EN-US>Icons</span></b><b>]</b> (об этом подробнее написано в разделе Секция <b>[</b><b><span lang=EN-US>Icons</span></b><b>]</b>).</p><p class=MsoBodyTextIndent2>Для запуска каких-либо файлов секция <b>[</b><b><span lang=EN-US>Tasks</span></b><b>]</b> не подходит – для этого существует секция <b>[</b><b><span lang=EN-US>Run</span></b><b>]</b>.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>&nbsp;</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>&nbsp;</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:16.0pt>Секция [</span></b><b><span lang=EN-US style=font-size:16.0pt>Icons</span></b><b><span style=font-size:16.0pt>]</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>&nbsp;</span></b></p><p class=MsoBodyTextIndent2>Секция <b>[</b><b><span lang=EN-US>Icons</span></b><b>] </b>отвечает за создание ярлыков при установке программы. Следует помнить, что если ярлыки указаны только в секции <b>[</b><b><span lang=EN-US>Icons</span></b><b>]</b>, они будут создаваться всегда, а если для ярлыка, описанного в секции <b>[</b><b><span lang=EN-US>Icons</span></b><b>]</b>, задан предварительно описанный в секции <b>[</b><b><span lang=EN-US>Tasks</span></b><b>]</b> параметр <span lang=EN-US style='color:
blue'>Tasks</span>, то ярлык будет создан, только если пользователь пожелает его создать (т.е. выберет соответствующее задание при установке программы).</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>Примеры создания ярлыков</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>&nbsp;</span></b></p><p class=MsoBodyTextIndent2><b>[</b><b><span lang=EN-US>Icons</span></b><b>]</b></p><p class=MsoBodyTextIndent2><span style=color:green>;Создаст группу программы в меню Пуск</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span><span lang=EN-US>: &quot;{group}\Proga&quot;; <span style=color:blue>IconFilename</span>: &quot;C:\Ikonka.ico&quot;; <span style=color:blue>Filename</span>: &quot;{app}\Program.exe&quot;</span></p><p class=MsoBodyTextIndent2><span style=color:green>;Создаст ярлык программы на Рабочем столе.</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span><span lang=EN-US>: &quot;{userdesktop}\Proga&quot;; <span style=color:blue>IconFilename</span>: &quot;C:\Ikonka.ico&quot;; <span style=color:blue>Filename</span>: &quot;{app}\ Program.exe”</span></p><p class=MsoBodyTextIndent2><span style=color:green>;Добавит ярлык программы в контекстное меню <b>Отправить</b></span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span>: &quot;{<span lang=EN-US>sendto</span>}\<span lang=EN-US>Proga</span>&quot;; <span lang=EN-US style=color:blue>IconFilename</span>: &quot;<span lang=EN-US>C</span>:\<span lang=EN-US>Ikonka</span>.<span lang=EN-US>ico</span>&quot;; <span lang=EN-US style=color:blue>Filename</span>: &quot;{<span lang=EN-US>app</span>}\ <span lang=EN-US>Program</span>.<span lang=EN-US>exe</span> &quot;</p><p class=MsoBodyTextIndent2><span style=color:green>;Добавит ярлык программы в <b>Автозапуск</b></span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span>: &quot;{<span lang=EN-US>commonstartup</span>}\<span lang=EN-US>Proga</span>&quot;; <span lang=EN-US style=color:blue>IconFilename</span>: &quot;<span lang=EN-US>C</span>:\<span lang=EN-US>Ikonka</span>.<span lang=EN-US>ico</span>&quot;; <span lang=EN-US style=color:blue>Filename</span>: &quot;{<span lang=EN-US>app</span>}\ <span lang=EN-US>Program</span>.<span lang=EN-US>exe</span> &quot;</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>Как видно из примеров,  месторасположение ярлыка зависит от заданной в параметре <span lang=EN-US style=color:blue>Name</span><span lang=EN-US> </span>константы.</p><p class=MsoBodyTextIndent2>Если куда-либо выносится ярлык для программы <span lang=EN-US>MS</span>-<span lang=EN-US>DOS</span>, пользователю будет приятно, если после выполнения программы окно закроется автоматически. Для этого используется флаг <b>closeonexit</b>:</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b>[</b><b><span lang=EN-US>Icons</span></b><b>]</b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span>: &quot;{<span lang=EN-US>userdesktop</span>}\<span lang=EN-US>Proga</span>&quot;; <span lang=EN-US style=color:blue>IconFilename</span>: &quot;<span lang=EN-US>C</span>:\<span lang=EN-US>Ikonka</span>.<span lang=EN-US>ico</span>&quot;; <span lang=EN-US style=color:blue>Filename</span>: &quot;{<span lang=EN-US>app</span>}\<span lang=EN-US>Program</span>.<span lang=EN-US>exe</span>&quot;; <span lang=EN-US style=color:blue>Flags</span>: <span lang=EN-US>closeonexit</span></p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>Всплывающую подсказку (хинт) для ярлыка на рабочем столе можно задать так:</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b>[</b><b><span lang=EN-US>Icons</span></b><b>]</b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span>: &quot;{<span lang=EN-US>userdesktop</span>}\<span lang=EN-US>Proga</span>&quot;; <span lang=EN-US style=color:blue>IconFilename</span>: &quot;<span lang=EN-US>C</span>:\<span lang=EN-US>Ikonka</span>.<span lang=EN-US>ico</span>&quot;; <span lang=EN-US style=color:blue>Filename</span>: &quot;{<span lang=EN-US>app</span>}\ <span lang=EN-US>Program</span>.<span lang=EN-US>exe</span>&quot;; <span lang=EN-US style=color:blue>Comment</span>: &quot;Это ярлык к программе <span lang=EN-US>Program</span>&quot;</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>Хинты будут отображаться только начиная с <span lang=EN-US>Windows</span><span lang=EN-US> </span><span lang=EN-US>Me</span>. Более ранние версии <span lang=EN-US>Windows</span><span lang=EN-US> </span>этот параметр не поддерживают. Также хинт не будет отображаться для ярлыков к программам <span lang=EN-US>MS</span>-<span lang=EN-US>DOS</span>.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>Так создастся группа для программы в меню Пуск &gt; Программы:</p><p class=MsoBodyTextIndent2><b>&nbsp;</b></p><p class=MsoBodyTextIndent2><b>[</b><b><span lang=EN-US>Icons</span></b><b>]</b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span>: &quot;{<span lang=EN-US>group</span>}\<span lang=EN-US>Proga</span>&quot;; <span lang=EN-US style=color:blue>IconFilename</span>: &quot;<span lang=EN-US>C</span>:\<span lang=EN-US>Ikonka</span>.<span lang=EN-US>ico</span>&quot;; <span lang=EN-US style=color:blue>Filename</span>: &quot;{<span lang=EN-US>app</span>}\<span lang=EN-US>Program</span>.<span lang=EN-US>exe</span>&quot;</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>Так – просто ярлык в меню Пуск &gt; Программы:</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Icons]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span><span lang=EN-US>: &quot;{commonprograms}\Proga&quot;;<span style=color:blue> IconFilename</span>: &quot;C:\Ikonka.ico&quot;; <span style=color:blue>Filename</span>: &quot;{app}\Program.exe&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2>Так ярлык добавится в главное меню Пуск<span lang=EN-US>:</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Icons]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span><span lang=EN-US>: &quot;{userstartmenu}\Proga&quot;; <span style=color:blue>IconFilename</span>: &quot;C:\Ikonka.ico&quot;; <span style=color:blue>Filename</span>: &quot;{app}\Program.exe&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2>Таким же образом создаются ярлыки в папках Мои документы (в секции <b>[</b><b><span lang=EN-US>Icons</span></b><b>]</b> используется константа {userdocs}), Избранное (в секции <b>[</b><b><span lang=EN-US>Icons</span></b><b>]</b> используется константа {userfavorites}).</p><p class=MsoBodyTextIndent2>Подробнее об использованных в примерах константах, а также о тех константах, которые не были упомянуты, можно прочитать в русском файле справки <b><span lang=EN-US>ISetup</span>.</b><b><span lang=EN-US>hlp</span><span lang=EN-US> </span></b>(раздел <b>Константы</b>).</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>Ярлык деинсталлятора в меню Пуск можно поместить так:</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b>[</b><b><span lang=EN-US>Icons</span></b><b>]</b></p><p class=MsoBodyTextIndent2><span style=color:green>;Создаст группу программы в меню Пуск, а в ней ярлык для запуска программы </span><span lang=EN-US style=color:green>Program</span><span style=color:green>.</span><span lang=EN-US style=color:green>exe</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span><span lang=EN-US>: &quot;{group}\Proga&quot;; <span style=color:blue>IconFilename</span>: &quot;C:\Ikonka.ico&quot;; <span style=color:blue>Filename</span>: &quot;{app}\Program.exe&quot;</span></p><p class=MsoBodyTextIndent2><span style=color:green>;Создаст в той же группе ярлык для деинсталлятора программы </span><span lang=EN-US style=color:green>Program</span><span style=color:green>.</span><span lang=EN-US style=color:green>exe</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span><span lang=EN-US>: &quot;{group}\UninstallProga&quot;; <span style=color:blue>Filename</span>: &quot;{uninstallexe}&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2>Параметру <span lang=EN-US style=color:blue>Filename</span><span lang=EN-US> </span>можно было присвоить и значение {<span lang=EN-US>app</span>}\<span lang=EN-US>unins</span>000.<span lang=EN-US>exe</span> – в данном случае эти значения равны.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>Задать «горячую клавишу» для ярлыка можно так (в комментарии к ярлыку следует указать это сочетание клавиш):</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b>[</b><b><span lang=EN-US>Icons</span></b><b>]</b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span>: &quot;{<span lang=EN-US>userdesktop</span>}\<span lang=EN-US>Proga</span>&quot;;<span style=color:blue> </span><span lang=EN-US style=color:blue>IconFilename</span>: &quot;<span lang=EN-US>C</span>:\<span lang=EN-US>Ikonka</span>.<span lang=EN-US>ico</span>&quot;; <span lang=EN-US style=color:blue>Filename</span>: &quot;{<span lang=EN-US>app</span>}\<span lang=EN-US>Program</span>.<span lang=EN-US>exe</span>&quot;; <span lang=EN-US style=color:blue>Comment</span>: &quot;Для запуска нажать <span lang=EN-US>ctrl</span>+<span lang=EN-US>alt</span>+<span lang=EN-US>k</span>&quot;; <span lang=EN-US style=color:blue>HotKey</span>: &quot;<span lang=EN-US>ctrl</span>+<span lang=EN-US>alt</span>+<span lang=EN-US>k</span>&quot;</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>Для того, чтобы программа при выборе ярлыка запускалась в свернутом окне, используется флаг <b>runminimized</b>:</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Icons]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span><span lang=EN-US>: &quot;{userdesktop}\Proga&quot;; <span style=color:blue>IconFilename</span>: &quot;C:\Ikonka.ico&quot;; <span style=color:blue>Filename</span>: &quot;{app}\ Program.exe”; <span style=color:blue>Flags</span>: runminimized</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoNormal align=center style=text-align:center><b><span style=font-size:16.0pt>Секции [</span></b><b><span lang=EN-US style=font-size:16.0pt>Components</span></b><b><span style=font-size:16.0pt>] и [Types]</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>&nbsp;</span></b></p><p class=MsoBodyTextIndent2>В секции <b>[</b><b><span lang=EN-US>Types</span></b><b>]</b> перечисляются типы установки программы. Следует помнить, что сама по себе секция <b>[</b><b><span lang=EN-US>Types</span></b><b>]</b> только описывает возможные для данной программы типы установки, и должна комбинироваться с другими секциями.</p><p class=MsoBodyTextIndent2>В секции <b>[</b><b><span lang=EN-US>Components</span></b><b>] </b>перечисляются компоненты, которые инсталлятор отобразит на странице <i>Выбор компонентов</i>. Комбинируется с секцией <b>[</b><b><span lang=EN-US>Types</span></b><b>]</b>, причем если в секции <b>[</b><b><span lang=EN-US>Components</span></b><b>]</b> перечислены компоненты, а секции <b>[</b><b><span lang=EN-US>Types</span></b><b>]</b> не существует, типы установки будут созданы инсталлятором автоматически, и могут быть не такими, как вам хотелось бы.</p><p class=MsoBodyTextIndent2>Работу секций рассмотрим на примерах.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoNormal align=center style=text-align:center;text-indent:27.0pt><b>Выбор устанавливаемых компонентов</b></p><p class=MsoNormal align=center style=text-align:center;text-indent:27.0pt><b>&nbsp;</b></p><p class=MsoNormal style=text-indent:27.0pt><b>Задача: </b><span style=font-size:11.0pt>имеется набор компонентов. По желанию пользователь может установить все компоненты или выбрать нужные ему из списка.</span></p><p class=MsoNormal style=text-indent:27.0pt><b>Решение:</b></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>В секции <b>[</b></span><b><span lang=EN-US style=font-size:11.0pt>Types</span></b><b><span style=font-size:11.0pt>]</span></b><span style=font-size:11.0pt> перечисляются все типы установки с их описанием. Для данной задачи можно создать два типа, например <b>Полная установка </b>и <b>Выборочная установка</b>, причем не забудьте указать компилятору, какая именно из установок является выборочной флагом </span><b><span lang=EN-US style=font-size:11.0pt>iscustom</span></b><span style=font-size:11.0pt>.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>В секции <b>[</b></span><b><span lang=EN-US style=font-size:11.0pt>Components</span></b><b><span style=font-size:11.0pt>] </span></b><span style=font-size:11.0pt>перечисляются компоненты для установки с описанием и указанием типов установки (параметр </span><span lang=EN-US style=font-size:11.0pt;color:blue>Types</span><span style=font-size:11.0pt>), к которым они относятся.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>В секции <b>[</b></span><b><span lang=EN-US style=font-size:11.0pt>Files</span></b><b><span style=font-size:11.0pt>] </span></b><span style=font-size:11.0pt>перечисляются файлы, которые собственно и будут установлены. Обязательно укажите, к какому компоненту относится каждый файл (параметр </span><span lang=EN-US style=font-size:11.0pt;color:blue>Components</span><span style='font-size:
11.0pt'>).</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Многоточия в начале и конце примера означают, что вверху должна находиться секция <b>[</b></span><b><span lang=EN-US style=font-size:11.0pt>Setup</span></b><b><span style='font-size:
11.0pt'>] </span></b><span style=font-size:11.0pt>с необходимыми параметрами, а внизу могут идти другие секции (например, <b>[</b></span><b><span lang=EN-US style=font-size:11.0pt>Tasks</span></b><b><span style=font-size:11.0pt>]</span></b><span style=font-size:11.0pt> или <b>[</b></span><b><span lang=EN-US style=font-size:11.0pt>Icons</span></b><b><span style=font-size:11.0pt>]</span></b><span style=font-size:11.0pt>).</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>&nbsp;</span></b></p><p class=MsoNormal style=text-indent:27.0pt><b><span lang=EN-US style=font-size:11.0pt>………………………………</span></b></p><p class=MsoNormal style=text-indent:27.0pt><b><span lang=EN-US style=font-size:11.0pt>[Types]</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Name</span><span lang=EN-US style=font-size:11.0pt>: &quot;polnaya&quot;; <span style=color:blue>Description</span>: &quot;</span><span style=font-size:11.0pt>Полная</span><span style=font-size:11.0pt> </span><span style=font-size:11.0pt>установка</span><span lang=EN-US style=font-size:11.0pt>&quot;</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Name</span><span lang=EN-US style=font-size:11.0pt>: &quot;viborochnaya&quot;; <span style=color:blue>Description</span>: &quot;</span><span style=font-size:11.0pt>Выборочная</span><span style=font-size:11.0pt> </span><span style=font-size:11.0pt>установка</span><span lang=EN-US style=font-size:11.0pt>&quot;; <span style=color:blue>Flags</span>: iscustom</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span lang=EN-US style=font-size:11.0pt>[Components]</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Name</span><span lang=EN-US style=font-size:11.0pt>: &quot;Component1&quot;; <span style=color:blue>Description</span>: &quot;</span><span style=font-size:11.0pt>Описание</span><span lang=EN-US style=font-size:11.0pt>: </span><span style=font-size:11.0pt>программа</span><span style=font-size:11.0pt> </span><span style=font-size:11.0pt>первая</span><span lang=EN-US style=font-size:11.0pt>&quot;; <span style=color:blue>Types</span>: polnaya viborochnaya</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Name</span><span lang=EN-US style=font-size:11.0pt>: &quot; Component 2&quot;; <span style=color:blue>Description</span>: &quot;</span><span style=font-size:11.0pt>Описание</span><span lang=EN-US style=font-size:11.0pt>: </span><span style=font-size:11.0pt>программа</span><span style=font-size:11.0pt> </span><span style=font-size:11.0pt>вторая</span><span lang=EN-US style=font-size:11.0pt>&quot;; <span style=color:blue>Types</span>: polnaya viborochnaya</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Name</span><span lang=EN-US style=font-size:11.0pt>: &quot; Component 3&quot;; <span style=color:blue>Description</span>: &quot;</span><span style=font-size:11.0pt>Описание</span><span lang=EN-US style=font-size:11.0pt>: </span><span style=font-size:11.0pt>программа</span><span style=font-size:11.0pt> </span><span style=font-size:11.0pt>третья</span><span lang=EN-US style=font-size:11.0pt>&quot;; <span style=color:blue>Types</span>: polnaya viborochnaya</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span lang=EN-US style=font-size:11.0pt>[Files]</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Source</span><span lang=EN-US style=font-size:11.0pt>: &quot;Program1.exe&quot;; <span style=color:blue>Components</span>: Component1; <span style=color:blue>DestDir</span>: &quot;{app}&quot;</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Source</span><span lang=EN-US style=font-size:11.0pt>: &quot; Program2.exe&quot;; <span style=color:blue>Components</span>: Component2; <span style=color:blue>DestDir</span>: &quot;{app}&quot;</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Source</span><span lang=EN-US style=font-size:11.0pt>: &quot; Program3.exe&quot;; <span style=color:blue>Components</span>: Component3; <span style=color:blue>DestDir</span>: &quot;{app}&quot;</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>………………………………</span></b></p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>Создать группу компонентов</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b>&nbsp;</b></p><p class=MsoBodyTextIndent2>Бывает так, что при установке компоненты для удобства и наглядности нужно разделить на группы, и из каждой из групп пользователь может выбрать один или несколько компонентов.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>Так создается группа компонентов:</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>[</span></b><b><span lang=EN-US style=font-size:11.0pt>Components</span></b><b><span style=font-size:11.0pt>]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span><span lang=EN-US>: &quot;Gruppa&quot;; <span style=color:blue>Description</span>: &quot;</span>Заголовок группы<span lang=EN-US>&quot;; <span style=color:blue>Types</span>: polnaya</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span><span lang=EN-US>: &quot;Gruppa\Component1&quot;; <span style=color:blue>Description</span>: &quot;</span>Компонент<span lang=EN-US> 1&quot;; <span style=color:blue>Types</span>: polnaya</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span><span lang=EN-US>: &quot;Gruppa\Component2&quot;; <span style=color:blue>Description</span>: &quot;</span>Компонент<span lang=EN-US> 2&quot;; <span style=color:blue>Types</span>: polnaya</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2>Если из двух компонентов группы должен быть выбран только один, для них используется флаг <b>exclusive</b>:</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoNormal style=text-indent:27.0pt><b><span lang=EN-US style=font-size:11.0pt>[Components]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span><span lang=EN-US>: &quot;Gruppa&quot;; <span style=color:blue>Description</span>: &quot;</span>Заголовок группы<span lang=EN-US>&quot;; <span style=color:blue>Types</span>: polnaya</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span><span lang=EN-US>: &quot;Gruppa\Component1&quot;; <span style=color:blue>Description</span>: &quot;</span>Компонент<span lang=EN-US> 1&quot;; <span style=color:blue>Types</span>: polnaya; <span style=color:blue>Flags</span>: exclusive</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span><span lang=EN-US>: &quot;Gruppa\Component2&quot;; <span style=color:blue>Description</span>: &quot;</span>Компонент<span lang=EN-US> 2&quot;; <span style=color:blue>Types</span>: polnaya; <span style=color:blue>Flags</span>: exclusive</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Files]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: &quot;Program1.exe&quot;; <span style=color:blue>Components</span>: Gruppa\Component1; <span style=color:blue>DestDir</span>: &quot;{app}&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: &quot;Program2.exe&quot;; <span style=color:blue>Components</span>: Gruppa\Component2; <span style=color:blue>DestDir</span>: &quot;{app}&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2>Лучше не объединять в группу компоненты, которые являются взаимоисключающими (имеют флаг <b>exclusive</b>) и не являются таковыми – пользователь наверняка запутается при выборе компонентов. Компоненты, из которых может быть выбран только один, лучше объединить в отдельную группу.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>«Зафиксировать» выбор компонента</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>&nbsp;</span></b></p><p class=MsoBodyTextIndent2>Если выбор компонента нельзя доверить пользователю – он должен быть выбран или не выбран в любом случае, используется флаг <b><span lang=EN-US>fixed</span></b>:</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Components]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span><span lang=EN-US>: &quot;Component&quot;; <span style=color:blue>Description</span>: &quot;</span>Компонент<span lang=EN-US>&quot;; <span style=color:blue>Types</span>: polnaya viborochnaya; <span style=color:blue>Flags</span>: fixed</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2>При использовании этого флага, какой бы тип установки ни выбрал пользователь, компонент с флагом <b><span lang=EN-US>fixed</span></b><span lang=EN-US> </span>будет всегда выбран (или не выбран), и пользователь не сможет этого изменить.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>Не выбирать автоматически компоненты группы</span></b></p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>Если вы не хотите, чтобы при выборе заголовка группы автоматически выбирался принадлежащий ей компонент (обычно при выборе заголовка группы автоматически выбираются все ее компоненты), используется флаг <b>dontinheritcheck</b>:</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoNormal style=text-indent:27.0pt><b><span lang=EN-US style=font-size:11.0pt>[Components]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span><span lang=EN-US>: &quot;Gruppa&quot;; <span style=color:blue>Description</span>: &quot;</span>Заголовок группы<span lang=EN-US>&quot;; <span style=color:blue>Types</span>: polnaya</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span><span lang=EN-US>: &quot;Gruppa\Component1&quot;; <span style=color:blue>Description</span>: &quot;</span>Компонент<span lang=EN-US> 1&quot;; <span style=color:blue>Types</span>: polnaya; <span style=color:blue>Flags</span>: dontinheritcheck</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span><span lang=EN-US>: &quot;Gruppa\Component2&quot;; <span style=color:blue>Description</span>: &quot;</span>Компонент<span lang=EN-US> 2&quot;; <span style=color:blue>Types</span>: polnaya</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2>Этот флаг не комбинируется с флагом <b>exclusive</b>.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:16.0pt>Секция [</span></b><b><span lang=EN-US style=font-size:16.0pt>Dirs</span></b><b><span style=font-size:16.0pt>]</span></b></p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>Секция в основном используется для создания пустых папок, которые создаст инсталлятор помимо папки приложения.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>Создадим подпапку в папке устанавливаемой программы:</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b>[Dirs]</b></p><p class=MsoBodyTextIndent2><span style=color:blue>Name</span>: &quot;{app}\<span lang=EN-US>Directory</span>&quot;</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>Так папка создастся в папке Мои документы у текущего пользователя:</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b>[Dirs]</b></p><p class=MsoBodyTextIndent2><span style=color:blue>Name</span>: &quot;{userdocs}\<span lang=EN-US>Directory</span>&quot;</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>Также создаваемые папки могут иметь атрибуты: «системная» (<span lang=EN-US>system</span>), «только для чтения» (<span lang=EN-US>readonly</span>) и «скрытая» (<span lang=EN-US>hidden</span>). За атрибуты папки отвечает параметр <span style=color:blue>Attribs</span>, и если он не указан, то папка не будет иметь вообще никаких атрибутов.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Dirs]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span><span lang=EN-US>: &quot;{app}\Directory&quot;; <span style=color:blue>Attribs</span>: readonly hidden</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2>Флаг <b>deleteafterinstall</b> указывает инсталлятору создать папку, но после успешной установки или если установка прервана удалить ее, если она пустая. Если в папке будут содержаться файлы, с помощью этого флага она не удалится.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>Флаг <b>uninsalwaysuninstall</b> указывает деинсталлятору всегда пытаться удалять папку (если она пустая), даже если она уже существовала до начала установки приложения.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>Флаг <b>uninsneveruninstall</b> указывает деинсталлятору не удалять папку при удалении программы – обычно при удалении программы деинсталлятор удаляет все папки, которые были созданы инсталлятором при установке (если они пустые).</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:16.0pt>Секция [</span></b><b><span lang=EN-US style=font-size:16.0pt>Files</span></b><b><span style=font-size:16.0pt>]</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center>&nbsp;</p><p class=MsoBodyTextIndent2>В этой секции указываются все файлы, которые инсталлятор может установить на компьютер пользователя. Примеры использования секции <b>[</b><b><span lang=EN-US>Files</span></b><b>]</b> в статье уже встречались. Рассмотрим принцип ее работы подробнее.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>Установить файл в папку приложения</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>&nbsp;</span></b></p><p class=MsoBodyTextIndent2>Установить файл <span lang=EN-US>Program</span>.<span lang=EN-US>exe</span><span lang=EN-US> </span>в папку приложения:</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Files]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: &quot;C:\Program.exe&quot;; <span style=color:blue>DestDir</span>: &quot;{app}&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2>Установить файл <span lang=EN-US>Program</span>.<span lang=EN-US>exe</span><span lang=EN-US> </span>в подпапку <span lang=EN-US>Papka</span><span lang=EN-US> </span>папки приложения:</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Files]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: &quot;C:\Program.exe&quot;; <span style=color:blue>DestDir</span>: &quot;{app}\Papka&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2>Подпапку, указанную в <span lang=EN-US style=color:blue>DestDir</span><span lang=EN-US> </span>(в данном случае <span lang=EN-US>Papka</span>) инсталлятор создаст автоматически.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>Задание компонентов</span></b></p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>Рассматривая секции <b>[</b><b><span lang=EN-US>Components</span></b><b>]</b> и <b>[</b><b><span lang=EN-US>Types</span>]</b>, разбирался пример, как указать инсталлятору, к какому из компонентов или к какой группе компонентов относится файл:</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoNormal style=text-indent:27.0pt><b><span lang=EN-US style=font-size:11.0pt>[Types]</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Name</span><span lang=EN-US style=font-size:11.0pt>: &quot;polnaya&quot;; <span style=color:blue>Description</span>: &quot;</span><span style=font-size:11.0pt>Полная</span><span style=font-size:11.0pt> </span><span style=font-size:11.0pt>установка</span><span lang=EN-US style=font-size:11.0pt>&quot;</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Name</span><span lang=EN-US style=font-size:11.0pt>: &quot;viborochnaya&quot;; <span style=color:blue>Description</span>: &quot;</span><span style=font-size:11.0pt>Выборочная</span><span style=font-size:11.0pt> </span><span style=font-size:11.0pt>установка</span><span lang=EN-US style=font-size:11.0pt>&quot;; <span style=color:blue>Flags</span>: iscustom</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span lang=EN-US style=font-size:11.0pt>[Components]</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Name</span><span lang=EN-US style=font-size:11.0pt>: &quot;Component1&quot;; <span style=color:blue>Description</span>: &quot;</span><span style=font-size:11.0pt>Описание</span><span lang=EN-US style=font-size:11.0pt>: </span><span style=font-size:11.0pt>программа</span><span style=font-size:11.0pt> </span><span style=font-size:11.0pt>первая</span><span lang=EN-US style=font-size:11.0pt>&quot;; <span style=color:blue>Types</span>: polnaya viborochnaya</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span lang=EN-US style=font-size:11.0pt>[Files]</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Source</span><span lang=EN-US style=font-size:11.0pt>: &quot;Program1.exe&quot;; <span style=color:blue>Components</span>: Component1; <span style=color:blue>DestDir</span>: &quot;{app}&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>Если файл является файлом </span></b><b><span lang=EN-US style=font-size:12.0pt>ReadMe</span></b></p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>Если устанавливаемый файл является файлом <span lang=EN-US>ReadMe</span>, инсталлятор после удачной установки приложения может предложить пользователю прочесть этот файл. Для этого используется флаг <b><span lang=EN-US>isreadme</span></b><span lang=EN-US> </span>секции <b>[</b><b><span lang=EN-US>Files</span></b><b>]</b>, но файл <span lang=EN-US>ReadMe</span><span lang=EN-US> </span>пользователь сможет прочитать, только если после установки компьютер не будет перезагружен.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Files]</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Source</span><span lang=EN-US style=font-size:11.0pt>: &quot;ReadMe.txt&quot;; <span style=color:blue>DestDir</span>: &quot;{app}&quot;; <span style=color:blue>Flags</span>: isreadme</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>&nbsp;</span></p><p class=MsoBodyTextIndent2>Чтобы файл с именем <span lang=EN-US>Program</span>.<span lang=EN-US>exe</span><span lang=EN-US> </span>после установки стал называться <span lang=EN-US>Proga</span>.<span lang=EN-US>exe</span>:</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Files]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: &quot;C:\Program.exe&quot;; <span style=color:blue>DestDir</span>: &quot;{app}&quot;; <span style=color:blue>DestName</span>: &quot;Proga.exe&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>Атрибуты файлов</span></b></p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>Также файлы секции <b>[</b><b><span lang=EN-US>Files</span></b><b>] </b>могут иметь атрибуты: «системный» (<span lang=EN-US>system</span>), «только для чтения» (<span lang=EN-US>readonly</span>) и «скрытый» (<span lang=EN-US>hidden</span>). За атрибуты файла отвечает параметр <span style=color:blue>Attribs</span>, и если он не указан, то файл не будет иметь вообще никаких атрибутов.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Files]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: &quot;C:\Program.exe&quot;; <span style=color:blue>DestDir</span>: &quot;{app}&quot;; <span style=color:blue>Attribs</span>: system hidden</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>Замена существующих файлов</span></b></p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b>1) </b>Установить файл, который, возможно, уже установлен на компьютере пользователя и имеет более позднюю дату создания, т.е. является более новым (в этом случае инсталлятор по умолчанию оставит существующий файл), поможет флаг <b>ignoreversion</b>.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Files]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: &quot;C:\Program.exe&quot;; <span style=color:blue>DestDir</span>: &quot;{app}&quot;; <span style=color:blue>Flags</span>: ignoreversion</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><b>2) </b>Если файл, который должен быть установлен на компьютер пользователя, имеет более позднюю версию или более раннее время создания (т.е. является более старым), чем уже установленный файл, и пользователь сам должен выбрать, заменять ли существующий файл более старым или оставить уже установленный более новый, используется флаг <b>promptifolder</b>. В таких ситуациях инсталлятор по умолчанию оставит уже установленный (более новый) файл.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Files]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: &quot;C:\Program.exe&quot;; <span style=color:blue>DestDir</span>: &quot;{app}&quot;; <span style=color:blue>Flags</span>: promptifolder</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><b>3) </b>Если файл, устанавливаемый из секции <b>[</b><b><span lang=EN-US>Files</span></b><b>]</b>, уже установлен на компьютере пользователя, и должен быть заменен или не заменен по желанию пользователя, используйте флаг <b>confirmoverwrite</b>.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Files]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: &quot;C:\Program.exe&quot;; <span style=color:blue>DestDir</span>: &quot;{app}&quot;; <span style=color:blue>Flags</span>: confirmoverwrite</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2>В этом случае инсталлятор при установке спросит пользователя, заменить ли существующий файл.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b>4) </b>Если инсталлируемый файл должен заменить уже установленный на компьютере пользователя файл с тем же именем, а если такого файла в системе пользователя нет, то вообще не устанавливаться, можно использовать флаг <b>onlyifdestfileexists</b>. Этот флаг полезен в том случае, когда вы создаете инсталлятор для обновления (апдейта) уже установленной у пользователя программы. Но следует помнить, что пользователь может переименовать некоторые файлы программы, и тогда обновление не установится, даже если пользователь установил программу.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Files]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: &quot;C:\Program.exe&quot;; <span style=color:blue>DestDir</span>: &quot;{app}&quot;; <span style=color:blue>Flags</span>: onlyifdestfileexists</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2>Обратная задача: установить файл только в том случае, если он не существует в системе пользователя, решается с помощью флага <b>onlyifdoesntexist</b>.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b>5) </b>Если на компьютере пользователя уже установлен файл с данным именем и атрибутом <span lang=EN-US>readlnly</span> («только для чтения»), при установке инсталлятор спросит у пользователя разрешения заменить существующий файл на новый. Если этого происходить не должно, т.е. файл с атрибутом <span lang=EN-US>readonly</span><span lang=EN-US> </span>должен всегда устанавливаться на компьютер пользователя, хочет пользователь того или нет, для файла указывается флаг <b>overwritereadonly</b>.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Files]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: &quot;C:\Program.exe&quot;; <span style=color:blue>DestDir</span>: &quot;{app}&quot;; <span style=color:blue>Flags</span>: overwritereadonly</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><b>6) </b>Если уже установленный и устанавливаемый файлы имеют одну версию, по умолчанию инсталлятор не заменит уже установленный файл. Если установленный файл должен быть заменен (что рекомендуется), используется флаг <b>replacesameversion</b>.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Files]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: &quot;C:\Program.exe&quot;; <span style=color:blue>DestDir</span>: &quot;{app}&quot;; <span style=color:blue>Flags</span>: replacesameversion</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2>О других флагах, поддерживаемых секцией <b>[</b><b><span lang=EN-US>Files</span></b><b>]</b>, можно прочитать в файле справки (раздел <b>Секция [</b><b><span lang=EN-US>Files</span></b><b>]</b>).</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>Установка архивов</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>&nbsp;</span></b></p><p class=MsoBodyTextIndent2>Если по какой-либо причине вы не хотите использовать методы сжатия файлов, которые поддерживает <span lang=EN-US>Inno</span><span lang=EN-US> </span><span lang=EN-US>Setup</span>, можно использовать для сжатия любой архиватор. Файлы для примеров в этой статье будут сжаты с помощью архиватора <span lang=EN-US>WinRAR</span>.</p><p class=MsoBodyTextIndent2>Если устанавливаемые файлы уже сжаты архиватором, внутреннее сжатие следует отключить: присвоив директиве <span style='color:
blue'>Compression</span> секции <b>[</b><b><span lang=EN-US>Setup</span></b><b>]</b> значение <span lang=EN-US>none</span>, сжатие вообще не будет использоваться, а если в секции <b>[</b><b><span lang=EN-US>Files</span></b><b>] </b>задать отдельному файлу флаг <b>nocompression</b>, то инсталлятор не будет сжимать только заданный файл.</p><p class=MsoBodyTextIndent2>Устанавливаются сжатые файлы так же, как и обычные:</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Files]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: &quot;C:\Program.rar&quot;; <span style=color:blue>DestDir</span>: &quot;{app}&quot;; <span style=color:blue>Flags</span>: nocompression</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2>Те же правила установки применяются и к  самораспаковывающимся архивам:</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Files]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: &quot;C:\Program.sfx.exe&quot;; <span style=color:blue>DestDir</span>: &quot;{app}&quot;; <span style=color:blue>Flags</span>: nocompression</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2>Самораспаковывающийся архив после установки можно запустить из секции <b>[</b><b><span lang=EN-US>Run</span></b><b>]</b>, а после распаковки (параметры которой можно задать при создании архива) удалить его. Это может выглядеть так<span lang=EN-US>:</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Files]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: &quot;C:\Program.sfx.exe&quot;; <span style=color:blue>DestDir</span>: &quot;{tmp}&quot;; <span style=color:blue>Flags</span>: nocompression</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2>Флаг <b><span lang=EN-US>deleteafterinstall</span></b><span lang=EN-US>  </span>в данном случае можно не использовать – архив устанавливается в папку <span lang=EN-US>Temp</span>, откуда потом удалится автоматически.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:16.0pt>Секция [</span></b><b><span lang=EN-US style=font-size:16.0pt>Ini</span></b><b><span style=font-size:16.0pt>]</span></b></p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>Секция <b>[</b><b><span lang=EN-US>Ini</span></b><b>]</b> работает с <span lang=EN-US>INI</span>-файлами. Сам формат скрипта <span lang=EN-US>Inno</span><span lang=EN-US> </span><span lang=EN-US>Setup</span> очень похож на <span lang=EN-US>INI</span>-файл. Если <span lang=EN-US>INI</span>-файл с заданным именем не существует в указанной папке, инсталлятор создаст его, а если <span lang=EN-US>INI</span>-файл уже существует, он может добавить, удалить или изменить записи в нем, а также удалить существующий <span lang=EN-US>INI</span>-файл и создать новый с тем же именем, но другим содержанием.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>Параметры секции</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center>&nbsp;</p><p class=MsoBodyTextIndent2><span style=color:blue>Filename</span> – имя <span lang=EN-US>INI</span>-файла (с расширением .<span lang=EN-US>ini</span>).</p><p class=MsoBodyTextIndent2><span style=color:blue>Section</span> – имя секции <span lang=EN-US>INI</span>-файла (в полученном <span lang=EN-US>INI</span>-файле будет заключено в квадратные скобки).</p><p class=MsoBodyTextIndent2><span style=color:blue>Key</span> – ключ <span lang=EN-US>INI</span>-файла.</p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>String</span> – значение ключа <span lang=EN-US>Key</span><span lang=EN-US> </span>(строка).</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>Так секция <span lang=EN-US>Settings</span><span lang=EN-US> </span><span lang=EN-US>INI</span>-файла <span lang=EN-US>IniFile</span>.<span lang=EN-US>ini</span><span lang=EN-US> </span>будет содержать ключ <span lang=EN-US>Version</span><span lang=EN-US> </span>равный 1.0.1:</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Ini]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Filename</span><span lang=EN-US>: &quot;{win}\IniFile.ini&quot;; <span style=color:blue>Section</span>: &quot;Settings&quot;; <span style=color:blue>Key</span>: &quot;Version&quot;; <span style=color:blue>String</span>: &quot;1.0.1&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>Определение местонахождения установленного приложения</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center>&nbsp;</p><p class=MsoBodyTextIndent2>Пользователь может установить ваше приложение в своей системе куда угодно – это его право. Допустим, что спустя время вы написали обновление для этого приложения, и оно должно быть установлено в ту же папку, что и программа. Перед вами встанет задача – определить, куда именно было установлено ваше приложение, и решить ее можно как минимум двумя способами: 1) при установке обновления пользователь сам укажет путь к папке, в которую он установил программу, на странице <i>Выбор папки установки</i>; 2) путь будет вычислен программно в секции <b>[</b><b><span lang=EN-US>Code</span></b><b>]</b>.</p><p class=MsoBodyTextIndent2>Определение пути к определенной папке с помощью записи в реестре мы уже рассмотрели, когда изучали принцип работы директивы <span lang=EN-US style=color:blue>AppModifyPath</span> секции <b>[</b><b><span lang=EN-US>Setup</span></b><b>]</b>. Теперь определим путь к папке приложения с помощью записи в <span lang=EN-US>INI</span>-файле.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b>Задача</b>: приложение <span lang=EN-US>Program</span><span lang=EN-US> </span>состоит из двух .<span lang=EN-US>exe</span>-файлов: <span lang=EN-US>Matrix</span>.<span lang=EN-US>exe</span> и 2<span lang=EN-US>X</span>.<span lang=EN-US>exe</span>. Обновление должно добавить в папку уже установленной программы файл <span lang=EN-US>Plus</span>.<span lang=EN-US>exe</span>, заменить файл <span lang=EN-US>Matrix</span>.<span lang=EN-US>exe</span><span lang=EN-US> </span>на <span lang=EN-US>MatrixUp</span>.<span lang=EN-US>exe</span> и добавить в файл <span lang=EN-US>IniFile</span>.<span lang=EN-US>ini</span>, который находится в папке <span lang=EN-US>Windows</span>, запись о версии программы.  </p><p class=MsoBodyTextIndent2><b>Решение:</b></p><p class=MsoBodyTextIndent2>В этом примере местонахождение установленной программы будет определено в секции <b>[</b><b><span lang=EN-US>Code</span></b><b>]</b>. При установке программы в папке <span lang=EN-US>Windows</span><span lang=EN-US> </span>системы пользователя создастся <span lang=EN-US>INI</span>-файл, с помощью которого в дальнейшем определится путь к папке приложения (в этом состоит недостаток метода: придется позаботиться об установке обновления заранее, еще при написании инсталлятора для самой программы).</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>Так будет выглядеть скрипт для программы:</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Setup]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AppName</span><span lang=EN-US>=Program</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AppVerName</span><span lang=EN-US>=Program 1.0</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>DefaultDirName</span><span lang=EN-US>={pf}\Program 1.0</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>DefaultGroupName</span><span lang=EN-US>=Program 1.0</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:green>;</span><span style=color:green>Имя</span><span style=color:green> </span><span style=color:green>полученного</span><span style=color:green> </span><span style=color:green>инсталятора</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>OutputBaseFilename</span><span lang=EN-US>=Program 1.9</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>SourceDir</span>=<span lang=EN-US>C</span>:\</p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AllowNoIcons</span>=<span lang=EN-US>yes</span></p><p class=MsoBodyTextIndent2><span style=color:green>;Во избежание каких-либо недоразумений отключим использование настроек предыдущей установки:</span></p><p class=MsoBodyTextIndent2><span style=color:green>;не использовать папку, которую выбрал пользователь в прошлый раз</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>UsePreviousAppDir</span>=<span lang=EN-US>no</span></p><p class=MsoBodyTextIndent2><span style=color:green>;не использовать группу меню Пуск, выбранную пользователем при предыдущей установке</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>UsePreviousGroup</span>=<span lang=EN-US>no</span></p><p class=MsoBodyTextIndent2><span style=color:green>;не использовать тип установки, выбранный пользователем в прошлый раз</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>UsePreviousSetupType</span>=<span lang=EN-US>no</span></p><p class=MsoBodyTextIndent2><span style=color:green>;не использовать задания, которые выбрал пользователь при прошлой установке</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>UsePreviousTasks</span><span lang=EN-US>=no</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AlwaysShowDirOnReadyPage</span><span lang=EN-US>=yes</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Files]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: &quot;Matrix.exe&quot;; <span style=color:blue>DestDir</span>: &quot;{app}&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: &quot;2X.exe&quot;; <span style=color:blue>DestDir</span>: &quot;{app}&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><span style=color:green>;создаем в </span><span lang=EN-US style=color:green>INI</span><span style=color:green>-файле </span><span lang=EN-US style=color:green>IniFile</span><span style=color:green>.</span><span lang=EN-US style=color:green>ini</span><span lang=EN-US style=color:green> </span><span style=color:green>секцию </span><span lang=EN-US style=color:green>InstallSettings</span><span style=color:green> и в ней ключ </span><span lang=EN-US style=color:green>InstallPath</span><span style=color:green> со строковым значением, равным полному пути к файлу инсталятора ({</span><span lang=EN-US style=color:green>src</span><span style=color:green>}\</span><span lang=EN-US style=color:green>Vibor</span><span style=color:green> 1.0.</span><span lang=EN-US style=color:green>exe</span><span style=color:green>).</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Ini]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Filename</span><span lang=EN-US>: &quot;{win}\IniFile.ini&quot;; <span style=color:blue>Section</span>: &quot;InstallSettings&quot;; <span style=color:blue>Key</span>: &quot;InstallPath&quot;; <span style=color:blue>String</span>: &quot;{app}&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><span style=color:green>;</span><span lang=EN-US style=color:green>INI</span><span style=color:green>-файлы не удаляются деинсталлятором при удалении программы, поэтому, если вы все-таки хотите, чтобы они удалились вместе с программой, удаление надо задать в секции <b>[UninstallDelete]</b></span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[UninstallDelete]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Type</span><span lang=EN-US>: files; <span style=color:blue>Name</span>: &quot;{win}\IniFile.ini&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2>Так – для обновления:</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b>[</b><b><span lang=EN-US>Setup</span></b><b>]</b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AppName</span>=<span lang=EN-US>Program</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AppVerName</span>=<span lang=EN-US>Program</span> 1.1</p><p class=MsoBodyTextIndent2><span style=color:green>;местонахождение папки приложения определится в секции <b>[</b></span><b><span lang=EN-US style=color:green>Code</span></b><b><span style=color:green>]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>DefaultDirName</span><span lang=EN-US>={code:MyConst}</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>DefaultGroupName</span><span lang=EN-US>=Program 1.1</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:green>;</span><span style=color:green>Имя</span><span style=color:green> </span><span style=color:green>полученного</span><span style=color:green> </span><span style=color:green>инсталятора</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>OutputBaseFilename</span><span lang=EN-US>=Program 1.1</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>SourceDir</span>=<span lang=EN-US>C</span>:\</p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AllowNoIcons</span>=<span lang=EN-US>yes</span></p><p class=MsoBodyTextIndent2><span style=color:green>;запрещает пользователю выбирать папку для установки обновления – страница <i>Выбор папки назначения </i>отображаться не будет</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>DisableDirPage</span>=<span lang=EN-US>yes</span></p><p class=MsoBodyTextIndent2><span style=color:green>;Во избежание каких-либо недоразумений отключим использование настроек предыдущей установки:</span></p><p class=MsoBodyTextIndent2><span style=color:green>;не использовать папку, которую выбрал пользователь в прошлый раз</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>UsePreviousAppDir</span>=<span lang=EN-US>no</span></p><p class=MsoBodyTextIndent2><span style=color:green>;не использовать группу меню Пуск, выбранную пользователем при предыдущей установке</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>UsePreviousGroup</span>=<span lang=EN-US>no</span></p><p class=MsoBodyTextIndent2><span style=color:green>;не использовать тип установки, выбранный пользователем в прошлый раз</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>UsePreviousSetupType</span>=<span lang=EN-US>no</span></p><p class=MsoBodyTextIndent2><span style=color:green>;не использовать задания, которые выбрал пользователь при прошлой установке</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>UsePreviousTasks</span><span lang=EN-US>=no</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AlwaysShowDirOnReadyPage</span><span lang=EN-US>=yes</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:green>;</span><span style=color:green>удаляем</span><span style=color:green> </span><span style=color:green>существующий</span><span style=color:green> </span><span style=color:green>файл</span><span style=color:green> <span lang=EN-US>Matrix.exe</span></span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[InstallDelete]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Type</span><span lang=EN-US>: files; <span style=color:blue>Name</span>: &quot;{app}\Matrix.exe&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><span style=color:green>;дополняем существующий </span><span lang=EN-US style=color:green>INI</span><span style=color:green>-файл </span><span lang=EN-US style=color:green>IniFile</span><span style=color:green>.</span><span lang=EN-US style=color:green>ini</span><span lang=EN-US style=color:green> </span><span style=color:green>новой секцией </span><span lang=EN-US style=color:green>Settings</span><span style=color:green>, содержащей ключ </span><span lang=EN-US style='color:
green'>Version</span><span lang=EN-US style=color:green> </span><span style=color:green>со значением 1.1</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Ini]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Filename</span><span lang=EN-US>: “{win}\IniFile.ini”; <span style=color:blue>Section</span>: “Settings”; <span style=color:blue>Key</span>: “Version”; <span style=color:blue>String</span>: “1.1”</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:green>;</span><span style=color:green>устанавливаем</span><span style=color:green> </span><span style=color:green>новые</span><span style=color:green> </span><span style=color:green>файлы</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Files]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: “MatrixUp.exe”; <span style=color:blue>DestDir</span>: “{app}”</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: “Plus.exe”; <span style=color:blue>DestDir</span>: “{app}”</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><span style=color:green>;и небольшой код, в котором описывается константа </span><span lang=EN-US style=color:green>MyConst</span><span style=color:green> – с ее помощью будет определен путь к инсталлятору, которым будет пользоваться директива </span><span lang=EN-US style=color:green>AppModifyPath</span><span style=color:green> при изменении программы из Панели управления</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Code]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US>  <span style=color:blue>function</span> MyConst(Default: String): String;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>   Begin</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>    Result:=GetIniString(‘InstallSettings’,’InstallPath’,’{app}’,’IniFile.ini’);</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>   end</span><span lang=EN-US>;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2>Скрипт считывает из секции <span lang=EN-US>InstallSettings INI-</span>файла <span lang=EN-US>IniFile.ini </span>значение ключа <span lang=EN-US>InstallPath </span>и присваивает его значению функции <span lang=EN-US>Result.</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>Секция [</span></b><b><span lang=EN-US style=font-size:12.0pt>Ini</span></b><b><span style=font-size:12.0pt>] и удаление программ</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center>&nbsp;</p><p class=MsoBodyTextIndent2>Из секции <b>[</b><b><span lang=EN-US>Ini</span></b><b>]</b> можно удалять только секции или параметры.</p><p class=MsoBodyTextIndent2><b>1)</b> Для того, чтобы при удалении программы удалялся определенный ключ в заданной секции, используется флаг <b>uninsdeleteentry</b>.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Ini]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Filename</span><span lang=EN-US>: &quot;{app}\IniFile.ini&quot;; <span style=color:blue>Section</span>: &quot;InstallSettings&quot;;<span style=color:blue> Key</span>: &quot;InstallPath&quot;; <span style=color:blue>String</span>: &quot;{app}&quot;; <span style=color:blue>Flags</span>: uninsdeleteentry</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Filename</span><span lang=EN-US>: &quot;{app}\IniFile.ini&quot;; <span style=color:blue>Section</span>: &quot;InstallSettings&quot;; <span style=color:blue>Key</span>: &quot;Installer&quot;; <span style=color:blue>String</span>: &quot;{src}&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Filename</span><span lang=EN-US>: &quot;{app}\IniFile.ini&quot;; <span style=color:blue>Section</span>: &quot;InstallSettings&quot;;<span style=color:blue> Key</span>: &quot;InstallVers&quot;; <span style=color:blue>String</span>: &quot;1.0&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2>В данном примере при удалении программы из секции <span lang=EN-US>InstallSettings</span><span lang=EN-US> </span>удалится ключ <span lang=EN-US>InstallPath</span> со своим значением.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b>2)</b> Для того, чтобы при удалении программы удалилась заданная секция со всеми ее ключами и их значениями, используется флаг <b>uninsdeletesection</b>.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Ini]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Filename</span><span lang=EN-US>: &quot;{app}\IniFile.ini&quot;; <span style=color:blue>Section</span>: &quot;InstallSettings&quot;;<span style=color:blue> Key</span>: &quot;InstallPath&quot;; <span style=color:blue>String</span>: &quot;{app}&quot;; <span style=color:blue>Flags</span>: uninsdeletesection</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Filename</span><span lang=EN-US>: &quot;{app}\IniFile.ini&quot;; <span style=color:blue>Section</span>: &quot;InstallSettings&quot;; <span style=color:blue>Key</span>: &quot;Installer&quot;; <span style=color:blue>String</span>: &quot;{src}&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Filename</span><span lang=EN-US>: &quot;{app}\IniFile.ini&quot;; <span style=color:blue>Section</span>: &quot;InstallSettings&quot;;<span style=color:blue> Key</span>: &quot;InstallVers&quot;; <span style=color:blue>String</span>: &quot;1.0&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2>В примере при удалении приложения секция <span lang=EN-US>InstallSettings</span> удалится со всеми ключами: <span lang=EN-US>InstallPath</span>, <span lang=EN-US>Installer</span> и <span lang=EN-US>InstallVers</span> и их значениями.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b>3)</b> Для того, чтобы при удалении программы удалялась только пустая секция, существует флаг <b>uninsdeletesectionifempty</b>. Его можно комбинировать с флагом <b>uninsdeleteentry</b> – таким образом вы предотвратите нежелательное удаление ключей.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b>4)</b> При удалении программы <span lang=EN-US>INI</span>-файлы с помощью секции <b>[</b><b><span lang=EN-US>Ini</span></b><b>]</b> полностью удалить нельзя – для этого существует секция <b>[</b><b><span lang=EN-US>UninstallDelete</span></b><b>]</b>:</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[UninstallDelete]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Type</span><span lang=EN-US>: files; <span style=color:blue>Name</span>: &quot;{win}\IniFile.ini&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>Если не надо менять существующее значение ключа</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b>&nbsp;</b></p><p class=MsoBodyTextIndent2>Допустим, что в указанной папке уже существует <span lang=EN-US>INI</span>-файл, содержащий ключ с именем, заданным в секции <b>[</b><b><span lang=EN-US>Ini</span></b><b>]</b>. Тогда при установке инсталлятор сравнит два ключа – уже существующий и тот, который он должен установить, и если они разные, то он заменит старое значение ключа новым. В ситуации, когда этого происходить не должно, применяется флаг <b>createkeyifdoesntexist</b> – с ним ключ с заданным именем будет создан только если до установки он не существовал.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Ini]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Filename</span><span lang=EN-US>: &quot;{app}\IniFile.ini&quot;; <span style=color:blue>Section</span>: &quot;InstallSettings&quot;;<span style=color:blue> Key</span>: &quot;InstallPath&quot;; <span style=color:blue>String</span>: &quot;{app}&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Filename</span><span lang=EN-US>: &quot;{app}\IniFile.ini&quot;; <span style=color:blue>Section</span>: &quot;InstallSettings&quot;; <span style=color:blue>Key</span>: &quot;Installer&quot;; <span style=color:blue>String</span>: &quot;{src}&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Filename</span><span lang=EN-US>: &quot;{app}\IniFile.ini&quot;; <span style=color:blue>Section</span>: &quot;InstallSettings&quot;;<span style=color:blue> Key</span>: &quot;InstallVers&quot;; <span style=color:blue>String</span>: &quot;1.0&quot;; <span style=color:blue>Flags</span>: createkeyifdoesntexist</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2>В данном примере в секции <span lang=EN-US>InstallSettings</span><span lang=EN-US> </span><span lang=EN-US>INI</span>-файла <span lang=EN-US>IniFile</span>.<span lang=EN-US>ini</span><span lang=EN-US> </span>ключ <span lang=EN-US>InstallVers</span> будет создан только в том случае, если до установки он не существовал. Если же ключ <span lang=EN-US>InstallVers</span> уже существовал, инсталлятор оставит его как есть, и не будет менять его значение.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoNormal align=center style=text-align:center><b><span style=font-size:16.0pt>Секции [InstallDelete] и [UninstallDelete]</span></b></p><p class=MsoNormal align=center style=text-align:center><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Эти секции отвечают за удаление файлов и/или папок перед установкой (<b>[InstallDelete]</b>) или при удалении (<b>[UninstallDelete]</b>) приложения.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>Задача:</span></b><span style=font-size:11.0pt> перед установкой обновления для установленной программы удалить в папке приложения (путь к которой укажет пользователь при установке приложения) директорию и все ее содержимое (подпапки и файлы), и создать папку с тем же именем, куда установить все файлы обновления.</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>Решение:</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>…………………………</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span style='font-size:11.0pt;
color:green'>;Перед установкой удалить в папке приложения папку </span><span lang=EN-US style=font-size:11.0pt;color:green>Data</span><span style=font-size:11.0pt;color:green> со всем ее содержимым</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[InstallDelete]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Type</span><span lang=EN-US>: filesandordirs; <span style=color:blue>Name</span>: &quot;{app}\Data&quot;</span></p><p class=MsoBodyTextIndent2><span style=color:green>;Создать папку с тем же именем, что и удаленная (хотя создавать ее не обязательно – инсталлятор все равно ее создаст при выполнении секции <b>[</b></span><b><span lang=EN-US style=color:green>Files</span></b><b><span style=color:green>]</span></b></p><p class=MsoBodyTextIndent2><b>[</b><b><span lang=EN-US>Dirs</span></b><b>]</b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span>: &quot;{<span lang=EN-US>app</span>}\<span lang=EN-US>Data</span>&quot;</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><span style=color:green>;Установить в созданную папку файлы</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Files]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: &quot;C:\Program1.exe&quot;; <span style=color:blue>DestDir</span>: &quot;{app}\Data&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: &quot;C:\Program2.exe&quot;; <span style=color:blue>DestDir</span>: &quot;{app}\Data&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: &quot;C:\ReadMe.txt&quot;; <span style=color:blue>DestDir</span>: &quot;{app}\Data&quot;; <span style=color:blue>Flags</span>: isreadme</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><span style=color:green>;При удалении приложения удалить созданную папку</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[UninstallDelete]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Type</span><span lang=EN-US>: filesandordirs; <span style=color:blue>Name</span>: &quot;{app}\Data&quot;</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>…………………………</span></b></p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>Эту же задачу можно решить с помощью секции <b>[</b><b><span lang=EN-US>Code</span></b><b>]</b>:</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span lang=EN-US>…………………………</span></b></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Files]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: &quot;C:\Program1.exe&quot;; <span style=color:blue>DestDir</span>: &quot;{app}\Data&quot;; <span style=color:blue>BeforeInstall</span>: MyBeforeInstall</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: &quot;C:\Program2.exe&quot;; <span style=color:blue>DestDir</span>: &quot;{app}\Data&quot;;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: &quot;C:\ReadMe.txt&quot;; <span style=color:blue>DestDir</span>: &quot;{app}\Data&quot;; <span style=color:blue>Flags</span>: isreadme</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[UninstallDelete]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Type</span><span lang=EN-US>: filesandordirs; <span style=color:blue>Name</span>: &quot;{app}\Data&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US> </span></p><p class=MsoBodyTextIndent2><b>[</b><b><span lang=EN-US>Code</span></b><b>]</b></p><p class=MsoBodyTextIndent2><span style=color:green>{Создать процедуру, которую инсталлятор вызовет перед установкой файла </span><span lang=EN-US style=color:green>Program</span><span style=color:green>1.</span><span lang=EN-US style=color:green>exe</span><span style=color:green>}</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Procedure</span><span lang=EN-US> </span><span lang=EN-US>MyBeforeInstall</span>;</p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Begin</span></p><p class=MsoBodyTextIndent2><span style=color:green>{Если в директории программы существует папка </span><span lang=EN-US style=color:green>Data</span><span style=color:green>, она удаляется со всеми вложенными в нее файлами и папками}</span></p><p class=MsoBodyTextIndent2><span style=color:blue> </span><span lang=EN-US style=color:blue>if</span><span lang=EN-US> DirExists(ExpandConstant('{app}\Data')) <span style=color:blue>then</span></span></p><p class=MsoBodyTextIndent2><span lang=EN-US>  DelTree(ExpandConstant('{app}\Data'), True, True, True);</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>end</span>;</p><p class=MsoBodyTextIndent2><b>…………………………</b></p><p class=MsoBodyTextIndent2><b>&nbsp;</b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>Использование «масок»</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>&nbsp;</span></b></p><p class=MsoBodyTextIndent2>Для того, чтобы не перечислять все однотипные файлы, которые следует удалить при установке или удалении программы, можно использовать «маску»:</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[InstallDelete]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Type</span><span lang=EN-US>: files; <span style=color:blue>Name</span>: &quot;{app}\*.ini&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2>В этом примере перед установкой программы из ее папки  удалятся все файлы с расширением <b>.</b><b><span lang=EN-US>ini</span></b>. Используйте «маски» для удаления файлов очень осторожно, особенно если ваше приложение устанавливается в папку <span lang=EN-US>Windows</span>.</p><p class=MsoBodyTextIndent2>Задание «масок» для инсталлятора то же, что и для <span lang=EN-US>Windows</span>: * - префикс (суффикс) любой длинны, ? – префикс (суффикс) из одного символа и т.д.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>Если вы не уверены, что удаление файлов с помощью секций <b>[</b><b><span lang=EN-US>InstallDelete</span></b><b>]</b> и <b>[</b><b><span lang=EN-US>UninstallDelete</span></b><b>]</b> пройдет безболезненно для системы пользователя, лучше их вообще не использовать – пользователь вручную удалит ненужные файлы и папки.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoNormal align=center style=text-align:center><b><span style=font-size:16.0pt>Секции [Run] и [UninstallRun]</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><span style=font-size:12.0pt>&nbsp;</span></p><p class=MsoBodyTextIndent2>В секции <b>[</b><b><span lang=EN-US>Run</span></b><b>]</b> перечисляются файлы, которые инсталлятор должен выполнить после удачной установки приложения (перед появлением страницы <i>Установка завершена</i>).</p><p class=MsoBodyTextIndent2>В секции <b>[</b><b><span lang=EN-US>U<u>ninstallRun</u></span></b><b><u>]</u></b><b> </b>перечисляются файлы, которые деинсталлятор должен выполнить перед удалением программы.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>Секция [</span></b><b><span lang=EN-US style=font-size:12.0pt>Run</span></b><b><span style=font-size:12.0pt>]: запустить программу после удачной установки</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>&nbsp;</span></b></p><p class=MsoBodyTextIndent2><b><span style=font-size:12.0pt>А) В любом случае</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>&nbsp;</span></b></p><p class=MsoBodyTextIndent2>Два следующих примера приведут к одному и тому же результату: после удачной установки программы запустится файл <span lang=EN-US>Program</span>.<span lang=EN-US>exe</span>.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Run]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>FileName</span><span lang=EN-US>: &quot;Program.exe&quot;; <span style=color:blue>WorkingDir</span>: &quot;{app}&quot;; <span style=color:blue>Flags</span>: nowait</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Run]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>FileName</span><span lang=EN-US>: &quot;{app}\Program.exe&quot;; <span style=color:blue>Flags</span>: nowait</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2>Параметр <span lang=EN-US style=color:blue>WorkingDir</span><span lang=EN-US style=color:blue> </span>задает папку, из которой будет запускаться файл. Если этот параметр не указан, следует задать полный путь к файлу в параметре <span lang=EN-US style=color:blue>FileName</span>.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>Для файлов, которые не являются исполняемыми (.exe или .com) или командными (.bat или .cmd), применяется флаг <b>shellexec</b> – в этом случае файл запустится с помощью программы, принятой по умолчанию для его типа (например, файл <span lang=EN-US>ReadMe</span>.<span lang=EN-US>txt</span><span lang=EN-US> </span>будет отображен на странице Блокнота). Флаг <b>shellexec</b> не определяет, выполнилась ли программа или нет, поэтому его следует комбинировать с флагами <b>nowait</b> (инсталлятор не будет ждать, пока запущенный файл выполнится, и сразу перейдет к следующему параметру секции <b>[</b><b><span lang=EN-US>Run</span></b><b>]</b>) или <b>waituntilidle</b> (в этом случае установка будет приостановлена для того, чтобы пользователь смог ввести необходимые данные). Пример:</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b>[</b><b><span lang=EN-US>Run</span></b><b>]</b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>FileName</span>: &quot;{<span lang=EN-US>app</span>}\<span lang=EN-US>ReadMe</span>.<span lang=EN-US>txt</span>&quot;; <span lang=EN-US style=color:blue>Flags</span>: <span lang=EN-US>shellexec</span><span lang=EN-US> </span><span lang=EN-US>nowait</span></p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>С помощью параметра <span style=color:blue>StatusMsg</span> можно задать сообщение, которое будет отображаться в окне инсталлятора во время выполнения файла. Если параметр не указан, будет отображаться стандартное сообщение.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b>[</b><b><span lang=EN-US>Run</span></b><b>]</b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>FileName</span>: &quot;{<span lang=EN-US>app</span>}\<span lang=EN-US>Program</span>.<span lang=EN-US>exe</span>&quot;; <span lang=EN-US style=color:blue>StatusMsg</span>: &quot;Выполнение программы <span lang=EN-US>Program</span>.<span lang=EN-US>exe</span>&quot;;  <span lang=EN-US style=color:blue>Flags</span>: <span lang=EN-US>skipifsilent</span></p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span style=font-size:12.0pt>Б) По желанию пользователя</span></b></p><p class=MsoBodyTextIndent2><b><span style=font-size:12.0pt>&nbsp;</span></b></p><p class=MsoBodyTextIndent2>Для того, чтобы пользователь мог выбрать, какие файлы он хочет запустить, а какие нет, используется флаг <b>postinstall</b>. Можно также указать комментарий к каждому из представленных на выполнение файлов с помощью параметра <span style=color:blue>Description</span> (если он не указан, инсталлятор будет использовать стандартный комментарий).</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Run]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Filename</span><span lang=EN-US>: &quot;{app}\ReadMe.txt&quot;; <span style=color:blue>Description</span>: &quot;</span>Прочитать файл <span lang=EN-US>ReadMe&quot;; <span style=color:blue>Flags</span>: postinstall shellexec</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2>Если для файла установлен флаг <b>unchecked</b>, флажок для него по умолчанию будет сброшен – по желанию пользователь сможет установить его.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>Секция [</span></b><b><span lang=EN-US style=font-size:12.0pt>UninstallRun</span></b><b><span style=font-size:12.0pt>]: запустить программу перед удалением</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>&nbsp;</span></b></p><p class=MsoBodyTextIndent2>Так перед удалением приложения запустится программа <span lang=EN-US>Program</span>.<span lang=EN-US>exe</span>:</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[UninstallRun]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>FileName</span><span lang=EN-US>: &quot;{win}\Program.exe&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2>Если некоторое приложение устанавливалось несколько раз (например, поверх него было установлено обновление), может оказаться, что файлы, предназначенные для запуска перед удалением, будут дублироваться. Чтобы этого не случилось, в секции <b>[</b><b><span lang=EN-US>UninstallRun</span></b><b>]</b> задается параметр <span style=color:blue>RunOnceId</span> – в этом случае, встретив несколько одинаковых файлов, которые необходимо запустить перед удалением, деинсталлятор выполнит только последний из них, остальные же проигнорирует. Значение параметра <span style=color:blue>RunOnceId </span>может быть любым – главное, чтобы эти значения совпадали, например, для программы и ее обновления.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[UninstallRun]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>FileName</span><span lang=EN-US>: “{win}\Program.exe”; <span style=color:blue>RunOnceId</span>: “DeleteProgram”</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>Флаги управления окнами</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>&nbsp;</span></b></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>h</span></b><b>idewizard</b> – во время выполнения программы окно инсталлятора будет скрыто.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b>Runhidden</b> – выполняемая программа (или файл) запустится в свернутом окне. Очевидно, не следует использовать этот флаг для программы, при выполнении которой потребуется участие пользователя (например, он должен будет ввести какие-либо данные).</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span lang=EN-US>r</span></b><b>unmaximized</b> – программа (файл) запустится в развернутом окне.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span lang=EN-US>runminimized</span></b> – программа (файл) запустится в свернутом окне.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>Специфичные для секций параметры и флаги</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center>&nbsp;</p><p class=MsoBodyTextIndent2><b>Секция [</b><b><span lang=EN-US>Run</span></b><b>]:</b></p><p class=MsoBodyTextIndent2>Параметры <span style=color:blue>Description</span>,<span style=color:blue> </span><span lang=EN-US style=color:blue>StatusMsg</span>, флаги <b>postinstall</b>, <b>unchecked</b>, <b>skipifnotsilent</b> (указывает инсталлятору не запускать файл при обычной (не ускоренной) установке), <b>skipifsilent </b>(указывает инсталлятору не запускать файл при быстрой и очень быстрой установке)  применимы только к секции <b>[</b><b><span lang=EN-US>Run</span></b><b>]</b>.</p><p class=MsoBodyTextIndent2>Параметр <span style=color:blue>RunOnceId</span> применим только к секции <b>[</b><b><span lang=EN-US>UninstallRun</span></b><b>]</b>.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>Не выдавать сообщение об ошибке, если запускаемый файл не существует</span></b></p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>Если предназначенный для выполнения файл может не существовать, и вы не хотите, чтобы инсталлятор/деинсталлятор выдавал при этом сообщения об ошибке, используйте для указанных в секциях <b>[</b><b><span lang=EN-US>Run</span></b><b>]</b>/<b> [</b><b><span lang=EN-US>UninstallRun</span></b><b>]</b> файлов флаг <b>skipifdoesntexist</b>.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2 align=center style=text-align:center>&nbsp;</p><p class=MsoNormal align=center style=text-align:center><b><span style=font-size:16.0pt>Секция [Registry]</span></b></p><p class=MsoNormal align=center style=text-align:center><b>&nbsp;</b></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Эта секция отвечает за создание, редактирование и удаление записей в реестре, которые сделает инсталлятор/деинсталлятор в процессе установки/удаления программы.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal align=center style=text-align:center;text-indent:27.0pt><b>Основные параметры секции</b></p><p class=MsoNormal align=center style=text-align:center;text-indent:27.0pt><b>&nbsp;</b></p><p class=MsoNormal style=text-indent:27.0pt><span style='font-size:11.0pt;
color:blue'>Root</span><span style=font-size:11.0pt> – корневой ключ. Может иметь следующие значения:</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>HKCR                (HKEY_CLASSES_ROOT)</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>HKCU                (HKEY_CURRENT_USER)</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>HKLM               (HKEY_LOCAL_MACHINE)</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>HKU                  (HKEY_USERS)</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>HKCC                (HKEY_CURRENT_CONFIG)</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Subkey</span><span lang=EN-US style=font-size:11.0pt> – </span><span style=font-size:11.0pt>имя</span><span style=font-size:11.0pt> </span><span style=font-size:11.0pt>раздела</span><span lang=EN-US style=font-size:11.0pt> (</span><span style=font-size:11.0pt>может</span><span style=font-size:11.0pt> </span><span style=font-size:11.0pt>включать</span><span style=font-size:11.0pt> </span><span style=font-size:11.0pt>константы</span><span lang=EN-US style=font-size:11.0pt>).</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span style='font-size:11.0pt;
color:blue'>ValueType</span><span style=font-size:11.0pt> – тип значения. Может быть следующим:</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>none</span><span style=font-size:11.0pt> – значение по умолчанию. Инсталлятор создаст пустой ключ без параметра; ValueName и ValueData при этом игнорируются.</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>string</span><span style=font-size:11.0pt> – инсталлятор создаст строковый параметр (REG_SZ).</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>expandsz</span><span style=font-size:11.0pt> – инсталлятор создаст расширенную строку (REG_EXPAND_SZ).</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>multisz</span><span style=font-size:11.0pt> – инсталлятор создаст многостроковый параметр (REG_MULTI_SZ).</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>dword</span><span style=font-size:11.0pt> – инсталлятор создаст целочисленный параметр (REG_DWORD).</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>binary</span><span style=font-size:11.0pt> – инсталлятор создаст двоичный параметр (REG_BINARY).</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>ValueName</span><span style='font-size:
11.0pt'> – имя создаваемого параметра (может включать константы).</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span style='font-size:11.0pt;
color:blue'>ValueData</span><span style=font-size:11.0pt> – значение параметра реестра.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Если параметр <span style=color:blue>ValueType</span> равен string, expandsz или multisz, это будет строка, которая может содержать константы.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Если тип данных dword, это будет десятичное (&quot;123&quot;), шестнадцатеричное (&quot;$7B&quot;), или константа, представляющая собой целое число.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Если тип данных binary - последовательность шестнадцатеричных – десятичных байтов в форме: &quot;00 ff 12 34&quot;.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Если тип данных none, параметр игнорируется.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal align=center style=text-align:center;text-indent:27.0pt><b>Примеры создания ключей реестра</b></p><p class=MsoNormal align=center style=text-align:center;text-indent:27.0pt><b>&nbsp;</b></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Так в корневом ключе </span><span lang=EN-US style=font-size:11.0pt>HKEY</span><span style=font-size:11.0pt>_</span><span lang=EN-US style=font-size:11.0pt>CURRENT</span><span style=font-size:11.0pt>_</span><span lang=EN-US style=font-size:11.0pt>USER</span><span style=font-size:11.0pt>, разделе </span><span lang=EN-US style='font-size:
11.0pt'>Software</span><span style=font-size:11.0pt> создастся пустой ключ </span><span lang=EN-US style=font-size:11.0pt>Key</span><span style=font-size:11.0pt> (без параметров):</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span lang=EN-US style=font-size:11.0pt>[Registry]</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Root</span><span lang=EN-US style=font-size:11.0pt>: HKCU; <span style=color:blue>Subkey</span>: &quot;Software\Key&quot;</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Так мы создадим в корневом ключе </span><span lang=EN-US style=font-size:11.0pt>HKEY</span><span style=font-size:11.0pt>_</span><span lang=EN-US style=font-size:11.0pt>LOCAL</span><span style=font-size:11.0pt>_</span><span lang=EN-US style=font-size:11.0pt>MACHINE</span><span style=font-size:11.0pt>, разделе </span><span lang=EN-US style='font-size:
11.0pt'>Software</span><span style=font-size:11.0pt>, ключ </span><span lang=EN-US style=font-size:11.0pt>Key</span><span style=font-size:11.0pt>, включающий строковый параметр с именем </span><span lang=EN-US style=font-size:11.0pt>Name</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>и значением </span><span lang=EN-US style=font-size:11.0pt>Data</span><span style=font-size:11.0pt>, и дочерний ключ </span><span lang=EN-US style=font-size:11.0pt>DochKey</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>для ключа </span><span lang=EN-US style=font-size:11.0pt>Key</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>с именем </span><span lang=EN-US style='font-size:
11.0pt'>Version</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>и значением 1.0:</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span lang=EN-US style=font-size:11.0pt>[Registry]</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Root</span><span lang=EN-US style=font-size:11.0pt>: HKLM; <span style=color:blue>Subkey</span>: &quot;Software\Key&quot;; <span style=color:blue>ValueType</span>: string; <span style=color:blue>ValueName</span>: &quot;Name&quot;; <span style=color:blue>ValueData</span>: &quot;Data&quot;</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Root</span><span lang=EN-US style=font-size:11.0pt>: HKLM; <span style=color:blue>Subkey</span>: &quot;Software\Key\DochKey&quot;; <span style=color:blue>ValueType</span>: string; <span style=color:blue>ValueName</span>: &quot;Version&quot;; <span style=color:blue>ValueData</span>: &quot;1.0&quot;</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal align=center style=text-align:center;text-indent:27.0pt><b>Дополнить существующее значение параметра реестра</b></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Константа {olddata} позволяет дополнить уже существующее значение параметра реестра, если его <span style=color:blue>ValueType</span> равен string, expandsz, или multisz.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Например, пусть основное приложение создаст параметр </span><span lang=EN-US style=font-size:11.0pt>Version</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>со значением 1.0 так:</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span lang=EN-US style=font-size:11.0pt>[Registry]</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Root</span><span lang=EN-US style=font-size:11.0pt>: HKCU; <span style=color:blue>Subkey</span>: &quot;Software\Matrix&quot;; <span style=color:blue>ValueType</span>: string; <span style=color:blue>ValueName</span>: &quot;Version&quot;; <span style=color:blue>ValueData</span>: &quot;1.0&quot;; <span style=color:blue>Flags</span>: createvalueifdoesntexist uninsdeletekey</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>а обновление для этого приложения дополнит его еще одним значением 1.1 так:</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span lang=EN-US style=font-size:11.0pt>[Registry]</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Root</span><span lang=EN-US style=font-size:11.0pt>: HKCU; <span style=color:blue>Subkey</span>: &quot;Software\Matrix&quot;; <span style=color:blue>ValueType</span>: string;<span style=color:blue> ValueName</span>: &quot;Version&quot;; <span style=color:blue>ValueData</span>: &quot;{olddata} 1.1&quot;; <span style=color:blue>Flags</span>: uninsdeletekey</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>В итоге значение строкового параметра </span><span lang=EN-US style='font-size:
11.0pt'>Version</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>будет равно 1.0 1.1.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Если параметр не существовал до запуска инсталятора или его тип не строковый, {olddata} без предупреждения удаляется. Удалится константа и в случае, если создается параметр типа multisz, а существующий параметр не является многостроковым (т.е. является REG_SZ или REG_EXPAND_SZ).</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Для вставки символа разрыва строки для параметра, имеющего  тип multisz, используется константа {break}.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal align=center style=text-align:center;text-indent:27.0pt><b>Замена ключей реестра и их значений</b></p><p class=MsoNormal align=center style=text-align:center;text-indent:27.0pt><b>&nbsp;</b></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Для начала следует заметить, что если инсталлятор не обнаружит ключа или параметра, который ему следует удалить перед созданием новых ключей или параметров, он не выдаст сообщения об ошибке, а просто создаст новый ключ или параметр по заданным правилам, а удалять ничего не будет.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>1)</span></b><span style=font-size:11.0pt> Флаг <b>deletekey</b> позволяет перед созданием нового ключа удалить уже существующий ключ со всеми его дочерними ключами, параметрами и значениями. В приведенном ниже примере перед созданием параметра </span><span lang=EN-US style=font-size:11.0pt>ReCom</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>в ключе </span><span lang=EN-US style=font-size:11.0pt>Matrix</span><span style=font-size:11.0pt>, этот ключ будет полностью удален, потом инсталлятор создаст новый ключ с тем же именем (</span><span lang=EN-US style=font-size:11.0pt>Matrix</span><span style=font-size:11.0pt>) и в нем – параметр </span><span lang=EN-US style=font-size:11.0pt>ReCom</span><span style=font-size:11.0pt>.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span lang=EN-US style=font-size:11.0pt>[Registry]</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Root</span><span lang=EN-US style=font-size:11.0pt>: HKCU;<span style=color:blue> Subkey</span>: &quot;Software\Matrix&quot;; <span style=color:blue>ValueType</span>: dword; <span style=color:blue>ValueName</span>: &quot;ReCom&quot;; <span style=color:blue>ValueData</span>: &quot;1&quot;; <span style=color:blue>Flags</span>: deletekey uninsdeletekey</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>2) </span></b><span style=font-size:11.0pt>Флаг <b>deletevalue</b> позволяет перед созданием нового параметра в ключе удалить уже существующий параметр того же типа и с тем же именем. В примере перед созданием строкового параметра </span><span lang=EN-US style=font-size:11.0pt>Version</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>в ключе </span><span lang=EN-US style=font-size:11.0pt>Matrix</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>инсталлятор удалит уже существующий в реестре строковый параметр </span><span lang=EN-US style=font-size:11.0pt>Version</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>и его значение, а потом создаст новый параметр </span><span lang=EN-US style=font-size:11.0pt>Version</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>со значением 1.1.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span lang=EN-US style=font-size:11.0pt>[Registry]</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Root</span><span lang=EN-US style=font-size:11.0pt>: HKCU; <span style=color:blue>Subkey</span>: &quot;Software\Matrix &quot;;<span style=color:blue> ValueType</span>: string; <span style=color:blue>ValueName</span>: &quot;Version&quot;; <span style=color:blue>ValueData</span>: &quot;1.1&quot;; <span style=color:blue>Flags</span>: deletevalue uninsdeletekey</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>3)</span></b><span style=font-size:11.0pt> Флаг <b>preservestringtype</b> действует следующим образом: если тип существующего параметра реестра не </span><span lang=EN-US style=font-size:11.0pt>string</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>или expandsz (т.е. не REG_SZ или REG_EXPAND_SZ), то он будет заменен строковым параметром с заданным значением, а если тип существующего параметра </span><span lang=EN-US style='font-size:
11.0pt'>string</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>или expandsz, заменится только его значение, а тип останется.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Если приложение создаст в ключе </span><span lang=EN-US style=font-size:11.0pt>Matrix</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>реестра параметр </span><span lang=EN-US style=font-size:11.0pt>Version</span><span style=font-size:11.0pt>, имеющий тип </span><span lang=EN-US style=font-size:11.0pt>dword</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>и значение 1:</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span lang=EN-US style=font-size:11.0pt>[Registry]</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Root</span><span lang=EN-US style=font-size:11.0pt>: HKCU; <span style=color:blue>Subkey</span>: “Software\Matrix”; <span style=color:blue>ValueType</span>: dword; <span style=color:blue>ValueName</span>: “Version”; <span style=color:blue>ValueData</span>: “1”; <span style=color:blue>Flags</span>: uninsdeletekey</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>то обновление для этого приложения изменит у параметра </span><span lang=EN-US style=font-size:11.0pt>Version</span><span style=font-size:11.0pt> тип с </span><span lang=EN-US style=font-size:11.0pt>dword</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>на </span><span lang=EN-US style=font-size:11.0pt>string</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>и значение с 1 на 1.0 следующим образом:</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span lang=EN-US style=font-size:11.0pt>[Registry]</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Root</span><span lang=EN-US style=font-size:11.0pt>: HKCU; <span style=color:blue>Subkey</span>: “Software\Matrix”; <span style=color:blue>ValueType</span>: string; <span style=color:blue>ValueName</span>: “Version”; <span style=color:blue>ValueData</span>: “1.0”; <span style=color:blue>Flags</span>: preservestringtype uninsdeletekey</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt> </span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Если же приложение создаст в ключе </span><span lang=EN-US style=font-size:11.0pt>Matrix</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>реестра параметр </span><span lang=EN-US style=font-size:11.0pt>Version</span><span style=font-size:11.0pt>, имеющий тип </span><span lang=EN-US style=font-size:11.0pt>expandsz</span><span style=font-size:11.0pt> и значение 1.0.0:</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span lang=EN-US style=font-size:11.0pt>[Registry]</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Root</span><span lang=EN-US style=font-size:11.0pt>: HKCU; <span style=color:blue>Subkey</span>: “Software\Matrix”; <span style=color:blue>ValueType</span>: expandsz; <span style=color:blue>ValueName</span>: “Version”; <span style=color:blue>ValueData</span>: “1.0.0”; <span style=color:blue>Flags</span>: uninsdeletekey</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>то обновление для этого приложения изменит у параметра </span><span lang=EN-US style=font-size:11.0pt>Version</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>только значение с 1.0.0 на 1.1.1, а тип </span><span lang=EN-US style=font-size:11.0pt>expandsz</span><span style=font-size:11.0pt> параметра не изменит, таким образом:</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span lang=EN-US style=font-size:11.0pt>[Registry]</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Root</span><span lang=EN-US style=font-size:11.0pt>: HKCU; <span style=color:blue>Subkey</span>: “Software\Matrix”; <span style=color:blue>ValueType</span>: string; <span style=color:blue>ValueName</span>: “Version”; <span style=color:blue>ValueData</span>: “1.1.1”; <span style=color:blue>Flags</span>: preservestringtype uninsdeletekey</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal align=center style=text-align:center;text-indent:27.0pt><b>Реестр и удаление приложения</b></p><p class=MsoNormal align=center style=text-align:center;text-indent:27.0pt><b>&nbsp;</b></p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>1) </span></b><span style=font-size:11.0pt>С помощью флага <b>uninsclearvalue</b> при удалении приложения параметр в реестре установится в пустую строку (с типом REG_SZ). Флаг не комбинируется с флагом <b>uninsdeletekey</b>.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Так ключ </span><span lang=EN-US style=font-size:11.0pt>Key</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>и его параметр </span><span lang=EN-US style=font-size:11.0pt>Version</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>типа </span><span lang=EN-US style=font-size:11.0pt>dword</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>со значением 1 при удалении приложения будет заменен ключом </span><span lang=EN-US style=font-size:11.0pt>Key</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>с пустым параметром </span><span lang=EN-US style=font-size:11.0pt>Version</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>типа REG_SZ.   </span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span lang=EN-US style=font-size:11.0pt>[Registry]</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Root</span><span lang=EN-US style=font-size:11.0pt>: HKCU; <span style=color:blue>Subkey</span>: &quot;Software\Key&quot;; <span style=color:blue>ValueType</span>: dword; <span style=color:blue>ValueName</span>: &quot;Version&quot;; <span style=color:blue>ValueData</span>: &quot;1&quot;; <span style=color:blue>Flags</span>: uninsclearvalue</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>2)</span></b><span style=font-size:11.0pt> Флаг <b>uninsdeletekey</b> при удалении приложения удаляет ключ реестра со всеми его дочерними ключами, параметрами и значениями. Так при удалении приложения удалится ключ </span><span lang=EN-US style='font-size:
11.0pt'>Key</span><span style=font-size:11.0pt> и его параметр </span><span lang=EN-US style=font-size:11.0pt>Version</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>со значением 1.1.1:</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>[Registry]</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Root</span><span lang=EN-US style=font-size:11.0pt>: HKCU; <span style=color:blue>Subkey</span>: &quot;Software\Key&quot;;<span style=color:blue> ValueType</span>: string; <span style=color:blue>ValueName</span>: &quot;Version&quot;; <span style=color:blue>ValueData</span>: &quot;1.1.1&quot;; <span style='color:
blue'>Flags</span>: uninsdeletekey</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>3)</span></b><span style=font-size:11.0pt> При использовании флага <b>uninsdeletekeyifempty</b> при удалении приложения ключ реестра удалится, только если он пустой. В примере ключ </span><span lang=EN-US style=font-size:11.0pt>Matrix</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>при удалении приложения удалится, если останется пустым:</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span lang=EN-US style=font-size:11.0pt>[Registry]</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Root</span><span lang=EN-US style=font-size:11.0pt>: HKLM;<span style=color:blue> Subkey</span>: &quot;Software\Matrix&quot;;<span style=color:blue> Flags</span>: uninsdeletekeyifempty</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>4) </span></b><span style=font-size:11.0pt>Когда установлен флаг <b>uninsdeletevalue</b>, при удалении приложения удалится параметр реестра и его значение. В примере при удалении программы из реестра удалится параметр </span><span lang=EN-US style=font-size:11.0pt>Version</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>со значением 1.0:</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span lang=EN-US style=font-size:11.0pt>[Registry]</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Root</span><span lang=EN-US style=font-size:11.0pt>: HKCU; <span style=color:blue>Subkey</span>: &quot;Software\Matrix&quot;; <span style=color:blue>ValueType</span>: string; <span style=color:blue>ValueName</span>: &quot;Version&quot;; <span style=color:blue>ValueData</span>: &quot;1.0&quot;; <span style=color:blue>Flags</span>: uninsdeletevalue</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Флаг </span><b><span lang=EN-US style=font-size:11.0pt>uninsdeletevalue</span></b><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>удобно использовать в комбинации с флагом </span><b><span lang=EN-US style='font-size:
11.0pt'>uninsdeletekeyifempty</span></b><span style=font-size:11.0pt> – если все значения в ключе реестра будут удалены, эффект будет тот же, что и при использовании флага <b>uninsdeletekey</b>, а если нет, то ключ с не удаленными по какой-либо причине параметрами удален не будет.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal align=center style=text-align:center;text-indent:27.0pt><b>Ключ (параметр) существует – заменить на данный, не существует – не создавать</b></p><p class=MsoNormal align=center style=text-align:center;text-indent:27.0pt><b>&nbsp;</b></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>В ситуациях, когда при установке уже существующий параметр в ключе реестра следует заменить новым, а если ключ или параметр не существует – не создавать ни ключа, ни параметра, используется флаг <b>dontcreatekey</b>. В примере если в ключе </span><span lang=EN-US style=font-size:11.0pt>Key</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>существует параметр </span><span lang=EN-US style=font-size:11.0pt>Version</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>любого типа и с любым значением, он заменится строковым параметром </span><span lang=EN-US style=font-size:11.0pt>Version</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>со значением 1.0, а если не существует, то инсталлятор не создаст параметра в реестре (остальные параметры и дочерние ключи в ключе </span><span lang=EN-US style='font-size:
11.0pt'>Key</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>останутся без изменения). Если при этом в реестре не существует сам ключ </span><span lang=EN-US style=font-size:11.0pt>Key</span><span style=font-size:11.0pt>, инсталлятор его не создаст.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span lang=EN-US style=font-size:11.0pt>[Registry]</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Root</span><span lang=EN-US style=font-size:11.0pt>: HKCU; <span style=color:blue>Subkey</span>: “Software\Key”; <span style=color:blue>ValueType</span>: string; <span style=color:blue>ValueName</span>: “Version”; <span style=color:blue>ValueData</span>: “1.0”; <span style=color:blue>Flags</span>: dontcreatekey</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal align=center style=text-align:center;text-indent:27.0pt><b>Создать ключ (параметр) только если он не существует</b></p><p class=MsoNormal align=center style=text-align:center;text-indent:27.0pt><b>&nbsp;</b></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>При использовании флага <b>createvalueifdoesntexist</b> инсталлятор создаст в ключе реестра параметр с заданным значением только в том случае, если он не существует. Если инсталлятор при установке обнаружит, что параметр с заданным именем уже существует, изменять его он не будет. В примере если инсталлятор при установке обнаружит, что в ключе </span><span lang=EN-US style=font-size:11.0pt>Matrix</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>уже существует параметр с именем </span><span lang=EN-US style=font-size:11.0pt>Version</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>любого типа и с любым значением, он оставит его как есть, а если параметр с именем </span><span lang=EN-US style=font-size:11.0pt>Version</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>не существует, инсталлятор создаст строковый параметр </span><span lang=EN-US style=font-size:11.0pt>Version</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>со значением 1.0.0. Если при этом в реестре не существует сам ключ </span><span lang=EN-US style=font-size:11.0pt>Matrix</span><span style=font-size:11.0pt>, инсталлятор создаст сначала его, а потом параметр </span><span lang=EN-US style=font-size:11.0pt>Version</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>в нем.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span lang=EN-US style=font-size:11.0pt>[Registry]</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Root</span><span lang=EN-US style=font-size:11.0pt>: HKCU; <span style=color:blue>Subkey</span>: &quot;Software\Matrix&quot;; <span style=color:blue>ValueType</span>: string; <span style=color:blue>ValueName</span>: &quot;Version&quot;; <span style=color:blue>ValueData</span>: &quot;1.0.0&quot;; <span style='color:
blue'>Flags</span>: createvalueifdoesntexist</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Флаг</span><span style=font-size:11.0pt> <b><span lang=EN-US>createvalueifdoesntexist </span></b></span><span style=font-size:11.0pt>не</span><span style=font-size:11.0pt> </span><span style=font-size:11.0pt>действует</span><span lang=EN-US style='font-size:
11.0pt'>, </span><span style=font-size:11.0pt>если</span><span style=font-size:11.0pt> </span><span style=font-size:11.0pt>задан</span><span style=font-size:11.0pt> </span><span style=font-size:11.0pt>флаг</span><span style=font-size:11.0pt> <b><span lang=EN-US>deletevalue</span></b><span lang=EN-US>.</span></span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal align=center style=text-align:center><b><span style=font-size:16.0pt>Секции [Languages] и [LangOptions]</span></b></p><p class=MsoNormal align=center style=text-align:center><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Для поддержки многоязыковых установок в </span><span lang=EN-US style='font-size:
11.0pt'>Inno</span><span lang=EN-US style=font-size:11.0pt> </span><span lang=EN-US style=font-size:11.0pt>Setup</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>существует секция <b>[Languages]</b>. В ней обязательно указывается идентификатор языка (параметр </span><span lang=EN-US style=font-size:11.0pt;color:blue>Name</span><span style=font-size:11.0pt>) и путь к файлу, из которого инсталлятору следует считывать стандартные сообщения (параметр </span><span lang=EN-US style=font-size:11.0pt;color:blue>MessagesFile</span><span style='font-size:
11.0pt'>).</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Секция <b>[LangOptions]</b> служит для задания дополнительных языковых опций, таких как стиль и размер шрифта.</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>LanguageName</span></b><span style=font-size:11.0pt> – имя языка, которое будет отображено в диалоге <i>Выбор языка</i>. Во избежание неприятных последствий для имени русского языка лучше использовать строку символов юникод в шестнадцатеричном виде: </span><span lang=EN-US style=font-size:11.0pt>LanguageName</span><span style='font-size:
11.0pt'>=&lt;0420&gt;&lt;0443&gt;&lt;0441&gt;&lt;0441&gt;&lt;043</span><span lang=EN-US style=font-size:11.0pt>A</span><span style=font-size:11.0pt>&gt;&lt;0438&gt;&lt;0439&gt;.</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>LanguageID</span></b><span style=font-size:11.0pt> – цифровой идентификатор языка. Он используется для автоопределения большинства языков, используемых по умолчанию. Всегда должен начинаться со знака &quot;$&quot;, если идентификатор шестнадцатеричный.</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>LanguageCodePage</span></b><span style=font-size:11.0pt> – кодовая страница для языка. Если этому параметру присвоить значение 0, язык всегда будет присутствовать в списке, вне зависимости от того, какая кодовая страница используется в системе.</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>DialogFontName</span></b><span style=font-size:11.0pt> и <b>DialogFontSize</b> – стиль и размер шрифта в диалогах.</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>WelcomeFontName</span></b><span style=font-size:11.0pt> и <b>WelcomeFontSize</b> – стиль и размер шрифта для страниц <i>Приветствие </i>и <i>Установка завершена</i>.</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>TitleFontName</span></b><span style=font-size:11.0pt> и <b>TitleFontSize</b> – стиль и размер шрифта для названия приложения в фоновом окне инсталлятора (если <span style=color:blue>WindowVisible</span>=yes).</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>CopyrightFontName</span></b><span style=font-size:11.0pt> и <b>CopyrightFontSize</b> – стиль и размер шрифта для значения директивы <span style=color:blue>AppCopyright</span> (если <span style=color:blue>WindowVisible</span>=yes).</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Если перед параметром секции <b>[LangOptions]</b> не указан идентификатор языка, инсталлятор применит их ко всем языкам, заданным в секции <b>[Languages] </b>(кроме параметров <b>LanguageName</b> и <b>LanguageID</b>). Для того, чтобы изменения затронули только конкретный язык, перед параметром следует указать префикс (идентификатор языка и точку):</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>rus</span><span style=font-size:11.0pt>.</span><span lang=EN-US style=font-size:11.0pt>TitleFontSize</span><span style='font-size:
11.0pt'>=29</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal align=center style=text-align:center;text-indent:27.0pt><b>Как перевести интерфейс инсталлятора на другой язык?</b></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>Inno</span><span lang=EN-US style=font-size:11.0pt> </span><span lang=EN-US style=font-size:11.0pt>Setup</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>поддерживает несколько языков установки. Файлы этих языков находятся в директории </span><span lang=EN-US style=font-size:11.0pt>Inno</span><span lang=EN-US style=font-size:11.0pt> </span><span lang=EN-US style=font-size:11.0pt>Setup</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>в папке <b>Languages</b> и имеют расширение .</span><span lang=EN-US style=font-size:11.0pt>isl</span><span style=font-size:11.0pt> (</span><span lang=EN-US style=font-size:11.0pt>inno</span><span lang=EN-US style=font-size:11.0pt> </span><span lang=EN-US style=font-size:11.0pt>setup</span><span lang=EN-US style=font-size:11.0pt> </span><span lang=EN-US style='font-size:
11.0pt'>language</span><span style=font-size:11.0pt>). Если вы хотите, чтобы ваш инсталлятор поддерживал язык, не включенный в доступные языки </span><span lang=EN-US style=font-size:11.0pt>Inno</span><span lang=EN-US style=font-size:11.0pt> </span><span lang=EN-US style=font-size:11.0pt>Setup</span><span style=font-size:11.0pt>, скопируйте файл Default.isl из папки программы и переименуйте его. Не следует работать прямо с файлом Default.isl, т.к. при удалении программы </span><span lang=EN-US style=font-size:11.0pt>Inno</span><span lang=EN-US style=font-size:11.0pt> </span><span lang=EN-US style='font-size:
11.0pt'>Setup</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>он удалится вместе с остальными ее компонентами, и ваш труд будет утерян. Затем откройте этот файл с помощью Блокнота и переведите значения используемых </span><span lang=EN-US style=font-size:11.0pt>Inno</span><span lang=EN-US style=font-size:11.0pt> </span><span lang=EN-US style='font-size:
11.0pt'>Setup</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>стандартных сообщений на нужный вам язык.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal align=center style=text-align:center;text-indent:27.0pt><b>Многоязыковая установка</b></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>Задача:</span></b><span style=font-size:11.0pt> инсталлятор должен поддерживать интерфейс установки на русском и немецком языке, отображать информацию перед установкой и после установки (на странице Мастера) и файл лицензии на выбранном пользователем языке.</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>Решение:</span></b><span style=font-size:11.0pt></span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>[</span></b><b><span lang=EN-US style=font-size:11.0pt>Setup</span></b><b><span style='font-size:
11.0pt'>]</span></b></p><p class=MsoNormal style=text-indent:27.0pt><b>…………………………</b></p><p class=MsoNormal style=text-indent:27.0pt><span style='font-size:11.0pt;
color:green'>;При наличии более, чем одного языка в секции <b>[</b></span><b><span lang=EN-US style=font-size:11.0pt;color:green>Languages</span></b><b><span style=font-size:11.0pt;color:green>] </span></b><span style='font-size:11.0pt;
color:green'>в начале установки будет отображен диалог <i>Выбор языка</i></span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>ShowLanguageDialog</span><span style=font-size:11.0pt>=</span><span lang=EN-US style=font-size:11.0pt>yes</span></p><p class=MsoNormal style=text-indent:27.0pt><span style='font-size:11.0pt;
color:green'>;Если </span><span lang=EN-US style=font-size:11.0pt;color:green>LanguageDetectionMethod</span><span style=font-size:11.0pt;color:green>=</span><span lang=EN-US style='font-size:
11.0pt;color:green'>none</span><span style=font-size:11.0pt;color:green>, инсталятор будет использовать первый язык, указанный в секции <b>[Languages]</b>, как язык по умолчанию</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>LanguageDetectionMethod</span><span style=font-size:11.0pt>=</span><span lang=EN-US style=font-size:11.0pt>none</span></p><p class=MsoNormal style=text-indent:27.0pt><b>…………………………</b></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>[</span></b><b><span lang=EN-US style=font-size:11.0pt>Languages</span></b><b><span style=font-size:11.0pt>]</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span style='font-size:11.0pt;
color:green'>;Указываем идентификатор языка и пути к файлам, из которых инсталлятору следует считывать стандартные сообщения, информацию до и после установки и лицензионное соглашение</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Name</span><span lang=EN-US style=font-size:11.0pt>: &quot;rus&quot;; <span style=color:blue>MessagesFile</span>: &quot;C:\Russian.isl&quot;;<span style=color:blue> InfoBeforeFile</span>: &quot;C:\IBFRus.txt&quot;; <span style=color:blue>InfoAfterFile</span>: &quot;C:\IAFRus.txt&quot;; <span style=color:blue>LicenseFile</span>: &quot;C:\LicFRus.txt&quot;</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Name</span><span lang=EN-US style=font-size:11.0pt>: &quot;ger&quot;; <span style=color:blue>MessagesFile</span>: &quot;C:\German.isl&quot;;<span style=color:blue> InfoBeforeFile</span>: &quot;C:\IBFGer.txt&quot;;<span style=color:blue> InfoAfterFile</span>: &quot;C:\IAFGer.txt&quot;; <span style=color:blue>LicenseFile</span>: &quot;C:\LicFGer.txt&quot;</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span lang=EN-US style=font-size:11.0pt>[LangOptions]</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:green>;</span><span style='font-size:11.0pt;
color:green'>Параметры</span><span style=font-size:11.0pt;color:green> </span><span style=font-size:11.0pt;color:green>для</span><span style='font-size:11.0pt;
color:green'> </span><span style=font-size:11.0pt;color:green>русского</span><span style=font-size:11.0pt;color:green> </span><span style='font-size:11.0pt;
color:green'>языка</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>rus.LanguageName=&lt;0420&gt;&lt;0443&gt;&lt;0441&gt;&lt;0441&gt;&lt;043A&gt;&lt;0438&gt;&lt;0439&gt;</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>rus.LanguageID=$0419</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>rus.LanguageCodePage=1251</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>rus.DialogFontName= MS Shell Dlg</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>rus.DialogFontSize=8</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>rus.WelcomeFontName=Verdana</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>rus.WelcomeFontSize=12</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>rus.TitleFontName=Arial</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>rus.TitleFontSize=29</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>rus.CopyrightFontName=Arial</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>rus.CopyrightFontSize=8</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:green>;</span><span style='font-size:11.0pt;
color:green'>Параметры</span><span style=font-size:11.0pt;color:green> </span><span style=font-size:11.0pt;color:green>для</span><span style='font-size:11.0pt;
color:green'> </span><span style=font-size:11.0pt;color:green>немецкого</span><span style=font-size:11.0pt;color:green> </span><span style='font-size:11.0pt;
color:green'>языка</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>ger.LanguageName=Deutsch</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>ger.LanguageID=$0407</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>ger.LanguageCodePage=1251</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>ger.DialogFontName= MS Shell Dlg</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>ger.DialogFontSize=8</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>ger.WelcomeFontName=Verdana</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>ger.WelcomeFontSize=12</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>ger.TitleFontName=Arial</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>ger.TitleFontSize=29</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>ger.CopyrightFontName=Arial</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>ger.CopyrightFontSize=8</span></p><p class=MsoNormal align=center style=text-align:center;text-indent:27.0pt><b><span lang=EN-US style=font-size:11.0pt>&nbsp;</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Секцию <b>[</b></span><b><span lang=EN-US style=font-size:11.0pt>LangOptions</span></b><b><span style=font-size:11.0pt>]</span></b><span style=font-size:11.0pt> лучше указывать, даже если в ней используются значения по умолчанию.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>После того, как пользователь выберет язык установки в диалоге <i>Выбор языка</i>, его имя присвоится константе <b>{language}</b>.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal align=center style=text-align:center><b><span style=font-size:16.0pt>Секция [Messages]</span></b></p><p class=MsoNormal align=center style=text-align:center;text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Секция <b>[Messages]</b> отвечает за стандартные сообщения, которые встречаются в ходе установки вашей программы. Полный их список можно найти, открыв с помощью Блокнота любой из файлов языка установки для </span><span lang=EN-US style=font-size:11.0pt>Inno</span><span lang=EN-US style=font-size:11.0pt> </span><span lang=EN-US style=font-size:11.0pt>Setup</span><span style=font-size:11.0pt> (они находятся в папке </span><span lang=EN-US style=font-size:11.0pt>Languages</span><span lang=EN-US style=font-size:11.0pt> </span><span style=font-size:11.0pt>в директории </span><span lang=EN-US style=font-size:11.0pt>Inno</span><span lang=EN-US style=font-size:11.0pt> </span><span lang=EN-US style='font-size:
11.0pt'>Setup</span><span style=font-size:11.0pt>). Каждое сообщение имеет уникальное имя. Если вы хотите изменить стандартное значение сообщения для любого из языков, присвойте сообщению новое значение в секции <b>[Messages]</b>.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Знак %</span><span lang=EN-US style=font-size:11.0pt>n</span><span style=font-size:11.0pt> означает перевод каретки. Также в сообщения можно вставлять значения некоторых директив: [</span><span lang=EN-US style=font-size:11.0pt>name</span><span style=font-size:11.0pt>] – значение </span><span lang=EN-US style=font-size:11.0pt;color:blue>AppName</span><span style=font-size:11.0pt>, [</span><span lang=EN-US style=font-size:11.0pt>name</span><span style=font-size:11.0pt>/</span><span lang=EN-US style=font-size:11.0pt>ver</span><span style=font-size:11.0pt>] – значение </span><span lang=EN-US style='font-size:
11.0pt;color:blue'>AppVerName</span><span style=font-size:11.0pt>.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal align=center style=text-align:center;text-indent:27.0pt><b>Изменение стандартных сообщений</b></p><p class=MsoNormal align=center style=text-align:center;text-indent:27.0pt><b>&nbsp;</b></p><p class=MsoBodyTextIndent2><b>Задача:</b> изменить сообщения на странице <i>Приветствие</i>.</p><p class=MsoBodyTextIndent2><b>Решение:</b></p><p class=MsoBodyTextIndent2>Стандартные сообщения страницы приветствия Мастера описываются параметрами WelcomeLabel1 и WelcomeLabel2.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Setup]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AppName</span><span lang=EN-US>=Proga</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AppVerName</span><span lang=EN-US>=Proga 1.0</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>DefaultDirName</span><span lang=EN-US>={pf}\Proga</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>DefaultGroupName</span><span lang=EN-US>=Proga</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AllowNoIcons</span><span lang=EN-US>=yes</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>LicenseFile</span><span lang=EN-US>=C:\LicFRus.txt</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Compression</span><span lang=EN-US>=lzma</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Messages]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>WelcomeLabel1</span><span lang=EN-US>=</span>Запущен мастер установки<span lang=EN-US> [name]</span></p><p class=MsoBodyTextIndent2><span style=color:blue>WelcomeLabel2</span>=Сейчас на ваш компьютер будет установлена программа [name/ver].%n%nУбедительная просьба не курить и пристегнуть ремни.</p><p class=MsoNormal style=text-indent:27.0pt><b>…………………………</b></p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>Если ваш инсталлятор поддерживает многоязыковую установку, и вы хотите, чтобы стандартное сообщение поменялось только для одного из языков, перед именем параметра следует указать идентификатор языка:</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b>…………………………</b></p><p class=MsoBodyTextIndent2><b>[</b><b><span lang=EN-US>Messages</span></b><b>]</b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>rus</span><span style=color:blue>.</span><span lang=EN-US style=color:blue>WelcomeLabel</span><span style=color:blue>1</span>=Запущен мастер установки [<span lang=EN-US>name</span>]</p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>rus</span><span style=color:blue>.WelcomeLabel2</span>=Сейчас на ваш компьютер будет установлена программа [name/ver].%n%nУбедительная просьба не курить и пристегнуть ремни.</p><p class=MsoBodyTextIndent2><b>…………………………</b></p><p class=MsoBodyTextIndent2><b>&nbsp;</b></p><p class=MsoBodyTextIndent2>Если идентификатор языка перед именем стандартного сообщения не указан, значение поменяется для всех языков установки.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>Специальный идентификатор секции [</span></b><b><span lang=EN-US style=font-size:12.0pt>Messages</span></b><b><span style=font-size:12.0pt>]</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>&nbsp;</span></b></p><p class=MsoBodyTextIndent2>Для секции <b>[</b><b><span lang=EN-US>Messages</span></b><b>]</b> существует специальный идентификатор <span style=color:blue>BeveledLabel</span>, с помощью которого можно задать текст, который будет отображаться в левом нижнем углу инсталлятора и деинсталлятора.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span lang=EN-US>…………………………</span></b></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Messages]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>BeveledLabel</span><span lang=EN-US>=BeveledLabel=%n</span>Установка<span lang=EN-US> Proga 1.0</span></p><p class=MsoBodyTextIndent2><b>…………………………</b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><span style=font-size:12.0pt>&nbsp;</span></p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:16.0pt>Секция [</span></b><b><span lang=EN-US style=font-size:16.0pt>CustomMessages</span></b><b><span style='font-size:
16.0pt'>]</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center>&nbsp;</p><p class=MsoBodyTextIndent2>В секции <b>[</b><b><span lang=EN-US>CustomMessages</span></b><b>]</b> можно задать значение для констант {<span lang=EN-US>cm</span>:…}. Секция <b>[</b><b><span lang=EN-US>CustomMessages</span></b><b>]</b> отличается от секции <b>[</b><b><span lang=EN-US>Messages</span></b><b>] </b>тем, что работает с любыми заданными вами сообщениями, а не со стандартными, описанными в файле Default.isl и других файлах языков установки.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b>Задача: </b>изменить стандартное сообщение UninstallProgram.</p><p class=MsoBodyTextIndent2><b>Решение:</b></p><p class=MsoBodyTextIndent2>Стандартное сообщение UninstallProgram для русского языка имеет значение «Деинсталляция». Таким образом можно изменить его на «Удалить»:</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b>[</b><b><span lang=EN-US>Setup</span></b><b>]</b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AppName</span>=<span lang=EN-US>Proga</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AppVerName</span>=<span lang=EN-US>Proga</span> 1.0</p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>DefaultDirName</span><span lang=EN-US>={pf}\Proga</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>DefaultGroupName</span><span lang=EN-US>=Proga</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AllowNoIcons</span><span lang=EN-US>=yes</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Compression</span><span lang=EN-US>=lzma</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[CustomMessages]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>UninstallProgram</span><span lang=EN-US>=</span>Удалить<span lang=EN-US> %1</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Files]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: &quot;C:\MATRIX.EXE&quot;; <span style=color:blue>DestDir</span>: &quot;{app}&quot;; <span style=color:blue>Flags</span>: ignoreversion</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: &quot;C:\ReadMe.txt&quot;; <span style=color:blue>DestDir</span>: &quot;{app}/Data&quot;; <span style=color:blue>Flags</span>: ignoreversion</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Icons]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span><span lang=EN-US>: &quot;{group}\Proga&quot;; <span style=color:blue>Filename</span>: &quot;{app}\MATRIX.EXE&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span><span lang=EN-US>: &quot;{group}\{cm:UninstallProgram,Proga}&quot;; <span style=color:blue>Filename</span>: &quot;{uninstallexe}&quot;</span></p><p class=MsoBodyTextIndent2><b>…………………………</b></p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>&nbsp;</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>&nbsp;</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>&nbsp;</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>&nbsp;</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>&nbsp;</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>&nbsp;</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>&nbsp;</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>&nbsp;</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>&nbsp;</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:16.0pt>Полезные задачи</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>&nbsp;</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>Сделать обновление на установленную программу</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>&nbsp;</span></b></p><p class=MsoBodyTextIndent2>Предположим, что нам требуется не установить программу «с нуля», а сделать обновление (апдейт) на уже установленную программу. Для этого используется директива <span lang=EN-US>AppId</span>. Если в скрипте она не указана, компилятор присваивает ей значение директивы <span lang=EN-US>AppName</span>. В данной ситуации значение директивы <span lang=EN-US>AppId</span> в программе и обновлении должно быть одинаковым. Рассмотрим конкретную задачу.</p><p class=MsoBodyTextIndent2><b>Задача 1</b>: на компьютере пользователя УЖЕ УСТАНОВЛЕНА программа <span lang=EN-US>Program</span>, в которую входят компоненты: <span lang=EN-US>prog</span>1, <span lang=EN-US>prog</span>2, <span lang=EN-US>prog</span>3. В обновлении нужно добавить компонент <span lang=EN-US>prog</span>4 и файл <span lang=EN-US>readme</span> для него.</p><p class=MsoBodyTextIndent2><b>Решение</b>:</p><p class=MsoBodyTextIndent2>Пусть обновление для программы <span lang=EN-US>Program</span> называется <span lang=EN-US>ProgramUpd</span>. Пишем простой скрипт для установки нашего апдейта. Не забудьте задать директиве <span lang=EN-US>AppId</span> то же значение, что и в скрипте самой программы. Он будет выглядеть примерно так:</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>[</span></b><b><span lang=EN-US style=font-size:11.0pt>Setup</span></b><b><span style='font-size:
11.0pt'>]</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>AppName</span><span style=font-size:11.0pt>=</span><span lang=EN-US style=font-size:11.0pt>ProgramUpd</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>AppVerName</span><span style='font-size:
11.0pt'>= </span><span lang=EN-US style=font-size:11.0pt>ProgramUpd</span><span lang=EN-US style=font-size:11.0pt> </span><span lang=EN-US style='font-size:
11.0pt'>ver</span><span style=font-size:11.0pt>.1.0</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>DefaultDirName</span><span lang=EN-US style=font-size:11.0pt>={pf}\ ProgramUpd 1.0</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>DefaultGroupName</span><span lang=EN-US style=font-size:11.0pt>= ProgramUpd 1.0</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>OutputBaseFilename</span><span lang=EN-US style=font-size:11.0pt>= ProgramUpd Setup 1.0</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>OutputDir</span><span lang=EN-US style=font-size:11.0pt>=c:\ProbaUpd\</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>SourceDir</span><span lang=EN-US style=font-size:11.0pt>=C:\</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>AllowNoIcons</span><span lang=EN-US style=font-size:11.0pt>=yes</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>AlwaysShowDirOnReadyPage</span><span lang=EN-US style=font-size:11.0pt>=yes</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>AppPublisher</span><span lang=EN-US style=font-size:11.0pt>=My Company, Inc.</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>AppPublisherURL</span><span lang=EN-US style=font-size:11.0pt>=http://www.mycompany.com/</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>AppVersion</span><span lang=EN-US style=font-size:11.0pt>=1.0</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>CreateUninstallRegKey</span><span lang=EN-US style=font-size:11.0pt>=yes</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>DirExistsWarning</span><span lang=EN-US style=font-size:11.0pt>=auto</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Files]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: &quot;ProgramUpd.exe&quot;; <span style=color:blue>DestDir</span>: &quot;{app}&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: &quot;ReadmeUpd.txt&quot;; <span style=color:blue>DestDir</span>: &quot;{app}&quot;</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Tasks]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span><span lang=EN-US>: quicklaunchicon; <span style=color:blue>Description</span>: &quot;</span>Поместить ярлык на рабочий стол<span lang=EN-US>&quot;; <span style=color:blue>GroupDescription</span>: &quot;</span>Всякие вкусности<span lang=EN-US>:&quot;; <span style=color:blue>Flags</span>: unchecked</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US> [Icons]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span><span lang=EN-US>: &quot;{userdesktop}\ProgramUpd&quot;;  <span style=color:blue>IconFilename</span>:&quot;{app}\Ikonka.ico&quot;; <span style=color:blue>Filename</span>: &quot;{app}\ProgramUpd.exe&quot;; <span style=color:blue>Tasks</span>: quicklaunchicon</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span><span lang=EN-US>: &quot;{group}\ProgramUpd&quot;;  <span style=color:blue>IconFilename</span>:&quot;{app}\Ikonka.ico&quot;; <span style=color:blue>Filename</span>: &quot;{app}\ProgramUpd.exe&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span><span lang=EN-US>: &quot;{group}\</span>Удалить<span lang=EN-US> ProgramUpd&quot;; <span style=color:blue>FileName</span>: &quot;{app}\unins001&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span><span lang=EN-US>: &quot;{group}\ReadmeUpd&quot;; <span style=color:blue>Filename</span>: &quot;{app}\ReadmeUpd.txt&quot;</span></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span lang=EN-US style=font-size:12.0pt>&nbsp;</span></b></p><p class=MsoBodyTextIndent2>В этом случае мы просто добавили новый файлик в папку программы. Теперь усложним задачу.</p><p class=MsoBodyTextIndent2><b>&nbsp;</b></p><p class=MsoBodyTextIndent2><b>Задача 2</b>: та же, только файл <span lang=EN-US>prog</span>1 программы <span lang=EN-US>Program</span> нужно ЗАМЕНИТЬ файлом <span lang=EN-US>prog</span>.</p><p class=MsoBodyTextIndent2><b>Решение</b>:</p><p class=MsoBodyTextIndent2>В этом случае следует добавить секцию [<span lang=EN-US>InstallDelete</span>] и в ней указать имя и путь к файлу, который перед установкой обновления следует удалить. Скрипт будет иметь такой вид:</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>[</span></b><b><span lang=EN-US style=font-size:11.0pt>Setup</span></b><b><span style='font-size:
11.0pt'>]</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>AppName</span><span style=font-size:11.0pt>=</span><span lang=EN-US style=font-size:11.0pt>ProgramUpd</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>AppVerName</span><span style='font-size:
11.0pt'>= </span><span lang=EN-US style=font-size:11.0pt>ProgramUpd</span><span lang=EN-US style=font-size:11.0pt> </span><span lang=EN-US style='font-size:
11.0pt'>ver</span><span style=font-size:11.0pt>.1.0</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>DefaultDirName</span><span lang=EN-US style=font-size:11.0pt>={pf}\ ProgramUpd 1.0</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>DefaultGroupName</span><span lang=EN-US style=font-size:11.0pt>= ProgramUpd 1.0</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>OutputBaseFilename</span><span lang=EN-US style=font-size:11.0pt>= ProgramUpd Setup 1.0</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>OutputDir</span><span lang=EN-US style=font-size:11.0pt>=c:\ProbaUpd\</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>SourceDir</span><span lang=EN-US style=font-size:11.0pt>=C:\</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>AllowNoIcons</span><span lang=EN-US style=font-size:11.0pt>=yes</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>AlwaysShowDirOnReadyPage</span><span lang=EN-US style=font-size:11.0pt>=yes</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>AppPublisher</span><span lang=EN-US style=font-size:11.0pt>=My Company, Inc.</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>AppPublisherURL</span><span lang=EN-US style=font-size:11.0pt>=http://www.mycompany.com/</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>AppVersion</span><span lang=EN-US style=font-size:11.0pt>=1.0</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>CreateUninstallRegKey</span><span lang=EN-US style=font-size:11.0pt>=yes</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>DirExistsWarning</span><span lang=EN-US style=font-size:11.0pt>=auto</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[InstallDelete]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Type</span><span lang=EN-US>: files; <span style=color:blue>Name</span>: “{app}\Program.exe”</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Files]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: &quot;ProgramUpd.exe&quot;; <span style=color:blue>DestDir</span>: &quot;{app}&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: &quot;ReadmeUpd.txt&quot;; <span style=color:blue>DestDir</span>: &quot;{app}&quot;</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Tasks]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span><span lang=EN-US>: quicklaunchicon; <span style=color:blue>Description</span>: &quot;</span>Поместить ярлык на рабочий стол<span lang=EN-US>&quot;; <span style=color:blue>GroupDescription</span>: &quot;</span>Всякие вкусности<span lang=EN-US>:&quot;; <span style=color:blue>Flags</span>: unchecked</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US> [Icons]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span><span lang=EN-US>: &quot;{userdesktop}\ProgramUpd&quot;;  <span style=color:blue>IconFilename</span>:&quot;{app}\Ikonka.ico&quot;; <span style=color:blue>Filename</span>: &quot;{app}\ProgramUpd.exe&quot;; <span style=color:blue>Tasks</span>: quicklaunchicon</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span><span lang=EN-US>: &quot;{group}\ProgramUpd&quot;;  <span style=color:blue>IconFilename</span>:&quot;{app}\Ikonka.ico&quot;; <span style=color:blue>Filename</span>: &quot;{app}\ProgramUpd.exe&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span><span lang=EN-US>: &quot;{group}\</span>Удалить<span lang=EN-US> ProgramUpd&quot;; <span style=color:blue>FileName</span>: &quot;{app}\unins001&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span><span lang=EN-US>: &quot;{group}\ReadmeUpd&quot;; <span style=color:blue>Filename</span>: &quot;{app}\ReadmeUpd.txt&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2>Усложним задачу еще больше.</p><p class=MsoBodyTextIndent2><b>Задача 3</b>: пусть теперь нам надо перед установкой обновления проверить, установлена ли на компьютере пользователя исходная программа, и если она не установлена, то прекратить установку обновления и выдать сообщение: «Перед установкой апдейта <span lang=EN-US>ProgramUpd</span> Вам следует установить программу <span lang=EN-US>Program</span>!» Если же исходная программа установлена, обновление добавит в ее папку (которую укажет пользователь) один .<span lang=EN-US>exe</span>-файл.</p><p class=MsoBodyTextIndent2><b>Решение</b>:</p><p class=MsoBodyTextIndent2>Имеем две программы: исходную <span lang=EN-US>Proga</span><span lang=EN-US> </span>и обновление для нее <span lang=EN-US>ProgaUpd</span>. Программа <span lang=EN-US>Proga</span><span lang=EN-US> </span>состоит из одного файла <span lang=EN-US>MATRIX</span>.<span lang=EN-US>EXE</span>. Обновление <span lang=EN-US>ProgaUpd</span>, если найдет в реестре правильный ключ,  внесет в папку установленной программы еще один файл <span lang=EN-US>MATRIXUP</span>.<span lang=EN-US>EXE</span>. При удалении программы после установки обновления удалятся оба файла: <span lang=EN-US>MATRIX</span>.<span lang=EN-US>EXE</span><span lang=EN-US> </span>и <span lang=EN-US>MATRIXUP</span>.<span lang=EN-US>EXE</span>.</p><p class=MsoBodyTextIndent2>Методов решения этой задачи можно найти множество. Я предлагаю следующий: добавить при установке программы ключ в реестр, а обновление пусть проверяет наличие этого ключа.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>Пример скрипта для установки основной программы <span lang=EN-US>Proga</span><span lang=EN-US> </span>будет следующий:</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Setup]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AppName</span><span lang=EN-US>=Proga</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AppVerName</span><span lang=EN-US>=Proga 1.0</span></p><p class=MsoBodyTextIndent2><span style=color:green>;Как уже говорилось, для обеих программ: основной и обновления, директива </span><span lang=EN-US style=color:green>AppId</span><span style=color:green> должна быть одинаковой</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AppId</span><span lang=EN-US>=Proga</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>DefaultDirName</span><span lang=EN-US>={pf}\Proga</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>DefaultGroupName</span><span lang=EN-US>=Proga</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Compression</span>=<span lang=EN-US>lzma</span></p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><span style=color:green>;В данном случае в реестр можно ввести пустой параметр. Также рекомендуется удалять параметр из реестра при удалении программы – за это отвечает флаг  </span><b><span lang=EN-US style=color:green>uninsdeletekey</span></b><span style=color:green>. Флаг </span><b><span lang=EN-US style=color:green>createvalueifdoesntexist</span></b><span style=color:green> означает, что параметр будет создан только если он не существует.</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Registry]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Root</span><span lang=EN-US>: HKCU; <span style=color:blue>Subkey</span>: &quot;Software\Matrix&quot;; <span style=color:blue>Flags</span>: createvalueifdoesntexist uninsdeletekey</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Files]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: &quot;C:\ MATRIX.EXE &quot;; <span style=color:blue>DestDir</span>: &quot;{app}&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2>Пример скрипта обновления для программы <span lang=EN-US>Proga</span>, которое будет называться <span lang=EN-US>ProgaUpd</span>:</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Setup]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AppName</span><span lang=EN-US>=ProgaUpd</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AppVerName</span><span lang=EN-US>=Proga 1.1</span></p><p class=MsoBodyTextIndent2><span style=color:green>;Как уже говорилось, для обеих программ: основной и обновления, директива </span><span lang=EN-US style=color:green>AppId</span><span style=color:green> должна быть одинаковой</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AppId</span><span lang=EN-US>=Proga</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>DefaultDirName</span><span lang=EN-US>={pf}\Proga</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>DefaultGroupName</span><span lang=EN-US>=Proga</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Compression</span><span lang=EN-US>=lzma</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Files]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: &quot;C:\ MATRIXUP.EXE &quot;; <span style=color:blue>DestDir</span>: &quot;{app}&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Code]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue> function</span><span lang=EN-US> <b>InitializeSetup</b>(): Boolean;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>begin</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue> if</span><span lang=EN-US> RegKeyExists(HKCU, 'Software\Matrix') <span style=color:blue>then</span></span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>  begin</span></p><p class=MsoBodyTextIndent2>   <span lang=EN-US>Result</span> := <span lang=EN-US>MsgBox</span>('Поиск установленных компонентов:' #13#13 'Компоненты найдены. <span lang=EN-US>Продолжить установку?', mbConfirmation, MB_YESNO) = idYes;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>    <span style=color:blue>if</span> Result = False <span style=color:blue>then</span></span></p><p class=MsoBodyTextIndent2><span lang=EN-US>    MsgBox</span>('Поиск установленных компонентов:' #13#13 'Компоненты не найдены.Установка невозможна.', <span lang=EN-US>mbInformation</span>, <span lang=EN-US>MB</span>_<span lang=EN-US>OK</span>);</p><p class=MsoBodyTextIndent2><span style=color:blue>  </span><span lang=EN-US style=color:blue>end</span></p><p class=MsoBodyTextIndent2><span style=color:blue> </span><span lang=EN-US style=color:blue>else</span><span lang=EN-US> </span><span lang=EN-US>MsgBox</span>('Поиск установленных компонентов:' #13#13 'Обновление не может быть установлено! Сначала следует установить программу! ', <span lang=EN-US>mbConfirmation</span>, <span lang=EN-US>MB</span>_<span lang=EN-US>OK</span>);</p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>end</span>;</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>Разберем подробнее секцию <b>[</b><b><span lang=EN-US>Code</span>]</b>. Функция <b><span lang=EN-US>InitializeSetup</span>()</b>, как известно, при значении <span lang=EN-US>False</span><span lang=EN-US> </span>прерывает установку программы. Функцией <b><span lang=EN-US>RegKeyExists</span></b>(<span lang=EN-US>HKCU</span>, '<span lang=EN-US>Software</span>\<span lang=EN-US>Matrix</span>') определяем существование ключа в реестре. Если ключ существует, то у пользователя будет спрошено, желает ли он продолжить установку. Если же ключ в реестре не найден, инсталлятор выдаст сообщение, что обновление  не может быть установлено без самой программы, и установка прервется.</p><p class=MsoBodyTextIndent2>Переменная <span lang=EN-US>Result</span> – это результат функции, который будет использоваться далее в скрипте.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b>Задача 4</b>: обновление устанавливается только поверх заданной версии приложения, в иных случаях выдает ошибку.</p><p class=MsoBodyTextIndent2><b>Решение:</b></p><p class=MsoBodyTextIndent2>Имеем две программы: исходную <span lang=EN-US>Proga</span><span lang=EN-US> </span>и обновление для нее <span lang=EN-US>ProgaUpd</span>. Программа <span lang=EN-US>Proga</span><span lang=EN-US> </span>состоит из одного файла <span lang=EN-US>MATRIX</span>.<span lang=EN-US>EXE</span>. Обновление <span lang=EN-US>ProgaUpd</span>, если найдет в реестре правильный ключ, внесет в папку установленной программы еще один файл <span lang=EN-US>MATRIXUP</span>.<span lang=EN-US>EXE</span>. При удалении программы после установки обновления удалятся оба файла: <span lang=EN-US>MATRIX</span>.<span lang=EN-US>EXE</span><span lang=EN-US> </span>и <span lang=EN-US>MATRIXUP</span>.<span lang=EN-US>EXE</span>.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>Скрипт для основной программы:</p><p class=MsoBodyTextIndent2><b>&nbsp;</b></p><p class=MsoBodyTextIndent2><b>[</b><b><span lang=EN-US>Setup</span>]</b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AppName</span>=<span lang=EN-US>Proga</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AppVerName</span>=<span lang=EN-US>Proga</span> 1.0</p><p class=MsoBodyTextIndent2><span style=color:green>;Для обеих программ: основной и обновления, директива </span><span lang=EN-US style=color:green>AppId</span><span style=color:green> должна быть одинаковой</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AppId</span><span lang=EN-US>=Proga</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>DefaultDirName</span><span lang=EN-US>={pf}\Proga</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>DefaultGroupName</span><span lang=EN-US>=Proga</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Compression</span>=<span lang=EN-US>lzma</span></p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b>[</b><b><span lang=EN-US>Registry</span>]</b></p><p class=MsoBodyTextIndent2><span style=color:green>;В реестр вносится строковый параметр с именем </span><span lang=EN-US style=color:green>Version</span><span style=color:green> и значением 1.0</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Root</span><span lang=EN-US>: HKCU; <span style=color:blue>Subkey</span>: &quot;Software\Matrix&quot;; <span style=color:blue>ValueType</span>: string; <span style=color:blue>ValueName</span>: &quot;Version&quot;; <span style=color:blue>ValueData</span>: &quot;1.0&quot;; <span style=color:blue>Flags</span>: createvalueifdoesntexist uninsdeletekey</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Files]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: &quot;C:\MATRIX.EXE&quot;; <span style=color:blue>DestDir</span>: &quot;{app}&quot;; <span style=color:blue>Flags</span>: ignoreversion</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2>Скрипт для обновления<span lang=EN-US>:</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Setup]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AppName</span><span lang=EN-US>=ProgaUpd</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AppVerName</span>=<span lang=EN-US>Proga</span> 1.1</p><p class=MsoBodyTextIndent2><span style=color:green>;Для обеих программ: основной и обновления, директива </span><span lang=EN-US style=color:green>AppId</span><span style=color:green> должна быть одинаковой</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AppId</span><span lang=EN-US>=Proga</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>DefaultDirName</span><span lang=EN-US>={pf}\Proga</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>DefaultGroupName</span><span lang=EN-US>=Proga</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Compression</span><span lang=EN-US>=lzma</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Files]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: &quot;C:\MATRIXUP.EXE&quot;; <span style=color:blue>DestDir</span>: &quot;{app}&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Code]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>function</span><span lang=EN-US> <b>InitializeSetup</b>(): Boolean;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>var</span><span lang=EN-US> ResultStr: <span style=color:blue>String</span>;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue> begin</span></p><p class=MsoBodyTextIndent2>  <span style=color:green>;Считываем значение параметра </span><span lang=EN-US style=color:green>Version</span><span style=color:green> из реестра и присваиваем его переменной </span><span lang=EN-US style=color:green>ResultStr</span></p><p class=MsoBodyTextIndent2>  <span lang=EN-US>RegQueryStringValue(HKCU, 'Software\Matrix', 'Version', ResultStr);</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>   <span style=color:green> </span></span><span style=color:green>;Если значение параметра </span><span lang=EN-US style=color:green>Version</span><span style=color:green> равно 1.0, обновление устанавливается, если не равно или не существует – установка прекращается</span></p><p class=MsoBodyTextIndent2>   <span lang=EN-US style=color:blue>if</span><span lang=EN-US> ResultStr='1.0' <span style=color:blue>then</span></span></p><p class=MsoBodyTextIndent2><span lang=EN-US>    <span style=color:blue> begin</span></span></p><p class=MsoBodyTextIndent2><span lang=EN-US>      </span>Result := MsgBox('Поиск установленных компонентов:' #13#13 'Компоненты найдены. Продолжить установку<span lang=EN-US>?', mbConfirmation, MB_YESNO) = idYes;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>       <span style=color:blue>if</span> Result = False <span style=color:blue>then</span></span></p><p class=MsoBodyTextIndent2><span lang=EN-US>         MsgBox</span>('Поиск установленных компонентов:' #13#13 'Установка прервана.', <span lang=EN-US>mbInformation</span>, <span lang=EN-US>MB</span>_<span lang=EN-US>OK</span>);</p><p class=MsoBodyTextIndent2><span style=color:blue>     end</span></p><p class=MsoBodyTextIndent2>   <span style=color:blue>else</span> MsgBox('Поиск установленных компонентов:' #13#13 'Программа не может быть установлена!', mbConfirmation, MB_OK);</p><p class=MsoBodyTextIndent2> <span style=color:blue> end</span>;</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>Проверка версии </span></b><b><span lang=EN-US style=font-size:12.0pt>Windows</span></b><b><span style=font-size:12.0pt>.</span></b></p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b>Задача 1</b>: программа <span lang=EN-US>Program</span> может быть установлена только на <span lang=EN-US>NT</span>-платформу Windows.</p><p class=MsoBodyTextIndent2><b>Решение:</b></p><p class=MsoBodyTextIndent2>В данной задаче сложность скрипта зависит только от вашей фантазии.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b>1)</b> В таком скрипте инсталлятор «молча» установит вашу программу на <span lang=EN-US>NT</span>-платформу, и просто не запустится, если система не на <span lang=EN-US>NT</span>-платформе. Сухо и строго – не думаю, что пользователю это понравится.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b>[</b><b><span lang=EN-US>Code</span>]</b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>function</span><span lang=EN-US> InitializeSetup(): Boolean;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>begin</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>Result:=UsingWinNT;</span></p><p class=MsoBodyTextIndent2><span style=color:blue>end</span>;</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b>2)</b> Такой инсталлятор пользователю понравится больше: при запуске установки не на <span lang=EN-US>NT</span>-платформе он выдаст сообщение, что установка невозможна.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Setup]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AppName</span><span lang=EN-US>=Program</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AppVerName</span><span lang=EN-US>=Program 1.0</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AppPublisher</span><span lang=EN-US>=Zuka-Buka, Inc.</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>DefaultDirName</span><span lang=EN-US>={pf}\Program</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>DefaultGroupName</span><span lang=EN-US>=Program</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AllowNoIcons</span><span lang=EN-US>=yes</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>OutputDir</span><span lang=EN-US>=&quot;C:\Install&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Compression</span><span lang=EN-US>=lzma</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Files]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: &quot;C:\MATRIX.exe&quot;; <span style=color:blue>DestDir</span>: &quot;{app}&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: &quot;C:\ReadMe.txt&quot;; <span style=color:blue>DestDir</span>: &quot;{app}\Data&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Code]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>function</span><span lang=EN-US> InitializeSetup(): Boolean;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>  <span style=color:blue>begin</span></span></p><p class=MsoBodyTextIndent2><span lang=EN-US>   <span style=color:blue>if</span> UsingWinNT=True <span style=color:blue>then</span> Result:=True</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>   <span style=color:blue>else</span></span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>    begin</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>    MsgBox('&Iuml;&eth;&icirc;&atilde;&eth;&agrave;&igrave;&igrave;&agrave; </span>Программа может быть установлена только в<span lang=EN-US> Windows NT', mbConfirmation, mb_OK);</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>    Result</span>:=<span lang=EN-US>False</span>;</p><p class=MsoBodyTextIndent2><span style=color:blue>    </span><span lang=EN-US style=color:blue>end</span>;</p><p class=MsoBodyTextIndent2><span style=color:blue>  </span><span lang=EN-US style=color:blue>end</span>;</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>Помните, что чем «дружественнее» будет ваш инсталлятор, тем лучше.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b>Задача 2</b>: программа может быть установлена только на <span lang=EN-US>Windows</span><span lang=EN-US> </span>2000 версии 5.0.2195.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>Функция <span lang=EN-US>GetWindowsVersion</span> возвращает номер версии <span lang=EN-US>Windows</span><span lang=EN-US> </span>в виде целочисленной переменной (<span lang=EN-US>integer</span>). Верхние 8 бит указывают главную версию, следующие 8 бит – подверсию, и последние 16 бит – номер <span lang=EN-US>build</span>’<span lang=EN-US>a</span>. Например, эта функция возвратит $05000893 для <span lang=EN-US>Windows</span> 2000 версии 5.0.2195.</p><p class=MsoBodyTextIndent2>Так функция вернет только главную версию <span lang=EN-US>Windows: &quot;GetWindowsVersion shr 24&quot;, </span>так <span lang=EN-US>– </span>подверсию<span lang=EN-US>: &quot;(GetWindowsVersion shr 16) and $FF&quot;, </span>так<span lang=EN-US> – </span>номер <span lang=EN-US>build’a: &quot;GetWindowsVersion and $FFFF&quot;.</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Setup]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AppName</span><span lang=EN-US>=Program</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AppVerName</span><span lang=EN-US>=Program 1.0</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AppPublisher</span><span lang=EN-US>=Zuka-Buka, Inc.</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>DefaultDirName</span><span lang=EN-US>={pf}\Program</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>DefaultGroupName</span><span lang=EN-US>=Program</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AllowNoIcons</span><span lang=EN-US>=yes</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>OutputDir</span><span lang=EN-US>=&quot;C:\Install&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Compression</span><span lang=EN-US>=lzma</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Files]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: &quot;C:\MATRIX.exe&quot;; <span style=color:blue>DestDir</span>: &quot;{app}&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: &quot;C:\ReadMe.txt&quot;; <span style=color:blue>DestDir</span>: &quot;{app}\Data&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Code]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>function</span><span lang=EN-US> InitializeSetup(): Boolean;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>  begin</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>    <span style=color:blue>if</span> GetWindowsVersion=$05000893 <span style=color:blue>then</span> Result:=True</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>  <span style=color:blue>else</span></span></p><p class=MsoBodyTextIndent2><span lang=EN-US>    <span style=color:blue>begin</span></span></p><p class=MsoBodyTextIndent2><span lang=EN-US>      MsgBox(</span>Программа может быть установлена только в <span lang=EN-US>Windows 2000 </span>версии <span lang=EN-US>5.0.2195', mbConfirmation, mb_OK);</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>      </span>Result:=False;</p><p class=MsoBodyTextIndent2>    <span style=color:blue>end</span>;</p><p class=MsoBodyTextIndent2>  <span style=color:blue>end</span>;</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2 align=center style=text-align:center><span style=font-size:12.0pt>&nbsp;</span></p><p class=MsoNormal align=center style=text-align:center;text-indent:27.0pt><b>Выбор устанавливаемых компонентов</b></p><p class=MsoNormal align=center style=text-align:center;text-indent:27.0pt><b>&nbsp;</b></p><p class=MsoNormal style=text-indent:27.0pt><b>Задача 1: </b><span style=font-size:11.0pt>имеется набор компонентов. По желанию пользователь может установить все компоненты или выбрать нужные ему из списка.</span></p><p class=MsoNormal style=text-indent:27.0pt><b>Решение:</b></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Данная задача решается при помощи трех секций: <b>[</b></span><b><span lang=EN-US style=font-size:11.0pt>Types</span></b><b><span style=font-size:11.0pt>],</span></b><span style=font-size:11.0pt> <b>[</b></span><b><span lang=EN-US style='font-size:
11.0pt'>Components</span></b><b><span style=font-size:11.0pt>] </span></b><span style=font-size:11.0pt>и <b>[</b></span><b><span lang=EN-US style='font-size:
11.0pt'>Files</span></b><b><span style=font-size:11.0pt>]</span></b><span style=font-size:11.0pt>.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>В секции <b>[</b></span><b><span lang=EN-US style=font-size:11.0pt>Types</span></b><b><span style=font-size:11.0pt>]</span></b><span style=font-size:11.0pt> перечисляются все типы установки с их описанием. В готовом инсталляторе будут отображаться только описания, поэтому их лучше делать на русском языке. Для данной задачи можно создать два типа, например <b>Полная установка </b>и <b>Выборочная установка</b>, причем не забудьте указать компилятору, какая именно из установок является выборочной флагом </span><b><span lang=EN-US style=font-size:11.0pt>iscustom</span></b><span style=font-size:11.0pt>.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>В секции <b>[</b></span><b><span lang=EN-US style=font-size:11.0pt>Components</span></b><b><span style=font-size:11.0pt>] </span></b><span style=font-size:11.0pt>перечисляются компоненты для установки с описанием и указанием типов установки, к которым они относятся.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>В секции <b>[</b></span><b><span lang=EN-US style=font-size:11.0pt>Files</span></b><b><span style=font-size:11.0pt>] </span></b><span style=font-size:11.0pt>перечисляются файлы, которые собственно и будут инсталлированы. Обязательно укажите, к какому компоненту относится каждый файл.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Многоточия в начале и конце примера означают, что вверху должна находиться секция <b>[</b></span><b><span lang=EN-US style=font-size:11.0pt>Setup</span></b><b><span style='font-size:
11.0pt'>] </span></b><span style=font-size:11.0pt>с необходимыми параметрами, а внизу могут идти другие секции (например, <b>[</b></span><b><span lang=EN-US style=font-size:11.0pt>Tasks</span></b><b><span style=font-size:11.0pt>]</span></b><span style=font-size:11.0pt> или <b>[</b></span><b><span lang=EN-US style=font-size:11.0pt>Icons</span></b><b><span style=font-size:11.0pt>]</span></b><span style=font-size:11.0pt>).</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>Пример скрипта:</span></b></p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>………………………………</span></b></p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>[Types]</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Name</span><span style=font-size:11.0pt>: &quot;</span><span lang=EN-US style=font-size:11.0pt>polnaya</span><span style=font-size:11.0pt>&quot;; </span><span lang=EN-US style='font-size:11.0pt;
color:blue'>Description</span><span style=font-size:11.0pt>: &quot;Полная установка&quot;</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Name</span><span lang=EN-US style=font-size:11.0pt>: &quot;viborochnaya&quot;; <span style=color:blue>Description</span>: &quot;</span><span style=font-size:11.0pt>Выборочная</span><span style=font-size:11.0pt> </span><span style=font-size:11.0pt>установка</span><span lang=EN-US style=font-size:11.0pt>&quot;; <span style=color:blue>Flags</span>: iscustom</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span lang=EN-US style=font-size:11.0pt>[Components]</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Name</span><span lang=EN-US style=font-size:11.0pt>: &quot;Component1&quot;; <span style=color:blue>Description</span>: &quot;</span><span style=font-size:11.0pt>Описание</span><span lang=EN-US style=font-size:11.0pt>: </span><span style=font-size:11.0pt>программа</span><span style=font-size:11.0pt> </span><span style=font-size:11.0pt>первая</span><span lang=EN-US style=font-size:11.0pt>&quot;; <span style=color:blue>Types</span>: polnaya viborochnaya</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Name</span><span lang=EN-US style=font-size:11.0pt>: &quot; Component 2&quot;; <span style=color:blue>Description</span>: &quot;</span><span style=font-size:11.0pt>Описание</span><span lang=EN-US style=font-size:11.0pt>: </span><span style=font-size:11.0pt>программа</span><span style=font-size:11.0pt> </span><span style=font-size:11.0pt>вторая</span><span lang=EN-US style=font-size:11.0pt>&quot;; <span style=color:blue>Types</span>: polnaya viborochnaya</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Name</span><span lang=EN-US style=font-size:11.0pt>: &quot; Component 3&quot;; <span style=color:blue>Description</span>: &quot;</span><span style=font-size:11.0pt>Описание</span><span lang=EN-US style=font-size:11.0pt>: </span><span style=font-size:11.0pt>программа</span><span style=font-size:11.0pt> </span><span style=font-size:11.0pt>третья</span><span lang=EN-US style=font-size:11.0pt>&quot;; <span style=color:blue>Types</span>: polnaya viborochnaya</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span lang=EN-US style=font-size:11.0pt>[Files]</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Source</span><span lang=EN-US style=font-size:11.0pt>: &quot;Program1.exe&quot;; <span style=color:blue>Components</span>: Component1; <span style=color:blue>DestDir</span>: &quot;{app}&quot;</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Source</span><span lang=EN-US style=font-size:11.0pt>: &quot; Program2.exe&quot;; <span style=color:blue>Components</span>: Component2; <span style=color:blue>DestDir</span>: &quot;{app}&quot;</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Source</span><span lang=EN-US style=font-size:11.0pt>: &quot; Program3.exe&quot;; <span style=color:blue>Components</span>: Component3; <span style=color:blue>DestDir</span>: &quot;{app}&quot;</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>………………………………</span></b></p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>&nbsp;</span></b></p><p class=MsoBodyTextIndent2><b>&nbsp;</b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>Имя папки приложения зависит от выбранного языка установки</span></b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:12.0pt>&nbsp;</span></b></p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>Задача:</span></b><span style=font-size:11.0pt> присвоить папке приложения в зависимости от выбранного языка разные имена.</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>Решение (способ 1):</span></b><span style=font-size:11.0pt></span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Имя действующего языка (в формате </span><span lang=EN-US style=font-size:11.0pt>String</span><span style=font-size:11.0pt>) возвращает функция ActiveLanguage. Зададим константу </span><span lang=EN-US style=font-size:11.0pt>MyConst</span><span style=font-size:11.0pt>, результатом которой в зависимости от значения функции ActiveLanguage присвоится значение ‘</span><span lang=EN-US style=font-size:11.0pt>Papka</span><span style=font-size:11.0pt>’ или ‘</span><span lang=EN-US style=font-size:11.0pt>Folder</span><span style=font-size:11.0pt>’.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Пусть если пользователь выберет установку на русском языке, папка приложения будет называться </span><span lang=EN-US style=font-size:11.0pt>Papka</span><span style=font-size:11.0pt>, а если на немецком, то </span><span lang=EN-US style=font-size:11.0pt>Folder</span><span style=font-size:11.0pt>.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span lang=EN-US style=font-size:11.0pt>[Setup]</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>AppName</span><span lang=EN-US style=font-size:11.0pt>=Program</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>AppVerName</span><span lang=EN-US style=font-size:11.0pt>=Program 1.0</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>AppPublisher</span><span lang=EN-US style=font-size:11.0pt>=Zuka-Buka, Inc.</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>DefaultDirName</span><span lang=EN-US style=font-size:11.0pt>={pf}\{code:MyConst}</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>DefaultGroupName</span><span lang=EN-US style=font-size:11.0pt>=Program 1.0</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>UsePreviousAppDir</span><span lang=EN-US style=font-size:11.0pt>=no</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>UsePreviousGroup</span><span lang=EN-US style=font-size:11.0pt>=no</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>ShowLanguageDialog</span><span lang=EN-US style=font-size:11.0pt>=yes</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>LanguageDetectionMethod</span><span lang=EN-US style=font-size:11.0pt>=none</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Compression</span><span lang=EN-US style=font-size:11.0pt>=lzma</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span lang=EN-US style=font-size:11.0pt>[Files]</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Source</span><span lang=EN-US style=font-size:11.0pt>: &quot;C:\MATRIX.exe&quot;; <span style=color:blue>DestDir</span>: &quot;{app}&quot;</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Source</span><span lang=EN-US style=font-size:11.0pt>: &quot;C:\ReadMe.txt&quot;; <span style=color:blue>DestDir</span>: &quot;{app}\Data&quot;</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span lang=EN-US style=font-size:11.0pt>[Languages]</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Name</span><span lang=EN-US style=font-size:11.0pt>: &quot;rus&quot;; <span style=color:blue>MessagesFile</span>: &quot;C:\Russian.isl&quot;</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>Name</span><span lang=EN-US style=font-size:11.0pt>: &quot;ger&quot;; <span style=color:blue>MessagesFile</span>: &quot;C:\German.isl&quot;</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span lang=EN-US style=font-size:11.0pt>[LangOptions]</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>rus.LanguageName=&lt;0420&gt;&lt;0443&gt;&lt;0441&gt;&lt;0441&gt;&lt;043A&gt;&lt;0438&gt;&lt;0439&gt;</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>rus.LanguageID=$0419</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>rus.LanguageCodePage=1251</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>rus.DialogFontName= MS Shell Dlg</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>rus.DialogFontSize=8</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>rus.WelcomeFontName=Verdana</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>rus.WelcomeFontSize=12</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>rus.TitleFontName=Arial</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>rus.TitleFontSize=29</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>rus.CopyrightFontName=Arial</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>rus.CopyrightFontSize=8</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>ger.LanguageName=Deutsch</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>ger.LanguageID=$0407</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>ger.LanguageCodePage=1251</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>ger.DialogFontName= MS Shell Dlg</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>ger.DialogFontSize=8</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>ger.WelcomeFontName=Verdana</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>ger.WelcomeFontSize=12</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>ger.TitleFontName=Arial</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>ger.TitleFontSize=29</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>ger.CopyrightFontName=Arial</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>ger.CopyrightFontSize=8</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><b><span lang=EN-US style=font-size:11.0pt>[Code]</span></b></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt;color:blue>function</span><span lang=EN-US style=font-size:11.0pt> MyConst(<span style=color:blue>Default</span>: <span style=color:blue>String</span>): <span style=color:blue>String</span>;</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>  <span style=color:blue>begin</span></span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>    <span style=color:blue>if</span> ActiveLanguage='ger' <span style=color:blue>then</span> Result:='Folder' <span style=color:blue>else</span> Result:='Papka';</span></p><p class=MsoNormal style=text-indent:27.0pt><span lang=EN-US style=font-size:11.0pt>  <span style=color:blue>end</span></span><span style=font-size:11.0pt>;</span></p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoNormal style=text-indent:27.0pt><b><span style=font-size:11.0pt>Решение (способ 2):</span></b><span style=font-size:11.0pt></span></p><p class=MsoBodyTextIndent2>Можно обойтись и без программирования, описав в секции <b>[</b><b><span lang=EN-US>CustomMessages</span></b><b>]</b> значения для константы {<span lang=EN-US>cm</span>:<span lang=EN-US>defdir</span>}.</p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Пусть если пользователь выберет установку на русском языке, папка приложения будет называться </span><span lang=EN-US style=font-size:11.0pt>Papka</span><span style=font-size:11.0pt>, а если на немецком, то </span><span lang=EN-US style=font-size:11.0pt>Folder</span><span style=font-size:11.0pt>.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Setup]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AppName</span><span lang=EN-US>=Program</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AppVerName</span><span lang=EN-US>=Program 1.0</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AppPublisher</span><span lang=EN-US>=Zuka-Buka, Inc.</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>DefaultDirName</span><span lang=EN-US>={pf}\{cm:defdir}</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>DefaultGroupName</span><span lang=EN-US>=Program 1.0</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>UsePreviousAppDir</span><span lang=EN-US>=no</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>UsePreviousGroup</span><span lang=EN-US>=no</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>AllowNoIcons</span><span lang=EN-US>=yes</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>ShowLanguageDialog</span><span lang=EN-US>=yes</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>LanguageDetectionMethod</span><span lang=EN-US>=none</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Compression</span><span lang=EN-US>=lzma</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[CustomMessages]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:green>;</span><span style=color:green>Для</span><span style=color:green> </span><span style=color:green>русского</span><span style=color:green> </span><span style=color:green>языка</span><span style=color:green> </span><span style=color:green>константе</span><span style=color:green> <span lang=EN-US>defdir </span></span><span style=color:green>присвоится</span><span style=color:green> </span><span style=color:green>значение</span><span lang=EN-US style=color:green> ‘Papka’, </span><span style=color:green>а</span><span style=color:green> </span><span style=color:green>для</span><span style=color:green> </span><span style=color:green>немецкого</span><span lang=EN-US style=color:green> – ‘Folder’.</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>rus.defdir=Papka</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>ger.defdir=Folder</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Files]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: &quot;C:\MATRIX.exe&quot;; <span style=color:blue>DestDir</span>: &quot;{app}&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Source</span><span lang=EN-US>: &quot;C:\ReadMe.txt&quot;; <span style=color:blue>DestDir</span>: &quot;{app}\Data&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[Languages]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span><span lang=EN-US>: &quot;rus&quot;; <span style=color:blue>MessagesFile</span>: &quot;C:\Russian.isl&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US style=color:blue>Name</span><span lang=EN-US>: &quot;ger&quot;; <span style=color:blue>MessagesFile</span>: &quot;C:\German.isl&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><b><span lang=EN-US>[LangOptions]</span></b></p><p class=MsoBodyTextIndent2><span lang=EN-US>rus.LanguageName=&lt;0420&gt;&lt;0443&gt;&lt;0441&gt;&lt;0441&gt;&lt;043A&gt;&lt;0438&gt;&lt;0439&gt;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>rus.LanguageID=$0419</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>rus.LanguageCodePage=1251</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>rus.DialogFontName= MS Shell Dlg</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>rus.DialogFontSize=8</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>rus.WelcomeFontName=Verdana</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>rus.WelcomeFontSize=12</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>rus.TitleFontName=Arial</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>rus.TitleFontSize=29</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>rus.CopyrightFontName=Arial</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>rus.CopyrightFontSize=8</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>ger.LanguageName=Deutsch</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>ger.LanguageID=$0407</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>ger.LanguageCodePage=1251</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>ger.DialogFontName= MS Shell Dlg</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>ger.DialogFontSize=8</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>ger.WelcomeFontName=Verdana</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>ger.WelcomeFontSize=12</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>ger.TitleFontName=Arial</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>ger.TitleFontSize=29</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>ger.CopyrightFontName=Arial</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>ger.CopyrightFontSize=8</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2>Этот вариант решения был предложен <b><span lang=EN-US style=color:blue>mr</span><span style=color:blue>_</span></b><b><span lang=EN-US style=color:blue>eoi</span></b><span lang=EN-US> </span>на компьютерном форуме <span lang=EN-US>Ru</span>-<span lang=EN-US>Board</span>.</p><p class=MsoBodyTextIndent2><b>&nbsp;</b></p><p class=MsoBodyTextIndent2><b>&nbsp;</b></p><p class=MsoBodyTextIndent2><b>&nbsp;</b></p><p class=MsoBodyTextIndent2 align=center style=text-align:center><b><span style=font-size:16.0pt>Не могу найти решение</span></b></p><p class=MsoBodyTextIndent2><b>&nbsp;</b></p><p class=MsoBodyTextIndent2><b>&nbsp;</b></p><p class=MsoBodyTextIndent2><b>Задача </b>: <b>установить/удалить</b> компоненты программы из Панели управления <span lang=EN-US>Windows</span>. Хотелось бы, чтобы при добавлении/удалении инсталлятор выдавал сообщение: «Вставьте диск в <span lang=EN-US>CD</span>-<span lang=EN-US>Rom</span>».</p><p class=MsoBodyTextIndent2><b>Решение:</b></p><p class=MsoBodyTextIndent2>Эта задача решается с помощью директивы <b><span lang=EN-US style=font-size:12.0pt>AppModifyPath</span></b><b><span lang=EN-US style=font-size:12.0pt> </span></b><span style=font-size:12.0pt>секции <b>[</b></span><b><span lang=EN-US style=font-size:12.0pt>Setup</span></b><b><span style=font-size:12.0pt>]</span></b><span style=font-size:12.0pt>.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Пусть теперь пользователь будет иметь возможность удалить ненужные ему компоненты программы и установить нужные. Для этого на странице <i>Установка и удаление программ</i> Панели управления достаточно будет нажать кнопку <b>Изменить</b>.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>При старте установки в окне можно выбрать, что сделать с программой: удалить компоненты, установить компоненты, удалить все.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoBodyTextIndent2><b>Задача :</b> если в указанной пользователем директории приложения существует папка <span lang=EN-US>Data</span>, ее удалить вместе с ее содержимым, создать папку с тем же именем, установить туда все файлы. Если папка не существует, прервать установку.</p><p class=MsoBodyTextIndent2><b> Решение:</b></p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>[<span lang=EN-US>InstallDelete</span>]</p><p class=MsoBodyTextIndent2><span lang=EN-US>Type</span>: <span lang=EN-US>filesandordirs</span>; <span lang=EN-US>Name</span>: &quot;{<span lang=EN-US>app</span>}\<span lang=EN-US>Data</span>&quot;</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><span lang=EN-US>[Dirs]</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>Name: &quot;{app}\Data&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>[Files]</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>Source: &quot;C:\MATRIX.EXE&quot;; DestDir: &quot;{app}\Data&quot;; DestName: &quot;Matritsa.exe&quot;; BeforeInstall: MyBeforeInstall</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>Source: &quot;C:\ReadMe.txt&quot;; DestDir: &quot;{app}\Data&quot;; Flags: isreadme</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>&nbsp;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>[UninstallDelete]</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>Type: filesandordirs; Name: &quot;{app}\Data&quot;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US> </span></p><p class=MsoBodyTextIndent2><span lang=EN-US>[Code]</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>Procedure MyBeforeInstall;</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>begin</span></p><p class=MsoBodyTextIndent2><span lang=EN-US> if DirExists(ExpandConstant('{app}\Data')) then</span></p><p class=MsoBodyTextIndent2><span lang=EN-US>  DelTree(ExpandConstant('{app}\Data'), True, True, True);</span></p><p class=MsoBodyTextIndent2>end;</p><p class=MsoNormal><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>Не получается: если папка не существует, инсталлятор ее создает и продолжает установку, а не прерывает ее.</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoBodyTextIndent2><b>Задача</b>: Работа с диалоговыми окнами, объектами СОМ… <b><span style=font-size:12.0pt>(</span></b>рассмотреть пример из папки <span lang=EN-US>Inno</span><span lang=EN-US> </span><span lang=EN-US>Setup</span> (CodeClasses.iss)).</p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoBodyTextIndent2><b>Задание</b>: ассоциировать файлы с устанавливаемой программой (секция <b>[</b><b><span lang=EN-US>Tasks</span></b><b>]</b>). Похоже, что за это отвечает не только инсталлятор, а еще и в программе прописывается какой-то код.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2><b>Задача: </b>выдать сообщение на странице Блокнота перед окном <i>Приветствие</i> Мастера.</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoBodyTextIndent2>&nbsp;</p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal style=text-indent:27.0pt><span style=font-size:11.0pt>&nbsp;</span></p><p class=MsoNormal align=center style=text-align:center;text-indent:27.0pt><b>&nbsp;</b></p></div></body></html>