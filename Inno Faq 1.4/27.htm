<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1251"><title>Создание панели</title><link rel="stylesheet" type="text/css" href="css.css"><script type="text/javascript" src="includer.js"></script><script language='jscript' type='text/javascript' src='copycode.js'></script></head><body><div id="heading"><h1>» Inno Setup Faq. Создание панели</h1></div><br><script language="javascript" type="text/javascript">includeSyntax('delphi');</script><code id="delphi_Tc4NTM"> <input type="button" value="Копировать в буфер обмена" onClick="copyToClipboard( taCode1, theCode1 );"> <blockquote id="theCode1"><font>///#define GameID &quot;{877D4608-029D-44D7-90AC-8C6C1D2323CD}&quot;<br>#define GameName &quot;Borderlands&quot;<br>#define GameVerName &quot;Borderlands [v 1.0]&quot;<br><br>[Setup]<br>AppName=My Program<br>AppVerName=My Program 1.5<br>AppPublisher=My Company, Inc.<br>AppPublisherURL=http://www.example.com/<br>AppSupportURL=http://www.example.com/<br>AppUpdatesURL=http://www.example.com/<br>DefaultDirName={pf}\My Program<br>DefaultGroupName=My Program<br>OutputBaseFilename=setup<br>Compression=lzma<br>SolidCompression=yes<br><br>[Languages]<br>Name: &quot;rus&quot;; MessagesFile: &quot;compiler:Languages\Russian.isl&quot;<br><br>[CustomMessages]<br>rus.Welcome=Приветствие<br>rus.System=Система<br>rus.Catalogue=Каталог<br>rus.StartMenu=Меню «Пуск»<br>rus.Task=Задачи<br>rus.Installing=Установка<br>rus.Uninstalling=Удаление<br>rus.Finish=Завершение<br><br>[CustomMessages]<br>rus.Welcome=Приветствие<br>rus.System=Система<br>rus.Catalogue=Каталог<br>rus.StartMenu=Меню «Пуск»<br>rus.Task=Задачи<br>rus.Installing=Установка<br>rus.Uninstalling=Удаление<br>rus.Finish=Завершение<br>rus.Welcome1=Вас приветствует Мастер установки игры%n{#GameName}<br>rus.Welcome2=Программа установит игру {#GameVerName} на Ваш компьютер.%n%nРекомендуется закрыть антивирусные пакеты, а также все прочие приложения перед тем, как продолжить.%n%nНажмите «Далее», чтобы продолжить, или&nbsp; «Отмена», чтобы выйти из программы установки.<br>rus.Requirements1=Проверка системных требований<br>rus.Requirements2=Программа установки обнаружила следующие необходимые компоненты<br>rus.Requirements3=Все компоненты удовлетворяют требованиям игры.<br>rus.Requirements4=Компоненты, выделенные красным, не удовлетворяют требованиям игры.<br>rus.DeviceDriver=Драйвер устройства не обнаружен<br>rus.Processor=Процессор<br>rus.VideoCard=Видеоадаптер<br>rus.SoundCard=Звуковая карта<br>rus.RAM=Память (ОЗУ)<br>rus.OperationSystem=Операционная система<br>rus.TotalSpace=Размер жесткого диска:<br>rus.FreeSpace=Доступно места на диске:<br>rus.NeedSpace=Требуется места на диске:<br>rus.SelectTasksLabel=Выберите дополнительные задачи, которые должны выполниться при установке игры, после этого нажмите «Установить».<br>rus.Language=Выберите язык игры:<br>rus.LanguageRus=Русский<br>rus.LanguageUS=English<br>rus.StartMenuLbl=Нажмите «Установить», чтобы продолжить. Если Вы хотите выбрать другую папку, нажмите «Обзор».<br>rus.TasksName=Выберите дополнительные задачи<br>rus.TasksDescription=Какие дополнительные задачи необходимо выполнить?<br>rus.DirectX=Обновить DirectX<br>rus.QuickLaunch=Создать ярлык в Панели быстрого запуска<br>rus.Desktop=Создать ярлык на Рабочем столе<br>rus.DirectXInstall=Идет обновление DirectX...<br>rus.AllProgress=Прогресс распаковки файлов:<br>rus.Remains=Осталось ждать<br>rus.Hour=час<br>rus.Min=мин<br>rus.Sec=сек<br>rus.FinishedHeading=Установка игры {#GameName} успешно завершена.<br>rus.FinishedLabel=Игра {#GameVerName} была успешно установлена на Ваш компьютер. Для ее запуска выберите соответствующий ярлык в меню «Пуск» или на Рабочем столе.<br>rus.FinishedLabel2=Нажмите «Завершить», чтобы выйти из программы установки.<br>rus.Uninstall=Удалить {#GameName}<br>rus.DeleteSave=Удалить сохраненные игры и профили?<br>rus.WizardUninst=Состояние удаления<br>rus.UninstDescript=Пожалуйста, подождите, пока игра будет удалена с Вашего компьютера.<br>rus.StatusUninst=Удаление игры {#GameName}...<br>rus.AllProgressUninst=Общий прогресс удаления игры:<br><br>[Files]<br>Source: &quot;InstallFiles\*&quot;; Flags: dontcopy;<br><br>[Icons]<br>Name: &quot;{group}\My Program&quot;; Filename: &quot;{app}\MyProg.exe&quot;<br><br>[Code]<br>type<br>TBtnEventProc = procedure (h:HWND);<br><br>var<br>SystemPage, SelectTasksPage: TWizardPage;<br>WFButtonFont, UPFButtonFont: TFont;<br>Welcome, System, Catalogue, StartMenu, Tasks, Installing, Finish, Uninstalling: TLabel;<br>StatusPanel, RequirementsPanel, Edit,DirFolder,HardDrivePanel,<br>GroupFolder,WizardImg,OldPosition, HDD, PBOldProc: Longint;<br><br>function WrapBtnCallback(Callback: TBtnEventProc; ParamCount: Integer): Longword; external 'wrapcallback@{tmp}\innocallback.dll stdcall delayload';<br><br>function ImgLoad(Wnd :HWND; FileName :PAnsiChar; Left, Top, Width, Height :integer; Stretch, IsBkg :boolean) :Longint; external 'ImgLoad@{tmp}\botva2.dll stdcall delayload';<br>procedure ImgSetPosition(img :Longint; NewLeft, NewTop, NewWidth, NewHeight :integer); external 'ImgSetPosition@{tmp}\botva2.dll stdcall delayload';<br>procedure ImgRelease(img :Longint); external 'ImgRelease@{tmp}\botva2.dll stdcall delayload';<br>procedure ImgSetVisibility(img :Longint; Visible :boolean); external 'ImgSetVisibility@{tmp}\botva2.dll stdcall delayload';<br>function ImgGetVisibility(img:Longint):boolean; external 'ImgGetVisibility@{tmp}\botva2.dll stdcall delayload';<br>procedure ImgApplyChanges(h:HWND); external 'ImgApplyChanges@{tmp}\botva2.dll stdcall delayload';<br>procedure gdipShutdown;&nbsp; external 'gdipShutdown@{tmp}\botva2.dll stdcall delayload';<br><br>function InitializeSetup: Boolean;<br>begin<br>&nbsp; ExtractTemporaryFile('botva2.dll');<br>&nbsp; ExtractTemporaryFile('innocallback.dll');<br>&nbsp; Result:=True;<br>end;<br><br>///************************************************ [Начало - Вставка изображений] ***************************************************///<br>procedure CreateWizardImage;<br>var<br>&nbsp; i: integer;<br>begin<br>&nbsp; WizardForm.ClientWidth:=ScaleX(798);<br>&nbsp; WizardForm.ClientHeight:=ScaleY(543);<br>&nbsp; WizardForm.Center;<br>&nbsp; WizardForm.OuterNotebook.Hide;<br>&nbsp; WizardForm.InnerNotebook.Hide;<br>&nbsp; WizardForm.Bevel.Hide;<br><br>&nbsp; ExtractTemporaryFile('StatusPanel.png');<br>&nbsp; ExtractTemporaryFile('StatusPanel2.png');<br><br>&nbsp; ImgLoad(WizardForm.Handle,ExpandConstant('{tmp}\StatusPanel.png'),ScaleX(0), ScaleY(95),WizardForm.ClientWidth,ScaleY(20),True,True);<br>&nbsp; StatusPanel:=ImgLoad(WizardForm.Handle,ExpandConstant('{tmp}\StatusPanel2.png'),ScaleX(0), ScaleY(95),ScaleX(114),ScaleY(20),True,True);<br><br>ImgApplyChanges(WizardForm.Handle);<br>end;<br><br>///************************************************ [Конец - Вставка изображений] ***************************************************///<br><br>///************************************************ [Начало - Панель] ***************************************************///<br>procedure CreateStatusPanel;<br>begin<br>&nbsp; Welcome := TLabel.Create(WizardForm);<br>&nbsp; with Welcome do begin<br>&nbsp; &nbsp; AutoSize:=False;<br>&nbsp; &nbsp; SetBounds(ScaleX(13), ScaleY(96), ScaleX(114), ScaleY(20));<br>&nbsp; &nbsp; Transparent:=True;<br>&nbsp; &nbsp; Font.Name:= 'Arial';<br>&nbsp; &nbsp; Font.Size:= 10;<br>&nbsp; &nbsp; Font.Style:=[fsBold];<br>&nbsp; &nbsp; Caption := ExpandConstant('{cm:Welcome}');<br>&nbsp; &nbsp; Parent := WizardForm;<br>&nbsp; end;<br><br>&nbsp; System := TLabel.Create(WizardForm);<br>&nbsp; with System do begin<br>&nbsp; &nbsp; AutoSize:=False;<br>&nbsp; &nbsp; SetBounds(ScaleX(143), ScaleY(96), ScaleX(114), ScaleY(20));<br>&nbsp; &nbsp; Transparent:=True;<br>&nbsp; &nbsp; Font.Name:= 'Arial';<br>&nbsp; &nbsp; Font.Size:= 10;<br>&nbsp; &nbsp; Font.Style:=[fsBold];<br>&nbsp; &nbsp; Caption := ExpandConstant('{cm:System}');<br>&nbsp; &nbsp; Parent := WizardForm;<br>&nbsp; end;<br><br>&nbsp; Catalogue := TLabel.Create(WizardForm);<br>&nbsp; with Catalogue do begin<br>&nbsp; &nbsp; AutoSize:=False;<br>&nbsp; &nbsp; SetBounds(ScaleX(260), ScaleY(96), ScaleX(114), ScaleY(20));<br>&nbsp; &nbsp; Transparent:=True;<br>&nbsp; &nbsp; Font.Name:= 'Arial';<br>&nbsp; &nbsp; Font.Size:= 10;<br>&nbsp; &nbsp; Font.Style:=[fsBold];<br>&nbsp; &nbsp; Caption := ExpandConstant('{cm:Catalogue}');<br>&nbsp; &nbsp; Parent := WizardForm;<br>&nbsp; end;<br><br>&nbsp; StartMenu := TLabel.Create(WizardForm);<br>&nbsp; with StartMenu do begin<br>&nbsp; &nbsp; AutoSize:=False;<br>&nbsp; &nbsp; SetBounds(ScaleX(357), ScaleY(96), ScaleX(114), ScaleY(20));<br>&nbsp; &nbsp; Transparent:=True;<br>&nbsp; &nbsp; Font.Name:= 'Arial';<br>&nbsp; &nbsp; Font.Size:= 10;<br>&nbsp; &nbsp; Font.Style:=[fsBold];<br>&nbsp; &nbsp; Caption := ExpandConstant('{cm:StartMenu}');<br>&nbsp; &nbsp; Parent := WizardForm;<br>&nbsp; end;<br><br>&nbsp; Tasks := TLabel.Create(WizardForm);<br>&nbsp; with Tasks do begin<br>&nbsp; &nbsp; AutoSize:=False;<br>&nbsp; &nbsp; SetBounds(ScaleX(490), ScaleY(96), ScaleX(114), ScaleY(20));<br>&nbsp; &nbsp; Transparent:=True;<br>&nbsp; &nbsp; Font.Name:= 'Arial';<br>&nbsp; &nbsp; Font.Size:= 10;<br>&nbsp; &nbsp; Font.Style:=[fsBold];<br>&nbsp; &nbsp; Caption := ExpandConstant('{cm:Task}');<br>&nbsp; &nbsp; Parent := WizardForm;<br>&nbsp; end;<br><br>&nbsp; Installing := TLabel.Create(WizardForm);<br>&nbsp; with Installing do begin<br>&nbsp; &nbsp; AutoSize:=False;<br>&nbsp; &nbsp; SetBounds(ScaleX(593), ScaleY(96), ScaleX(114), ScaleY(20));<br>&nbsp; &nbsp; Transparent:=True;<br>&nbsp; &nbsp; Font.Name:= 'Arial';<br>&nbsp; &nbsp; Font.Size:= 10;<br>&nbsp; &nbsp; Font.Style:=[fsBold];<br>&nbsp; &nbsp; Caption := ExpandConstant('{cm:Installing}');<br>&nbsp; &nbsp; Parent := WizardForm;<br>&nbsp; end;<br><br>&nbsp; Finish := TLabel.Create(WizardForm);<br>&nbsp; with Finish do begin<br>&nbsp; &nbsp; AutoSize:=False;<br>&nbsp; &nbsp; SetBounds(ScaleX(703), ScaleY(96), ScaleX(114), ScaleY(20));<br>&nbsp; &nbsp; Transparent:=True;<br>&nbsp; &nbsp; Font.Name:= 'Arial';<br>&nbsp; &nbsp; Font.Size:= 10;<br>&nbsp; &nbsp; Font.Style:=[fsBold];<br>&nbsp; &nbsp; Caption := ExpandConstant('{cm:Finish}');<br>&nbsp; &nbsp; Parent := WizardForm;<br>&nbsp; end;<br>end;<br>///************************************************ [Конец - Панель] ***************************************************///<br><br>procedure CreatePageComponents;<br>var<br>&nbsp; Pdm: string;<br>&nbsp; vr,VidRam : Longint;<br>&nbsp; Version: TWindowsVersion;<br>begin<br>SystemPage:=CreateCustomPage(wpLicense, ExpandConstant('{cm:Requirements1}'), ExpandConstant('{cm:Requirements2}'));<br>SelectTasksPage := CreateCustomPage(wpSelectProgramGroup, ExpandConstant('{cm:TasksName}'), ExpandConstant('{cm:TasksDescription}'));<br>end;<br><br>procedure ShowComponents(CurPageID: Integer);<br>begin<br>case CurPageID of<br>&nbsp; &nbsp; wpWelcome:<br>&nbsp; &nbsp; begin<br>&nbsp; &nbsp; Welcome.Font.Color := $00FFFF;<br>&nbsp; &nbsp; ImgSetPosition(StatusPanel,ScaleX(0),ScaleY(95),ScaleX(114),ScaleY(20));<br>end;<br><br>&nbsp; &nbsp; SystemPage.ID:<br>&nbsp; &nbsp; begin<br>&nbsp; &nbsp; &nbsp; System.Font.Color := $00FFFF;<br>&nbsp; &nbsp; &nbsp; ImgSetPosition(StatusPanel,ScaleX(114),ScaleY(95),ScaleX(114),ScaleY(20));<br>end;<br><br>wpSelectDir:<br>&nbsp; &nbsp; begin<br>&nbsp; &nbsp; &nbsp; Catalogue.Font.Color := $00FFFF;<br>&nbsp; &nbsp; &nbsp; ImgSetPosition(StatusPanel,ScaleX(228),ScaleY(95),ScaleX(114),ScaleY(20));<br>end;<br>&nbsp; &nbsp; wpSelectProgramGroup:<br>&nbsp; &nbsp; begin<br>&nbsp; &nbsp; &nbsp; StartMenu.Font.Color := $00FFFF;<br>&nbsp; &nbsp; &nbsp; ImgSetPosition(StatusPanel,ScaleX(342),ScaleY(95),ScaleX(114),ScaleY(20));<br>end;<br>&nbsp; &nbsp; SelectTasksPage.ID:<br>&nbsp; begin<br>&nbsp; &nbsp; Tasks.Font.Color := $00FFFF;<br>&nbsp; &nbsp; ImgSetPosition(StatusPanel,ScaleX(456),ScaleY(95),ScaleX(114),ScaleY(20));<br>end;<br><br>&nbsp; &nbsp; wpInstalling:<br>&nbsp; &nbsp; begin<br>&nbsp; &nbsp; &nbsp; Installing.Font.Color := $00FFFF;<br>&nbsp; &nbsp; &nbsp; ImgSetPosition(StatusPanel,ScaleX(570),ScaleY(95),ScaleX(114),ScaleY(20));<br>end;<br><br>&nbsp; &nbsp; wpFinished:<br>&nbsp; &nbsp; begin<br>&nbsp; &nbsp; &nbsp; Finish.Font.Color := $00FFFF;<br>&nbsp; &nbsp; &nbsp; ImgSetPosition(StatusPanel,ScaleX(684),ScaleY(95),ScaleX(114),ScaleY(20));<br>&nbsp; &nbsp; end<br>&nbsp; end;<br>end;<br><br><br>///************************************************ [Конец - Компоненты страниц] ***************************************************///<br>procedure InitializeWizard;<br>begin<br>&nbsp; CreateStatusPanel;<br>CreateWizardImage;<br>CreatePageComponents;<br>end;<br><br>procedure CurPageChanged(CurPageID: Integer);<br>begin<br>&nbsp; Welcome.Font.Color := $FFFFFF;<br>&nbsp; System.Font.Color := $FFFFFF;<br>&nbsp; Catalogue.Font.Color := $FFFFFF;<br>&nbsp; StartMenu.Font.Color := $FFFFFF;<br>&nbsp; Tasks.Font.Color := $FFFFFF;<br>&nbsp; Installing.Font.Color :=$FFFFFF;<br>&nbsp; Finish.Font.Color := $FFFFFF;<br><br>&nbsp; ShowComponents(CurPageID);<br>&nbsp; ImgApplyChanges(WizardForm.Handle);<br>end;<br><br>procedure DeinitializeSetup;<br>begin<br>&nbsp; gdipShutdown;<br>end;<br></font></blockquote><textarea id="taCode1" style="display:none;" rows="1" cols="5"></textarea><textarea id='taCode' style='display:none;' rows='1' cols='20'></textarea></code><script language="javascript" type="text/javascript">highlightSyntax('delphi_Tc4NTM','delphi');</script><br><div id="heading"><h1><font size="1" face="Consolas">Copyright (c) <a href="http://www.krinkels.org/" target="_blank">Krinkels Inc</a></font></h1></div></body></html>