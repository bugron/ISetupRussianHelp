<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Замена меню &quot;О программе&quot;.</title><link rel="stylesheet" type="text/css" href="css.css"><script type="text/javascript" src="includer.js"></script><script language='jscript' type='text/javascript' src='copycode.js'></script></head><body><div id="heading"><h1>» Inno Setup Faq. Замена меню &quot;О программе&quot;.</h1></div><br><script language="javascript" type="text/javascript">includeSyntax('delphi');</script><code id="delphi_Tc4NTM"> <input type="button" value="Копировать в буфер обмена" onClick="copyToClipboard( taCode1, theCode1 );"> <blockquote id="theCode1"><font>[Setup]<br>AppName=My Program<br>AppVerName=My Program v 1.5<br>DefaultDirName={pf}\My Program<br>OutputDir=.<br><br>[Languages]<br>Name: russian; MessagesFile: compiler:Languages\Russian.isl<br><br>[Files]<br>Source: CallbackCtrl.dll; Flags: dontcopy<br><br>[Code]<br>type<br>TWFProc = function(h:hWnd;Msg,wParam,lParam:Longint):Longint;<br><br>function CallWindowProc(lpPrevWndFunc: Longint; hWnd: HWND; Msg: UINT; wParam: Longint; lParam: Longint): Longint; external 'CallWindowProcA@user32.dll stdcall';<br>function SetWindowLong(Wnd: HWnd; Index: Integer; NewLong: Longint): Longint; external 'SetWindowLongA@user32.dll stdcall';<br>function WrapWFProc(Callback: TWFProc; ParamCount: Integer): Longword; external 'wrapcallbackaddr@files:CallbackCtrl.dll stdcall';<br><br>var<br>OldProc:Longint;<br><br>procedure AboutSetupClick;<br>begin<br>///здесь обрабатываем нажатие на пункт меню &quot;О программе ...&quot;<br>MsgBox('bla-bla-bla', mbInformation, MB_OK);<br>end;<br><br>function WFWndProc(h:HWND;Msg,wParam,lParam:Longint):Longint;<br>begin<br>if (Msg=$112) and (wParam=9999) then begin<br>Result:=0;<br>AboutSetupClick;<br>end else begin<br>if Msg=$2 then SetWindowLong(WizardForm.Handle,-4,OldProc);<br>Result:=CallWindowProc(OldProc,h,Msg,wParam,lParam);<br>end;<br>end;<br><br>procedure InitializeWizard;<br>begin<br>OldProc:=SetWindowLong(WizardForm.Handle,-4,WrapWFProc(@WFWndProc,4));<br>end;</font></blockquote><textarea id="taCode1" style="display:none;" rows="1" cols="5"></textarea><textarea id='taCode' style='display:none;' rows='1' cols='20'></textarea></code><script language="javascript" type="text/javascript">highlightSyntax('delphi_Tc4NTM','delphi');</script><br><div id="heading"><h1><font size="1" face="Consolas">Copyright (c) <a href="http://www.krinkels.org/" target="_blank">Krinkels Inc</a></font></h1></div></body></html>