<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=8" />
<title>Pascal Scripting: DecrementSharedCount</title>
<link rel="stylesheet" type="text/css" href="../styles.css" />
<script type="text/javascript" src="../topic.js"></script>
</head>
<body>
<h1 class="topicheading">Pascal Scripting: DecrementSharedCount</h1>
<div class="topicbody">
  <div><b>Прототип:</b></div>
  <p><tt>function DecrementSharedCount(const Is64Bit: Boolean; const Filename: String): Boolean;</tt></p>
  <div><b>Описание:</b></div>
  <p>Уменьшает счетчик ссылок для указанного файла в следующем разделе реестра:</p>
  <p>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\SharedDLLs</p>
  <p>В 64-разрядных версий Windows есть два отдельных SharedDLLs ключа, один для 64-битных файлов, другой для 32-битных. Если Is64Bit является True, будет обновлен 64-разрядный SharedDLLs ключ, иначе 32-разрядный. Значение этого параметра должно соответствовать разрядности файла; например, если 32-разряднй DLL файл находится в 32-битном системном каталоге, необходимо указать значение False. Вы также можете установить значение директивы <tt>Is64BitInstallMode</tt>. В этом случае для определения того, какой именно разрядности ключ нужно обновить, используется значение <tt>Is64BitInstallMode</tt>.</p>
  <p>Возвращает True, если счетчик достиг нуля (meaning it's OK to delete the file). Возвращает False, если обновленный счетчик больше нуля, или, если значение для файла не существует или находится в неузнаваемой формате.</p>
  <p>Исключение будет поднято, если раздел реестра не может быть открыт для записи.</p>
</div>
</body>
</html>