<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Примеры пред инсталляционных процессов</title><link rel="stylesheet" type="text/css" href="css.css"><script type="text/javascript" src="includer.js"></script><script language='jscript' type='text/javascript' src='copycode.js'></script></head><body><div id="heading"><h1>» Inno Setup Faq. Примеры пред инсталляционных процессов</h1></div><br>
<br>Вариант 1:<br>
<script language="javascript" type="text/javascript">includeSyntax('delphi');</script><code id="delphi_Tc4NTM">
<input type="button" value="Копировать в буфер обмена" onClick="copyToClipboard( taCode1, theCode1 );">
<blockquote id="theCode1"><font>
[Setup]<br>
AppName=Example.Mini.Progress.Bar<br>
AppVerName=Example.Mini.Progress.Bar&nbsp;1.5<br>
DefaultDirName={pf}\Example.Mini.Progress.Bar<br>
OutputBaseFilename=mini.progress.bar.by.genri<br>
WindowVisible=no<br>
<br>
[Languages]<br>
Name:&nbsp;russian;&nbsp;MessagesFile:&nbsp;compiler:Languages\Russian.isl<br>
<br>
[Files]<br>
Source:&nbsp;compiler:WizModernSmallImage.bmp;&nbsp;Flags:&nbsp;dontcopy&nbsp;nocompression<br>
<br>
[Code]<br>
function&nbsp;GetSystemMetrics(nIndex:&nbsp;Integer):&nbsp;Integer;&nbsp;external&nbsp;'GetSystemMetrics@user32.dll&nbsp;stdcall';<br>
<br>
procedure&nbsp;InitializeWizard();<br>
var<br>
&nbsp;&nbsp;Form:&nbsp;TSetupForm;<br>
&nbsp;&nbsp;ProgressBar:&nbsp;TNewProgressBar;<br>
&nbsp;&nbsp;CancelButton:&nbsp;TButton;<br>
&nbsp;&nbsp;StaticText:&nbsp;TNewStaticText;<br>
&nbsp;&nbsp;BitmapImage:&nbsp;TBitmapImage;<br>
&nbsp;&nbsp;BitmapFileName:&nbsp;string;<br>
&nbsp;&nbsp;i:&nbsp;Integer;<br>
begin<br>
&nbsp;&nbsp;Form&nbsp;:=&nbsp;CreateCustomForm();<br>
&nbsp;&nbsp;try<br>
&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;Form&nbsp;do<br>
&nbsp;&nbsp;&nbsp;&nbsp;begin<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ClientWidth&nbsp;:=&nbsp;ScaleX(375);&nbsp;///Ширина&nbsp;формы&nbsp;для&nbsp;ProgressBar<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ClientHeight&nbsp;:=&nbsp;ScaleY(120);&nbsp;///Высота&nbsp;формы&nbsp;для&nbsp;ProgressBar<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BorderStyle&nbsp;:=&nbsp;bsDialog;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Left&nbsp;:=&nbsp;GetSystemMetrics(16)&nbsp;-&nbsp;ClientWidth&nbsp;-&nbsp;ScaleX(5);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Top&nbsp;:=&nbsp;GetSystemMetrics(17)&nbsp;-&nbsp;ClientHeight&nbsp;-&nbsp;ScaleY(5);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Caption&nbsp;:=&nbsp;'Inno&nbsp;Setup&nbsp;Wizard'&nbsp;///Заголовок&nbsp;мини&nbsp;ProgressBar'a<br>
&nbsp;&nbsp;&nbsp;&nbsp;end;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;BitmapFileName&nbsp;:=&nbsp;ExpandConstant('{tmp}\WizModernSmallImage.bmp');<br>
&nbsp;&nbsp;&nbsp;&nbsp;ExtractTemporaryFile(ExtractFileName(BitmapFileName));<br>
&nbsp;&nbsp;&nbsp;&nbsp;BitmapImage&nbsp;:=&nbsp;TBitmapImage.Create(Form);<br>
&nbsp;&nbsp;&nbsp;&nbsp;BitmapImage.Left&nbsp;:=&nbsp;ScaleX(8);<br>
&nbsp;&nbsp;&nbsp;&nbsp;BitmapImage.Top&nbsp;:=&nbsp;ScaleY(8);<br>
&nbsp;&nbsp;&nbsp;&nbsp;BitmapImage.Width&nbsp;:=&nbsp;ScaleX(58);<br>
&nbsp;&nbsp;&nbsp;&nbsp;BitmapImage.Height&nbsp;:=&nbsp;ScaleY(58);<br>
&nbsp;&nbsp;&nbsp;&nbsp;BitmapImage.Bitmap.LoadFromFile(BitmapFileName);<br>
&nbsp;&nbsp;&nbsp;&nbsp;BitmapImage.Parent&nbsp;:=&nbsp;Form;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;StaticText&nbsp;:=&nbsp;TNewStaticText.Create(Form);<br>
&nbsp;&nbsp;&nbsp;&nbsp;StaticText.Top&nbsp;:=&nbsp;BitmapImage.Top;<br>
&nbsp;&nbsp;&nbsp;&nbsp;StaticText.Left&nbsp;:=&nbsp;BitmapImage.Left&nbsp;+&nbsp;BitmapImage.Width&nbsp;+&nbsp;ScaleX(8)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;StaticText.Caption&nbsp;:=&nbsp;'Идет&nbsp;подготовка&nbsp;к&nbsp;установке&nbsp;S.T.A.L.K.E.R.:&nbsp;Shadow&nbsp;Of'&nbsp;+&nbsp;#10#13&nbsp;+&nbsp;'Chernobyl'&nbsp;+&nbsp;#10#13#10&nbsp;+&nbsp;'Пожалуйста&nbsp;подождите...';&nbsp;///Текст&nbsp;самого&nbsp;мини&nbsp;ProgressBar'a<br>
&nbsp;&nbsp;&nbsp;&nbsp;StaticText.AutoSize&nbsp;:=&nbsp;True;<br>
&nbsp;&nbsp;&nbsp;&nbsp;StaticText.Parent&nbsp;:=&nbsp;Form;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;CancelButton&nbsp;:=&nbsp;TButton.Create(Form);<br>
&nbsp;&nbsp;&nbsp;&nbsp;CancelButton.Parent&nbsp;:=&nbsp;Form;<br>
&nbsp;&nbsp;&nbsp;&nbsp;CancelButton.Width&nbsp;:=&nbsp;ScaleX(75);<br>
&nbsp;&nbsp;&nbsp;&nbsp;CancelButton.Height&nbsp;:=&nbsp;ScaleY(23);<br>
&nbsp;&nbsp;&nbsp;&nbsp;CancelButton.Left&nbsp;:=&nbsp;Form.ClientWidth&nbsp;-&nbsp;ScaleX(75&nbsp;+&nbsp;10);<br>
&nbsp;&nbsp;&nbsp;&nbsp;CancelButton.Top&nbsp;:=&nbsp;Form.ClientHeight&nbsp;-&nbsp;ScaleY(23&nbsp;+&nbsp;10);<br>
&nbsp;&nbsp;&nbsp;&nbsp;CancelButton.Caption&nbsp;:=&nbsp;'Cancel';<br>
&nbsp;&nbsp;&nbsp;&nbsp;CancelButton.ModalResult&nbsp;:=&nbsp;mrCancel;<br>
&nbsp;&nbsp;&nbsp;&nbsp;CancelButton.Cancel&nbsp;:=&nbsp;True;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;ProgressBar&nbsp;:=&nbsp;TNewProgressBar.Create(Form);<br>
&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;ProgressBar&nbsp;do<br>
&nbsp;&nbsp;&nbsp;&nbsp;begin<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Height&nbsp;:=&nbsp;CancelButton.Height&nbsp;-&nbsp;ScaleY(8);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Width&nbsp;:=&nbsp;Form.Width&nbsp;-&nbsp;ScaleX(128);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Top&nbsp;:=&nbsp;CancelButton.Top;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Left&nbsp;:=&nbsp;BitmapImage.Left;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Parent&nbsp;:=&nbsp;Form;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Min&nbsp;:=&nbsp;0;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Max&nbsp;:=&nbsp;30;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Position&nbsp;:=&nbsp;0;<br>
&nbsp;&nbsp;&nbsp;&nbsp;end;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Form.ActiveControl&nbsp;:=&nbsp;CancelButton;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Form.Show();<br>
&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;:=&nbsp;0&nbsp;to&nbsp;30&nbsp;do<br>
&nbsp;&nbsp;&nbsp;&nbsp;begin<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ProgressBar.Position&nbsp;:=&nbsp;i;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form.Repaint;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sleep(500);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;:=&nbsp;i&nbsp;+&nbsp;1;<br>
&nbsp;&nbsp;&nbsp;&nbsp;end;<br>
&nbsp;&nbsp;finally<br>
&nbsp;&nbsp;&nbsp;&nbsp;Form.Free();<br>
&nbsp;&nbsp;end;<br>
end;<br>
</font></blockquote><textarea id="taCode1" style="display:none;" rows="1" cols="5"></textarea><textarea id='taCode' style='display:none;' rows='1' cols='20'></textarea></code><script language="javascript" type="text/javascript">highlightSyntax('delphi_Tc4NTM','delphi');</script>

<br>Вариант 2:<br>
<input type="button" value="Копировать в буфер обмена" onClick="copyToClipboard( taCode2, theCode2 );">
<blockquote id="theCode2"><font><script language="javascript" type="text/javascript">includeSyntax('delphi');</script><code id="delphi_Tc4NTN">
[Setup]<br>
AppName=My&nbsp;Program<br>
AppVerName=My&nbsp;Program&nbsp;version&nbsp;1.5<br>
DefaultDirName={pf}\My&nbsp;Program<br>
DefaultGroupName=My&nbsp;Program<br>
Compression=lzma<br>
SolidCompression=yes<br>
<br>
[Files]<br>
;Source:&nbsp;MyProg.exe;&nbsp;DestDir:&nbsp;{app}<br>
<br>
[Code]<br>
var<br>
&nbsp;&nbsp;CancelBtn:&nbsp;TButton;<br>
&nbsp;&nbsp;Msg:&nbsp;TMsg;<br>
<br>
function&nbsp;PeekMessage(var&nbsp;Msg:&nbsp;TMsg;&nbsp;Wnd:&nbsp;HWnd;&nbsp;MsgFilterMin,&nbsp;MsgFilterMax,&nbsp;wRemoveMsg:&nbsp;LongInt):&nbsp;LongInt;&nbsp;external&nbsp;'PeekMessageW@user32.dll&nbsp;stdcall';<br>
<br>
procedure&nbsp;ProcessMessage();<br>
begin<br>
&nbsp;&nbsp;MsgBox('hello',&nbsp;mbInformation,&nbsp;MB_OK);<br>
end;<br>
<br>
procedure&nbsp;InitializeWizard();<br>
var<br>
&nbsp;&nbsp;Form:&nbsp;TSetupForm;<br>
&nbsp;&nbsp;ProgressBar:&nbsp;TNewProgressBar;<br>
&nbsp;&nbsp;i:&nbsp;integer;<br>
//&nbsp;&nbsp;Wnd:&nbsp;HWND;<br>
&nbsp;&nbsp;res:&nbsp;LongInt;<br>
<br>
begin<br>
&nbsp;&nbsp;Form&nbsp;:=&nbsp;CreateCustomForm();<br>
&nbsp;&nbsp;try<br>
&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;Form&nbsp;do<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ClientWidth&nbsp;:=&nbsp;ScaleX(380);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ClientHeight&nbsp;:=&nbsp;ScaleY(120);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BorderStyle:=&nbsp;bsDialog;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Center;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end;<br>
&nbsp;&nbsp;&nbsp;&nbsp;CancelBtn&nbsp;:=&nbsp;TButton.Create(Form);<br>
&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;CancelBtn&nbsp;do<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Width&nbsp;:=&nbsp;ScaleX(75);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Height&nbsp;:=&nbsp;ScaleY(23);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Left&nbsp;:=&nbsp;Form.ClientWidth&nbsp;-&nbsp;ScaleX(75&nbsp;+&nbsp;10);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Top&nbsp;:=&nbsp;Form.ClientHeight&nbsp;-&nbsp;ScaleY(23&nbsp;+&nbsp;10);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Parent&nbsp;:=&nbsp;Form;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Caption&nbsp;:=&nbsp;'Cancel';<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end;<br>
&nbsp;&nbsp;&nbsp;&nbsp;ProgressBar&nbsp;:=&nbsp;TNewProgressBar.Create(Form);<br>
&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;ProgressBar&nbsp;do<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Height&nbsp;:=&nbsp;CancelBtn.Height&nbsp;-&nbsp;ScaleY(8);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Width&nbsp;:=&nbsp;Form.Width&nbsp;-&nbsp;ScaleX(128);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Top&nbsp;:=&nbsp;ScaleX(10);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Left&nbsp;:=&nbsp;ScaleY(10);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Parent&nbsp;:=&nbsp;Form;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Min:=&nbsp;0;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Max:=&nbsp;100;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Position&nbsp;:=&nbsp;0;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Form.ActiveControl:=&nbsp;CancelBtn;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Form.Show();<br>
&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i:=&nbsp;0&nbsp;to&nbsp;100&nbsp;do<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res:=&nbsp;PeekMessage(Msg,&nbsp;CancelBtn.Handle,&nbsp;$0202,&nbsp;$0202,&nbsp;1);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;res&nbsp;&lt;&gt;&nbsp;0&nbsp;then<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ProcessMessage();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ProgressBar.Position:=&nbsp;ProgressBar.Position&nbsp;+&nbsp;1;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form.Refresh;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sleep(10);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end;<br>
&nbsp;&nbsp;finally<br>
&nbsp;&nbsp;&nbsp;&nbsp;Form.Free();<br>
&nbsp;&nbsp;end;<br>
end;<br>
<script language="javascript" type="text/javascript">highlightSyntax('delphi_Tc4NTN','delphi');</script></code></font></blockquote><font><code id="delphi_Tc4NTN"><textarea id="taCode2" style="display:none;" rows="1" cols="5"></textarea><textarea id='taCode' style='display:none;' rows='1' cols='20'></textarea></code><br><br><div id="heading"><h1><font size="1" face="Consolas">Copyright (c) <a href="http://www.krinkels.org/" target="_blank">Krinkels Inc</a></font></h1></div></font></body></html>