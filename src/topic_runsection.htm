<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251" />
<meta http-equiv="X-UA-Compatible" content="IE=8" />
<title>Секции [Run] и [UninstallRun]</title>
<!--[if IE 6]><style type="text/css">html{overflow-y:scroll}</style><![endif]-->
<link rel="stylesheet" type="text/css" href="styles.css" />
<script type="text/javascript" src="topic.js"></script>
</head>
<body>
<h1 class="topicheading">Секции [Run] и [UninstallRun]</h1>
<div class="topicbody">
  <p>Это не обязательная секция. Она определяет программы, которые следует запустить после удачной установки, но перед отображением диалога завершения установки. Секция [UninstallRun] также необязательна и определяет программы, которые следует выполнить в начале <i>деинсталляции</i>. Обе секции имеют одинаковый синтаксис, кроме отличий, указанных ниже.</p>
  <p>Программы запускаются в том порядке, в каком они указаны в скрипте. Выполняя параметры секций [Run]/[UninstallRun], инсталлятор/деинсталлятор подождет, пока программа завершит свою работу перед тем, как перейти к следующему параметру. Исключения составляют параметры с флагами <tt>nowait</tt>, <tt>shellexec</tt> или <tt>waituntilidle</tt>.</p>
  <p>Обратите внимание, что по умолчанию, если программа выполняется в секции [Run] и обнаружится, что файлы могут быть замещены/удалены после перезагрузки (это может быть вызвано параметром MoveFileEx или модификацией wininit.ini), инсталлятор это обнаружит и предложит пользователю перезагрузить компьютер после установки. Если вы этого не хотите, задайте директиве <a href="topic_setup_restartifneededbyrun.htm">RestartIfNeededByRun</a> значение <tt>no</tt>.</p>
  <p>Пример секции <tt>[Run]</tt>.</p>
  <pre class="indent examplebox">[Run]<br />Filename: &quot;{app}\INIT.EXE&quot;; Parameters: &quot;/x&quot;<br />Filename: &quot;{app}\README.TXT&quot;; Description: &quot;View the README file&quot;; Flags: postinstall shellexec skipifsilent<br />Filename: &quot;{app}\MYPROG.EXE&quot;; Description: &quot;Launch application&quot;; Flags: postinstall nowait skipifsilent unchecked</pre>
  <p>Список поддерживаемых <a href="topic_params.htm">параметров</a>:</p>
  <dl>
    <dt class="paramlist"><b><a name="Filename" id="Filename">Filename</a></b>&nbsp;<i>(Обязательно)</i></dt>
    <dd class="paramlist">
      <p>Программа для выполнения или файл/папка для открытия. Если <tt>Filename</tt> не исполняемый (не .exe или .com) или не командный (.bat или .cmd), следует использовать флаг <tt>shellexec</tt>. Параметр может содержать константы.</p>
      <div class="examplebox">
        <div class="exampleheader">Например:</div>
        <pre class="nomargin">Filename: &quot;{app}\INIT.EXE&quot;</pre>
      </div>
    </dd>
    <dt class="paramlist"><b><a name="Description" id="Description">Description</a></b></dt>
    <dd class="paramlist">
      <p>Действителен только в секции <tt>[Run]</tt>. Описание параметра, которое может включать константы. Это описание используется для параметров с флагом <tt>postinstall</tt>. Если описание параметра не задано, инсталлятор использует описание по умолчанию. Это описание зависит от типа параметра (normal или <tt>shellexec</tt>).</p>
      <div class="examplebox">
        <div class="exampleheader">Например:</div>
        <pre class="nomargin">Description: &quot;View the README file&quot;</pre>
      </div>
    </dd>
    <dt class="paramlist"><b><a name="Parameters" id="Parameters">Parameters</a></b></dt>
    <dd class="paramlist">
      <p>Дополнительные параметры командной строки, которые могут содержать константы.</p>
      <div class="examplebox">
        <div class="exampleheader">Например:</div>
        <pre class="nomargin">Parameters: &quot;/x&quot;</pre>
      </div>
    </dd>
    <dt class="paramlist"><b><a name="WorkingDir" id="WorkingDir">WorkingDir</a></b></dt>
    <dd class="paramlist">
      <p>Папка, из которой запускается программа. Если этот параметр не указан или пустой, используется папка, указанная в параметре <tt>Filename</tt>. Если параметр <tt>Filename</tt> не включает в себя путь к папке, то он будет использован как папка по умолчанию. Параметр может включать константы.</p>
      <div class="examplebox">
        <div class="exampleheader">Например:</div>
        <pre class="nomargin">WorkingDir: &quot;{app}&quot;</pre>
      </div>
    </dd>
    <dt class="paramlist"><b><a name="StatusMsg" id="StatusMsg">StatusMsg</a></b></dt>
    <dd class="paramlist">
      <p>Действителен только в секции <tt>[Run]</tt>. Определяет сообщение, отображаемое в окне мастера в процессе выполнения программы. Если этот параметр не указан или пустой, будет использовано сообщение по умолчанию, то есть  &quot;Завершение установки...&quot; (&quot;Finishing installation...&quot;). Параметр может включать константы.</p>
      <div class="examplebox">
        <div class="exampleheader">Например:</div>
        <pre class="nomargin">StatusMsg: &quot;Installing BDE...&quot;</pre>
      </div>
    </dd>
    <dt class="paramlist"><b><a name="RunOnceId" id="RunOnceId">RunOnceId</a></b></dt>
    <dd class="paramlist">
      <p>Действителен только в секции <tt>[UninstallRun]</tt>. Если <a href="topic_sameappnotes.htm">то же самое приложение</a> установлено несколько раз, параметры, предназначенные для запуска, продублируются в файле деинсталляции. Задав строку в <tt>RunOnceId</tt>, параметр в <tt>[UninstallRun]</tt> выполнится только один раз при деинсталляции. Например, если два и более параметра для запуска в файле деинсталляции указаны в <tt>RunOnceId</tt> в &quot;DelService&quot;, только последний из параметров в <tt>RunOnceId</tt> будет выполнен, а остальные будут игнорированы. Обратите внимание, что сравнение значений <tt>RunOnceId</tt> выполняется с учетом регистра. Если Вы не присвоете <tt>RunOnceId</tt> строку, компилятор предупредит Вас об этом, что можно отключить директивой <a href="topic_setup_missingrunonceidswarning.htm">MissingRunOnceIdsWarning</a>.</p>
      <div class="examplebox">
        <div class="exampleheader">Например:</div>
        <pre class="nomargin">RunOnceId: &quot;DelService&quot;</pre>
      </div>
    </dd>
    <dt class="paramlist"><b><a name="Verb" id="Verb">Verb</a></b></dt>
    <dd class="paramlist">
      <p>Определяет действие, которое будет выполняться на файле. Должен использоваться с флагом <tt>shellexec</tt>. Обычно это действия  &quot;open&quot; и &quot;print&quot;. Если этот параметр не будет определен или будет пустым, то для типа файла будет использоваться действие по умолчанию (обычно &quot;open&quot;).</p>
      <div class="examplebox">
        <div class="exampleheader">Например:</div>
        <pre class="nomargin">Verb: &quot;print&quot;</pre>
      </div>
    </dd>
    <dt class="paramlist"><b><a name="Flags" id="Flags">Flags</a></b></dt>
    <dd class="paramlist">
      <p>Параметры для установки дополнительных опций. Разделяются пробелами. Поддерживаемые значения:</p>
      <dl>
        <dt class="flaglist"><a name="32bit" id="32bit">32bit</a></dt>
        <dd>
          <p>Заставляет константу <tt>{sys}</tt> принять значение 32-разрядного каталога System, при использовании в параметрах <tt>Filename</tt> и <tt>WorkingDir</tt>. Это - поведение по умолчанию в <a href="topic_32vs64bitinstalls.htm">32-разрядном режиме установки</a>.</p>
          <p>Данный флаг не может комбинироваться с флагом<tt> shellexec</tt>.</p>
        </dd>
        <dt class="flaglist"><a name="64bit" id="64bit">64bit</a></dt>
        <dd>
          <p>Заставляет константу <tt>{sys}</tt> принять значение 64-разрядного каталога System, при использовании в параметрах <tt>Filename</tt> и <tt>WorkingDir</tt>. Это - поведение по умолчанию в <a href="topic_32vs64bitinstalls.htm">64-разрядном режиме установки</a>.</p>
          <p>Флаг может использоваться только тогда, когда инсталлятор выполняется в 64-разрядном Windows, иначе произойдет ошибка. На инсталляторе, поддерживающей и 32 и 64-разрядные архитектуры, возможно избежать ошибки, добавляя параметр <tt>Check: IsWin64</tt>, который при запуске инсталлятора в 32-разрядной системе тихо пропустит запись.</p>
          <p>Данный флаг не может комбинироваться с флагом<tt> shellexec</tt>.</p>
        </dd>
        <dt class="flaglist"><a name="dontlogparameters">dontlogparameters</a></dt>
        <dd>
          <p>Если указан этот флаг, параметры командной строки не будут включены в файл журнала.</p>
        </dd>
        <dt class="flaglist"><a name="hidewizard" id="hidewizard">hidewizard</a></dt>
        <dd>
          <p>Если указан этот флаг, мастер будет скрыт во время выполнения программы.</p>
        </dd>
        <dt class="flaglist"><a name="nowait" id="nowait">nowait</a></dt>
        <dd>
          <p>Если указан этот флаг, инсталлятор не будет ждать завершения работы выполняемой программы, чтобы перейти к следующему параметру секции [Run] или завершить установку. Не комбинируется с флагами <tt>waituntilidle</tt> и <tt>waituntilterminated</tt>.</p>
        </dd>
        <dt class="flaglist"><a name="postinstall" id="postinstall">postinstall</a></dt>
        <dd>
          <p>Действителен только в секции [Run]. Указывает инсталлятору создать задание с флажком (checkbox) на странице мастера <i>Установка завершена</i>. Пользователь может снять или поставить этот флажок и тем самым выбрать, будет ли эта запись обработана или нет. Раньше этот флаг назывался <tt>showcheckbox</tt>.</p>
          <p>Если инсталлятор должен перезагрузить компьютер пользователя (после установки файла с флагом <tt>restartreplace</tt> или если директива <tt>AlwaysRestart</tt> секции <tt>[Setup]</tt> равна <tt>yes</tt>), страница с флажком для выбора не сможет отобразиться и из-за этого параметр не будет обработан.</p>
          <p>Флаг <tt>isreadme</tt> для параметров секции [Files] теперь не нужен. Если компилятор обнаружит флаг <tt>isreadme</tt>, он его удалит и заменит соответствующим заданием секции [Run] в начале этой секции. У этого задания будут флаги <tt>shellexec</tt>, <tt>skipifdoesntexist</tt>, <tt>postinstall</tt> и <tt>skipifsilent</tt>.</p>
        </dd>
        <dt class="flaglist"><a name="runascurrentuser" id="runascurrentuser">runascurrentuser</a></dt>
        <dd>
          <p>Если этот флаг будет определен, то порожденный процесс унаследует пользовательские учетные данные инсталлятора/деинсталлятора (обычно, полные административные полномочия).</p>
          <p>Это - поведение по умолчанию, когда флаг <tt>postinstall</tt> не используется.</p>
          <p>Этот флаг не может комбинироваться с <tt>runasoriginaluser</tt>.</p>
        </dd>
        <dt class="flaglist"><a name="runasoriginaluser" id="runasoriginaluser">runasoriginaluser</a></dt>
        <dd>
          <p>Работает только в секции [Run]. Если этот флаг определен, то порожденный процесс выполнится с учетными данными пользователя, который первоначально запустил инсталлятор (то есть, учетные данные &quot;диалог pre-UAC&quot;).</p>
          <p>Это - поведение по умолчанию, когда флаг <tt>postinstall</tt> используется.</p>
          <p>Если пользователь запустит инсталлятор от имени администратора (щелчок по правой кнопке мышки на EXE файле -&gt; &quot;Запуск от имени администратора&quot;), то тогда этот флаг, к сожалению, не будет иметь никакого эффекта, потому что инсталлятор не имеет возможность выполнения любого кода с исходными пользовательскими учетными данными. Будем иметь аналогичную ситуацию, если инсталлятор запустится от уже поднятого процесса. Обратите внимание, однако, что это не специфичное ограничение для Inno Setup; основанные на установщике Windows инсталляторы в таких случаях тоже не могут возвращать исходные пользовательские учетные данные.</p>
          <p>Этот флаг не может комбинироваться с <tt>runascurrentuser</tt>.</p>
        </dd>
        <dt class="flaglist"><a name="runhidden" id="runhidden">runhidden</a></dt>
        <dd>
          <p>Если установлен этот флаг, программа запустится в скрытом окне. Никогда не используйте этот флаг для программы, которой потребуется, чтобы пользователь ввел какие-либо данные.</p>
        </dd>
        <dt class="flaglist"><a name="runmaximized" id="runmaximized">runmaximized</a></dt>
        <dd>
          <p>Если установлен этот флаг, программа или документ будут запущены в развернутом окне.</p>
        </dd>
        <dt class="flaglist"><a name="runminimized" id="runminimized">runminimized</a></dt>
        <dd>
          <p>Если установлен этот флаг, программа или документ будут запущены в свернутом окне.</p>
        </dd>
        <dt class="flaglist"><a name="shellexec" id="shellexec">shellexec</a></dt>
        <dd>
          <p>Этот флаг нужно использовать, только если в <tt>Filename</tt> задан не исполняемый файл (не .exe и не .com). Когда флаг установлен, <tt>Filename</tt> может быть папкой или любым зарегистрированным типом файла - включая .chm, .doc и т.д. Файл будет отрыт программой по умолчанию для его типа. То же произойдет, если пользователь дважды кликнет мышью на файле в окне Проводника.</p>
          <p>По умолчанию, при использовании флага <tt>shellexec</tt>, инсталлятор не будет ждать, пока завершится запущенный процесс. Если необходимо, чтобы инсталлятор подождал завершения выполнения процесса, следует комбинировать флаг <tt>shellexec</tt> с флагом <tt>waituntilterminated</tt>. Обратите внимание, что инсталлятор не будет ждать окончания процесса, если, например, в <tt>Filename</tt> указана папка.</p>
        </dd>
        <dt class="flaglist"><a name="skipifdoesntexist" id="skipifdoesntexist">skipifdoesntexist</a></dt>
        <dd>
          <p>Если этот флаг указан в секции [Run], инсталлятор не выдаст сообщения об ошибке, если <tt>Filename</tt> не существует.</p>
          <p>Если этот флаг указан в секции [UninstallRun], деинсталлятор не выдаст предупреждение &quot;Некоторые элементы не могут быть удалены&quot;, если <tt>Filename</tt> не существует.</p>
          <p>При использовании этого флага, <tt>Filename</tt> должен быть абсолютным путем.</p>
        </dd>
        <dt class="flaglist"><a name="skipifnotsilent" id="skipifnotsilent">skipifnotsilent</a></dt>
        <dd>
          <p>Действует только в секции [Run]. Указывает инсталлятору пропускать параметр, если инсталлятор не запущен в (очень) тихом режиме.</p>
        </dd>
        <dt class="flaglist"><a name="skipifsilent" id="skipifsilent">skipifsilent</a></dt>
        <dd>
          <p>Действует только в секции [Run]. Указывает инсталлятору пропускать параметр, если инсталлятор запущен в (очень) тихом режиме.</p>
        </dd>
        <dt class="flaglist"><a name="unchecked" id="unchecked">unchecked</a></dt>
        <dd>
          <p>Действует только в секции [Run]. Указывает инсталлятору снять флажок. Пользователь может его выбрать, если захочет. Этот флаг игнорируется, если также указан флаг <tt>postinstall</tt>.</p>
        </dd>
        <dt class="flaglist"><a name="waituntilidle" id="waituntilidle">waituntilidle</a></dt>
        <dd>
          <p>Если установлен этот флаг, инсталляция остановится и подождет, пока пользователь введет необходимые ей данные, вместо того, чтобы ожидать окончания процесса. (Вызывается Win32 функция <i>WaitForInputIdle</i>). Не комбинируется с <tt>nowait</tt> или <tt>waituntilterminated</tt>.</p>
        </dd>
        <dt class="flaglist"><a name="waituntilterminated" id="waituntilterminated">waituntilterminated</a></dt>
        <dd>
          <p>Если указан этот флаг, инсталлятор подождет, пока процесс полностью завершится. Обратите внимание, что этот флаг всегда задается по умолчанию (т.е. для того, чтобы инсталлятор подождал, пока завершится процесс, этот флаг указывать не обязательно). Указывается он только в комбинации с флагом <tt>shellexec</tt> - в этом случае это необходимо, если инсталлятор должен дождаться завершения процесса. Не комбинируется с флагами <tt>nowait</tt> и <tt>waituntilidle</tt>.</p>
        </dd>
      </dl>
      <div class="examplebox">
        <div class="exampleheader">Например:</div>
        <pre class="nomargin">Flags: postinstall nowait skipifsilent</pre>
      </div>
    </dd>
  </dl>
  <p><b><a href="topic_componentstasksparams.htm">Параметры секций Сomponents и Tasks</a></b></p>
  <p><b><a href="topic_commonparams.htm">Общие параметры</a></b></p>
</div>
</body>
</html>
