<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1251"><title>Проигрывание музыки</title><link rel="stylesheet" type="text/css" href="css.css"><script type="text/javascript" src="includer.js"></script><script language='jscript' type='text/javascript' src='copycode.js'></script></head><body><div id="heading"><h1>» Inno Setup Faq. Проигрывание музыки</h1></div><br><script language="javascript" type="text/javascript">includeSyntax('delphi');</script><code id="delphi_Tc4NTM"> <input type="button" value="Копировать в буфер обмена" onClick="copyToClipboard( taCode1, theCode1 );"> <blockquote id="theCode1"><font>[Files]<br>Source: &quot;C:\BASS.dll&quot;; DestDir: &quot;{tmp}&quot;; Flags: dontcopy<br>Source: &quot;C:\01-OVERSEER-Doomsday.mp3&quot;; DestDir: &quot;{tmp}&quot;; Flags: dontcopy<br><br>[Code]<br>///большее указание смотрите в дельфийских исходниках в архиве с библиотекой<br>сonst<br>&nbsp; BASS_SAMPLE_LOOP&nbsp;=&nbsp;4;&nbsp; ///повторение<br><br>type<br>&nbsp; HSTREAM = DWORD;&nbsp; &nbsp; &nbsp; ///тип звукового потока<br><br>function BASS_Init(device: Integer; freq, flags: DWORD; win: hwnd; CLSID: Integer): Boolean;<br>external 'BASS_Init@files:BASS.dll stdcall delayload';<br><br>function BASS_StreamCreateFile(mem: BOOL; f: PChar; offset: DWORD ; length: DWORD; flags: DWORD): HSTREAM;<br>external 'BASS_StreamCreateFile@files:BASS.dll stdcall delayload';<br><br>function BASS_Start(): Boolean;<br>external 'BASS_Start@files:BASS.dll stdcall delayload';<br><br>function BASS_ChannelPlay(handle: DWORD; restart: BOOL): Boolean;<br>external 'BASS_ChannelPlay@files:BASS.dll stdcall delayload';<br><br>function&nbsp; BASS_Stop(): Boolean;<br>external 'BASS_Stop@files:BASS.dll stdcall delayload';<br><br>function&nbsp; BASS_Free(): Boolean;<br>external 'BASS_Free@files:BASS.dll stdcall delayload';<br><br>procedure InitializeWizard();<br>var<br>&nbsp; Name1: string ;<br>&nbsp; i: Integer;<br>begin<br>&nbsp; ExtractTemporaryFile('BASS.dll');<br>&nbsp; &nbsp; ExtractTemporaryFile('01-OVERSEER-Doomsday.mp3');<br>&nbsp; if BASS_Init(-1, 44100, 0, 0, 0) then<br>begin<br>&nbsp; BASS_Start();<br>&nbsp; Name1:=ExpandConstant('{tmp}\01-OVERSEER-Doomsday.mp3');<br>&nbsp; &nbsp; i:=BASS_StreamCreateFile(FALSE, PChar(Name1), 0, 0, 4);<br>&nbsp; if i &lt;&gt; 0 then<br>begin<br>&nbsp; BASS_ChannelPlay(i, True);<br>end;<br>end;<br>end;<br><br>procedure DeInitializeSetup();<br>begin<br>&nbsp; BASS_Stop(); ///нужно для остановки проигрывания<br>&nbsp; BASS_Free(); ///нужно для быстрой выгрузки библиотеки вместе с муз. файлом<br>end;<br></font></blockquote><textarea id="taCode1" style="display:none;" rows="1" cols="5"></textarea><textarea id='taCode' style='display:none;' rows='1' cols='20'></textarea></code><script language="javascript" type="text/javascript">highlightSyntax('delphi_Tc4NTM','delphi');</script><br><div id="heading"><h1><font size="1" face="Consolas">Copyright (c) <a href="http://www.krinkels.org/" target="_blank">Krinkels Inc</a></font></h1></div></body></html>