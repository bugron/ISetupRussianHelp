<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Анимированное появление формы инсталлятора</title><link rel="stylesheet" type="text/css" href="css.css">
<script language='jscript' type='text/javascript' src='copycode.js'></script>
<script type="text/javascript" src="includer.js"></script></head><body><div id="heading"><h1>» Inno Setup Faq. Анимированное появление формы инсталлятора</h1></div><br>
<script language="javascript" type="text/javascript">includeSyntax('delphi');</script><code id="delphi_Tc4NTM">
<input type="button" value="Копировать в буфер обмена" onClick="copyToClipboard( taCode1, theCode1 );">
<blockquote id="theCode1"><font>
;;Функция&nbsp;AnimateWindow&nbsp;дает&nbsp;Вам&nbsp;возможность&nbsp;производить&nbsp;специальные&nbsp;эффекты<br>
;;при&nbsp;показе&nbsp;или&nbsp;сокрытии&nbsp;окон.&nbsp;Имеются&nbsp;четыре&nbsp;типа&nbsp;мультипликации:<br>
;;ролик,&nbsp;слайд,&nbsp;свертывание&nbsp;или&nbsp;развертывание&nbsp;и&nbsp;плавное&nbsp;альфа-перетекание.<br>
<br>
;;Синтаксис:<br>
;;function&nbsp;AnimateWindow(hwnd:&nbsp;HWND,&nbsp;dwTime:&nbsp;DWord,&nbsp;dwFlags:&nbsp;DWord);<br>
<br>
;;Параметры:<br>
;;hwnd&nbsp;-&nbsp;Дескриптор&nbsp;окна,&nbsp;которое&nbsp;анимируется.&nbsp;Вызывающий&nbsp;поток&nbsp;должен&nbsp;владеть&nbsp;этим&nbsp;окном.<br>
;;dwTime&nbsp;-&nbsp;Устанавливает,&nbsp;сколько&nbsp;необходимо&nbsp;времени,&nbsp;чтобы&nbsp;воспроизвести&nbsp;мультипликацию,&nbsp;в&nbsp;миллисекундах.&nbsp;Как&nbsp;правило,&nbsp;воспроизведение&nbsp;мультипликации&nbsp;занимает&nbsp;200&nbsp;миллисекунд.<br>
;;dwFlags&nbsp;-&nbsp;Определяет&nbsp;тип&nbsp;мультипликации.&nbsp;Этот&nbsp;параметр&nbsp;может&nbsp;быть&nbsp;одно&nbsp;или&nbsp;несколько&nbsp;нижеследующих&nbsp;значений.&nbsp;Обратите&nbsp;внимание!&nbsp;что,&nbsp;по&nbsp;умолчанию,&nbsp;эти&nbsp;флажки&nbsp;дают&nbsp;желаемый&nbsp;результат&nbsp;при&nbsp;показе&nbsp;окна.&nbsp;Чтобы&nbsp;получать&nbsp;желаемый&nbsp;результат&nbsp;при&nbsp;сокрытии&nbsp;окна,&nbsp;используйте&nbsp;флажок&nbsp;AW_HIDE&nbsp;и&nbsp;логический&nbsp;оператор&nbsp;OR&nbsp;с&nbsp;соответствующими&nbsp;флажками.<br>
;;AW_SLIDE&nbsp;Использует&nbsp;слайдовую&nbsp;анимацию.&nbsp;По&nbsp;умолчанию&nbsp;используется&nbsp;анимационный&nbsp;ролик&nbsp;(прокрутка&nbsp;мультипликации).&nbsp;Этот&nbsp;флажок&nbsp;игнорируется&nbsp;тогда,&nbsp;когда&nbsp;пользуется&nbsp;с&nbsp;флажком&nbsp;AW_CENTER.<br>
;;AW_ACTIVATE&nbsp;Активизирует&nbsp;окно&nbsp;(при&nbsp;показе&nbsp;окна).&nbsp;Не&nbsp;используйте&nbsp;это&nbsp;значение&nbsp;совместно&nbsp;с&nbsp;AW_HIDE.<br>
;;AW_BLEND&nbsp;Использует&nbsp;эффект&nbsp;постепенного&nbsp;изменения&nbsp;прозрачности&nbsp;окна.&nbsp;Этот&nbsp;флажок&nbsp;может&nbsp;быть&nbsp;использован&nbsp;только&nbsp;в&nbsp;том&nbsp;случае,&nbsp;если&nbsp;параметр&nbsp;hwnd&nbsp;-&nbsp;окно&nbsp;верхнего&nbsp;уровня.<br>
;;AW_HIDE&nbsp;Скрывает&nbsp;окно.&nbsp;По&nbsp;умолчанию,&nbsp;окно&nbsp;показывается&nbsp;на&nbsp;экран.<br>
;;AW_CENTER&nbsp;Делает&nbsp;вид&nbsp;окна&nbsp;сжатым&nbsp;в&nbsp;точку,&nbsp;если&nbsp;используется&nbsp;флажок&nbsp;AW_HIDE&nbsp;или&nbsp;раскрытым&nbsp;из&nbsp;точки&nbsp;до&nbsp;полного&nbsp;размера,&nbsp;если&nbsp;флажок&nbsp;AW_HIDE&nbsp;не&nbsp;используется.&nbsp;Различные&nbsp;предписывающие&nbsp;флаги&nbsp;не&nbsp;имеют&nbsp;никакого&nbsp;действия.<br>
;;AW_HOR_POSITIVE&nbsp;Анимирует&nbsp;окно&nbsp;слева&nbsp;направо.&nbsp;Этот&nbsp;флажок&nbsp;может&nbsp;быть&nbsp;использован&nbsp;с&nbsp;роликом&nbsp;или&nbsp;слайдом&nbsp;мультипликации.&nbsp;Он&nbsp;игнорируется,&nbsp;когда&nbsp;используется&nbsp;с&nbsp;флажком&nbsp;AW_CENTER&nbsp;или&nbsp;AW_BLEND.<br>
;;AW_HOR_NEGATIVE&nbsp;Анимирует&nbsp;окно&nbsp;справа&nbsp;налево.&nbsp;Этот&nbsp;флажок&nbsp;может&nbsp;быть&nbsp;использован&nbsp;с&nbsp;роликом&nbsp;или&nbsp;слайдом&nbsp;мультипликации.&nbsp;Он&nbsp;игнорируется,&nbsp;когда&nbsp;используется&nbsp;с&nbsp;флажком&nbsp;AW_CENTER&nbsp;или&nbsp;AW_BLEND.<br>
;;AW_VER_POSITIVE&nbsp;Анимирует&nbsp;окно&nbsp;сверху&nbsp;вниз.&nbsp;Этот&nbsp;флажок&nbsp;может&nbsp;быть&nbsp;использованы&nbsp;с&nbsp;роликом&nbsp;или&nbsp;слайдом&nbsp;мультипликации.&nbsp;Он&nbsp;игнорируется,&nbsp;когда&nbsp;используется&nbsp;с&nbsp;флажком&nbsp;AW_CENTER&nbsp;или&nbsp;AW_BLEND.<br>
;;AW_VER_NEGATIVE&nbsp;Анимирует&nbsp;окно&nbsp;снизу&nbsp;вверх.&nbsp;Этот&nbsp;флажок&nbsp;может&nbsp;быть&nbsp;использован&nbsp;с&nbsp;роликом&nbsp;или&nbsp;слайдом&nbsp;мультипликации.&nbsp;Он&nbsp;игнорируется,&nbsp;когда&nbsp;используется&nbsp;с&nbsp;флажком&nbsp;AW_CENTER&nbsp;или&nbsp;AW_BLEND.<br>
<br>
;;Возвращаемые&nbsp;значения:<br>
;;Если&nbsp;функция&nbsp;завершается&nbsp;успешно,&nbsp;величина&nbsp;возвращаемого&nbsp;значения&nbsp;-&nbsp;не&nbsp;ноль.<br>
;;Если&nbsp;функция&nbsp;завершается&nbsp;с&nbsp;ошибкой,&nbsp;величина&nbsp;возвращаемого&nbsp;значения&nbsp;-&nbsp;ноль.<br>
;;Функция&nbsp;завершится&nbsp;ошибкой&nbsp;в&nbsp;нижеследующих&nbsp;ситуациях:&nbsp;Если&nbsp;окно&nbsp;использует&nbsp;регион&nbsp;окна.<br>
;;Windows&nbsp;XP:&nbsp;Это&nbsp;обстоятельство&nbsp;не&nbsp;заставляет&nbsp;функцию&nbsp;завершаться&nbsp;ошибкой.<br>
;;Если&nbsp;окно&nbsp;уже&nbsp;видимое,&nbsp;и&nbsp;Вы&nbsp;пробуете&nbsp;выводить&nbsp;на&nbsp;экран&nbsp;окно.<br>
;;Если&nbsp;окно&nbsp;уже&nbsp;скрытое,&nbsp;и&nbsp;Вы&nbsp;пробуете&nbsp;скрыть&nbsp;окно.<br>
;;Если&nbsp;нет&nbsp;заданного&nbsp;направления&nbsp;прокрутки&nbsp;для&nbsp;слайда&nbsp;или&nbsp;ролика.<br>
;;При&nbsp;попытке&nbsp;анимировать&nbsp;дочернее&nbsp;окно&nbsp;с&nbsp;флажком&nbsp;AW_BLEND.&nbsp;Если&nbsp;поток&nbsp;не&nbsp;владеет&nbsp;окном.<br>
;;Обратите&nbsp;внимание!&nbsp;что,&nbsp;в&nbsp;этом&nbsp;случае&nbsp;функция&nbsp;AnimateWindow&nbsp;завершается&nbsp;ошибкой,<br>
;;а&nbsp;GetLastError&nbsp;возвращает&nbsp;значение&nbsp;ERROR_SUCCESS.<br>
;;Чтобы&nbsp;получать&nbsp;расширенные&nbsp;данные&nbsp;об&nbsp;ошибках,&nbsp;вызовите&nbsp;функцию&nbsp;GetLastError.<br>
<br>
;;Замечания:<br>
;;При&nbsp;использовании&nbsp;слайда&nbsp;или&nbsp;прокрутки&nbsp;мультипликации,&nbsp;Вы&nbsp;должны&nbsp;задать&nbsp;направление.<br>
;;Это&nbsp;может&nbsp;быть&nbsp;или&nbsp;AW_HOR_POSITIVE,&nbsp;AW_HOR_NEGATIVE,&nbsp;AW_VER_POSITIVE,&nbsp;или&nbsp;AW_VER_NEGATIVE.<br>
;;Вы&nbsp;можете&nbsp;комбинировать&nbsp;флажки&nbsp;AW_HOR_POSITIVE&nbsp;или&nbsp;AW_HOR_NEGATIVE&nbsp;с&nbsp;AW_VER_POSITIVE&nbsp;или&nbsp;AW_VER_NEGATIVE,<br>
;;чтобы&nbsp;анимировать&nbsp;окно&nbsp;по&nbsp;диагонали.<br>
;;Оконные&nbsp;процедуры&nbsp;для&nbsp;окна&nbsp;и&nbsp;его&nbsp;дочерних&nbsp;окон&nbsp;должны&nbsp;обрабатывать&nbsp;любое&nbsp;сообщение&nbsp;WM_PRINT&nbsp;или&nbsp;WM_PRINTCLIENT.<br>
;;Диалоговые&nbsp;окна,&nbsp;органы&nbsp;управления&nbsp;и&nbsp;стандартные&nbsp;органы&nbsp;управления&nbsp;уже&nbsp;обрабатывают&nbsp;WM_PRINTCLIENT.<br>
;;Заданная&nbsp;по&nbsp;умолчанию&nbsp;оконная&nbsp;процедура&nbsp;уже&nbsp;обрабатывает&nbsp;WM_PRINT.<br>
;;Если&nbsp;дочернее&nbsp;окно&nbsp;отображается&nbsp;частично&nbsp;отсеченным,&nbsp;когда&nbsp;оно&nbsp;анимируется,&nbsp;то&nbsp;будет&nbsp;иметь&nbsp;дырки,&nbsp;где&nbsp;оно&nbsp;отсечено.<br>
;;AnimateWindow&nbsp;поддерживает&nbsp;окна&nbsp;RTL.<br>
;;Избегайте&nbsp;анимировать&nbsp;окно,&nbsp;которое&nbsp;имеет&nbsp;тень,&nbsp;потому&nbsp;что&nbsp;оно&nbsp;производит&nbsp;видимое&nbsp;спонтанное&nbsp;дерганье&nbsp;мультипликации.<br>
<br>
;;######################################################################################################################<br>
<br>
[Setup]<br>
&nbsp;AppName=My&nbsp;Program<br>
&nbsp;AppVerName=My&nbsp;Program<br>
&nbsp;DefaultDirName={pf}\My&nbsp;Program<br>
&nbsp;OutputDir=userdocs:InnoSetupTest.<br>
<br>
[Code]<br>
const<br>
&nbsp;&nbsp;AW_ACTIVATE&nbsp;=&nbsp;$00020000;<br>
&nbsp;&nbsp;AW_BLEND&nbsp;=&nbsp;$00080000;<br>
&nbsp;&nbsp;AW_CENTER&nbsp;=&nbsp;$00000010;<br>
&nbsp;&nbsp;AW_HIDE&nbsp;=&nbsp;$00010000;<br>
&nbsp;&nbsp;AW_HOR_POSITIVE&nbsp;=&nbsp;$00000001;<br>
&nbsp;&nbsp;AW_HOR_NEGATIVE&nbsp;=&nbsp;$00000002;<br>
&nbsp;&nbsp;AW_SLIDE&nbsp;=&nbsp;$00040000;<br>
&nbsp;&nbsp;AW_VER_POSITIVE&nbsp;=&nbsp;$00000004;<br>
&nbsp;&nbsp;AW_VER_NEGATIVE&nbsp;=&nbsp;$00000008;<br>
&nbsp;&nbsp;AW_FADE_IN&nbsp;=&nbsp;$00080000;<br>
&nbsp;&nbsp;AW_FADE_OUT&nbsp;=&nbsp;$00090000;<br>
&nbsp;&nbsp;AW_SLIDE_IN_LEFT&nbsp;=&nbsp;$00040001;<br>
&nbsp;&nbsp;AW_SLIDE_OUT_LEFT&nbsp;=&nbsp;$00050002;<br>
&nbsp;&nbsp;AW_SLIDE_IN_RIGHT&nbsp;=&nbsp;$00040002;<br>
&nbsp;&nbsp;AW_SLIDE_OUT_RIGHT&nbsp;=&nbsp;$00050001;<br>
&nbsp;&nbsp;AW_SLIDE_IN_TOP&nbsp;=&nbsp;$00040004;<br>
&nbsp;&nbsp;AW_SLIDE_OUT_TOP&nbsp;=&nbsp;$00050008;<br>
&nbsp;&nbsp;AW_SLIDE_IN_BOTTOM&nbsp;=&nbsp;$00040008;<br>
&nbsp;&nbsp;AW_SLIDE_OUT_BOTTOM&nbsp;=&nbsp;$00050004;<br>
&nbsp;&nbsp;AW_DIAG_SLIDE_IN_TOPLEFT&nbsp;=&nbsp;$00040005;<br>
&nbsp;&nbsp;AW_DIAG_SLIDE_OUT_TOPLEFT&nbsp;=&nbsp;$0005000a;<br>
&nbsp;&nbsp;AW_DIAG_SLIDE_IN_TOPRIGHT&nbsp;=&nbsp;$00040006;<br>
&nbsp;&nbsp;AW_DIAG_SLIDE_OUT_TOPRIGHT&nbsp;=&nbsp;$00050009;<br>
&nbsp;&nbsp;AW_DIAG_SLIDE_IN_BOTTOMLEFT&nbsp;=&nbsp;$00040009;<br>
&nbsp;&nbsp;AW_DIAG_SLIDE_OUT_BOTTOMLEFT&nbsp;=&nbsp;$00050006;<br>
&nbsp;&nbsp;AW_DIAG_SLIDE_IN_BOTTOMRIGHT&nbsp;=&nbsp;$0004000a;<br>
&nbsp;&nbsp;AW_DIAG_SLIDE_OUT_BOTTOMRIGHT&nbsp;=&nbsp;$00050005;<br>
&nbsp;&nbsp;AW_EXPLODE&nbsp;=&nbsp;$00040010;<br>
&nbsp;&nbsp;AW_IMPLODE&nbsp;=&nbsp;$00050010;<br>
<br>
function&nbsp;AnimateWindow(hWnd:&nbsp;HWND;&nbsp;dwTime:&nbsp;DWORD;&nbsp;dwFlags:&nbsp;DWORD):&nbsp;Boolean;<br>
&nbsp;&nbsp;external&nbsp;'AnimateWindow@user32&nbsp;stdcall';<br>
<br>
procedure&nbsp;InitializeWizard;<br>
begin<br>
&nbsp;&nbsp;AnimateWindow(WizardForm.Handle,&nbsp;1000,&nbsp;AW_SLIDE_IN_LEFT);<br>
end;<br>
</font></blockquote><textarea id="taCode1" style="display:none;" rows="1" cols="5"></textarea><textarea id='taCode' style='display:none;' rows='1' cols='20'></textarea></code><script language="javascript" type="text/javascript">highlightSyntax('delphi_Tc4NTM','delphi');</script><br><div id="heading"><h1><font size="1" face="Consolas">Copyright (c) <a href="http://www.krinkels.org/" target="_blank">Krinkels Inc</a></font></h1></div></body></html>