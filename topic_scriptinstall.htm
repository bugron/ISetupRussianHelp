<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=8" />
<title>Pascal Scripting: Параметры BeforeInstall и AfterInstall</title>
<!--[if IE 6]><style type="text/css">html{overflow-y:scroll}</style><![endif]-->
<link rel="stylesheet" type="text/css" href="styles.css" />
<script type="text/javascript" src="topic.js"></script>
</head>
<body>
<h1 class="topicheading">Pascal Scripting: Параметры BeforeInstall и AfterInstall</h1>
<div class="topicbody">
  <p>Существует два необязательных <a href="topic_params.htm">параметра</a>, поддерживаемые всеми секциями, содержащими параметры, кроме секций [Languages], [Types], [Components] и [Tasks]. Это:</p>
  <dl>
    <dt class="paramlist"><b><a name="BeforeInstall" id="BeforeInstall">BeforeInstall</a></b></dt>
    <dd class="paramlist">
      <p>Имя функции, которая будет вызываться один раз перед установкой параметра. Эта функция может быть описана в секции [Code], или может быть <a href="topic_scriptfunctions.htm">встроенной функцией</a>.</p>
      <p>Может содержать список параметров, разделенных запятыми, которые инсталлятор должен предоставить функции. Допустимые типы параметров: строковый (String), целочисленный (Integer) и логический (Boolean). Строковые параметры могут содержать константы. These constants will not be automatically expanded. If you want to pass an expanded constant, существует одна <a href="topic_scriptfunctions.htm">встроенная функция</a>, которую можно добавлять в список параметров: это <tt>ExpandConstant</tt>.</p>
      <div class="examplebox">
        <div class="exampleheader">Например:</div>
        <pre class="nomargin">[Files]
Source: &quot;MYPROG.EXE&quot;; DestDir: &quot;{app}&quot;; BeforeInstall: MyBeforeInstall
Source: &quot;A\MYFILE.TXT&quot;; DestDir: &quot;{app}&quot;; BeforeInstall: MyBeforeInstall2('{app}\A\MYFILE.TXT')
Source: &quot;B\MYFILE.TXT&quot;; DestDir: &quot;{app}&quot;; BeforeInstall: MyBeforeInstall2('{app}\B\MYFILE.TXT')
Source: &quot;MYPROG.CHM&quot;; DestDir: &quot;{app}&quot;; BeforeInstall: Log('Before MYPROG.CHM Install')</pre>
      </div>
    </dd>
    <dt class="paramlist"><b><a name="AfterInstall" id="AfterInstall">AfterInstall</a></b></dt>
    <dd class="paramlist">
      <p>Имя функции, которая будет вызываться один раз после установки параметра. Эта функция может быть описана в секции [Code], или может быть <a href="topic_scriptfunctions.htm">встроенной функцией</a>.</p>
      <p>Может содержать список параметров, разделенных запятыми, которые инсталлятор должен предоставить функции. Допустимые типы параметров: строковый (String), целочисленный (Integer) и логический (Boolean). Строковые параметры могут содержать константы. These constants will not be automatically expanded. If you want to pass an expanded constant, существует одна <a href="topic_scriptfunctions.htm">встроенная функция</a>, которую можно добавлять в список параметров: это <tt>ExpandConstant</tt>.</p>
      <div class="examplebox">
        <div class="exampleheader">Например:</div>
        <pre class="nomargin">[Files]
Source: &quot;MYPROG.EXE&quot;; DestDir: &quot;{app}&quot;; AfterInstall: MyAfterInstall
Source: &quot;A\MYFILE.TXT&quot;; DestDir: &quot;{app}&quot;; AfterInstall: MyAfterInstall2('{app}\A\MYFILE.TXT')
Source: &quot;B\MYFILE.TXT&quot;; DestDir: &quot;{app}&quot;; AfterInstall: MyAfterInstall2('{app}\B\MYFILE.TXT')
Source: &quot;MYPROG.CHM&quot;; DestDir: &quot;{app}&quot;; AfterInstall: Log('After MYPROG.CHM Install')</pre>
      </div>
    </dd>
  </dl>
  <p>Функции <tt>BeforeInstall</tt> и <tt>AfterInstall</tt> не должны возвращать ничего.</p>
  <p>Функции <tt>BeforeInstall</tt> или <tt>AfterInstall</tt> не вызываются, если инсталлятор определил, что не будет обработать параметр.</p>
  <p>Функции <tt>BeforeInstall</tt> или <tt>AfterInstall</tt> вызываются однажды для каждого файла секции [Files], совподающего с <span id="result_box" lang="ru" xml:lang="ru">подстановочным знак</span>ом. Используйте <tt>CurrentFileName</tt>, чтобы проверить для какого файла была вызвана функция.</p>
  <p>Вот пример секции <tt>[Code]</tt>, содержащей функции BeforeInstall и AfterInstall. Функции <tt>CurrentFileName</tt> и <tt>Log</tt> являются <a href="topic_scriptfunctions.htm">встроенными функциями</a>, поэтому не описаны в секции [Code].</p>
  <pre class="indent examplebox">
[Code]
procedure MyBeforeInstall();
begin
  MsgBox('About to install MyProg.exe as ' + CurrentFileName + '.', mbInformation, MB_OK);
end;

procedure MyBeforeInstall2(FileName: String);
begin
  MsgBox('About to install ' + FileName + ' as ' + CurrentFileName + '.', mbInformation, MB_OK);
end;

procedure MyAfterInstall();
begin
  MsgBox('Just installed MyProg.exe as ' + CurrentFileName + '.', mbInformation, MB_OK);
end;

procedure MyAfterInstall2(FileName: String);
begin
  MsgBox('Just installed ' + FileName + ' as ' + CurrentFileName + '.', mbInformation, MB_OK);
end;
</pre>
</div>
</body>
</html>
