<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Использование скинов</title><link rel="stylesheet" type="text/css" href="css.css"><script type="text/javascript" src="includer.js"></script><script language='jscript' type='text/javascript' src='copycode.js'></script></head><body><div id="heading"><h1>» Inno Setup Faq. Пример использования визуальных стилей (скинов)</h1></div><br><font face="Consolas">Способ 1: Инсталлятор + деинсталлятор</font><br><script language="javascript" type="text/javascript">includeSyntax('delphi');</script><code id="delphi_Tc4NTM">
<input type="button" value="Копировать в буфер обмена" onClick="copyToClipboard( taCode1, theCode1 );">
<blockquote id="theCode1"><font>[Setup]<br>AppName=My prog<br>AppVerName=My prog<br>DefaultDirName={pf}\My prog<br><br>[Files]<br>Source: ISSkinEx.dll; DestDir: {app}; Flags: ignoreversion<br>Source: ISSkinEx.cjstyles; DestDir: {app}; Flags: ignoreversion<br><br>[Code]<br>procedure LoadSkin(lpszPath: string; lpszIniFileName: string );<br>&nbsp; external 'LoadSkin@files:isskinex.dll stdcall delayload setuponly';<br><br>procedure LoadSkinUninst(lpszPath: string; lpszIniFileName: string );<br>&nbsp; external 'LoadSkin@{tmp}\isskinex.dll stdcall delayload uninstallonly';<br><br>procedure UnloadSkin();<br>&nbsp; external 'UnloadSkin@files:isskinex.dll stdcall delayload setuponly';<br><br>procedure UnloadSkinUninst();<br>&nbsp; external 'UnloadSkin@{tmp}\isskinex.dll stdcall delayload uninstallonly';<br><br>function ShowWindow(hWnd: Integer; uType: Integer): Integer;<br>&nbsp; external 'ShowWindow@user32.dll stdcall';<br><br>function InitializeSetup(): Boolean;<br>begin<br>&nbsp; ExtractTemporaryFile('ISSkinEx.cjstyles');<br>&nbsp; LoadSkin(ExpandConstant('{tmp}\ISSkinEx.cjstyles'), '');<br>&nbsp; Result := True;<br>end;<br><br>function InitializeUninstall(): Boolean;<br>begin<br>&nbsp; FileCopy(ExpandConstant('{app}\isskinex.dll'), ExpandConstant('{tmp}\isskinex.dll'), True);<br>&nbsp; FileCopy(ExpandConstant('{app}\ISSkinEx.cjstyles'), ExpandConstant('{tmp}\ISSkinEx.cjstyles'), True);<br>&nbsp; LoadSkinUninst(ExpandConstant('{tmp}\ISSkinEx.cjstyles'), '');<br>&nbsp; Result := True;<br>end;<br><br>
procedure DeinitializeSetup();<br>
begin<br>
 ShowWindow(StrToInt(ExpandConstant('{wizardhwnd}')), 0);<br>
 Sleep(110);<br>
 UnloadSkin();<br>
end;<br>
<br>procedure DeinitializeUninstall();<br>begin<br>&nbsp; UnloadSkinUninst();<br>end;</font></blockquote><textarea id="taCode1" style="display:none;" rows="1" cols="5"></textarea><textarea id='taCode' style='display:none;' rows='1' cols='20'></textarea></code><script language="javascript" type="text/javascript">highlightSyntax('delphi_Tc4NTM','delphi');</script>

<br>Способ 2: Только инсталлятор<br>
<input type="button" value="Копировать в буфер обмена" onClick="copyToClipboard( taCode2, theCode2 );">
<blockquote id="theCode2"><font><script language="javascript" type="text/javascript">includeSyntax('delphi');</script><code id="delphi_Tc4NTN">[Setup]<br>AppName=My prog<br>AppVerName=My prog<br>DefaultDirName={pf}\My prog<br><br>[Files]<br>Source: ISSkinEx.dll; DestDir: {app}; Flags: ignoreversion<br>Source: ISSkinEx.cjstyles; DestDir: {app}; Flags: ignoreversion<br><br>[Code]<br>procedure LoadSkin(lpszPath: string; lpszIniFileName: string );<br>&nbsp; external 'LoadSkin@files:isskinex.dll stdcall delayload setuponly';<br><br>procedure UnloadSkin();<br>&nbsp; external 'UnloadSkin@files:isskinex.dll stdcall delayload setuponly';<br><br>function ShowWindow(hWnd: Integer; uType: Integer): Integer;<br>&nbsp; external 'ShowWindow@user32.dll stdcall';<br><br>function InitializeSetup(): Boolean;<br>begin<br>&nbsp; ExtractTemporaryFile('ISSkinEx.cjstyles');<br>&nbsp; LoadSkin(ExpandConstant('{tmp}\ISSkinEx.cjstyles'), '');<br>&nbsp; Result := True;<br>end;<br><br>
procedure DeinitializeSetup();<br>
begin<br>
 ShowWindow(StrToInt(ExpandConstant('{wizardhwnd}')), 0);<br>
 Sleep(110);<br>
 UnloadSkin();<br>
end;<br><script language="javascript" type="text/javascript">highlightSyntax('delphi_Tc4NTN','delphi');</script></code></font></blockquote><code id="delphi_Tc4NTN"><textarea id="taCode2" style="display:none;" rows="1" cols="5"></textarea><textarea id='taCode' style='display:none;' rows='1' cols='20'></textarea></code><br><div id="heading"><h1><font size="1" face="Consolas">Copyright (c) <a href="http://www.krinkels.org/" target="_blank">Krinkels Inc</a></font></h1></div></body></html>