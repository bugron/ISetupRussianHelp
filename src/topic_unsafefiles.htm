<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251" />
<meta http-equiv="X-UA-Compatible" content="IE=8" />
<title>Ненадежные файлы</title>
<!--[if IE 6]><style type="text/css">html{overflow-y:scroll}</style><![endif]-->
<link rel="stylesheet" type="text/css" href="styles.css" />
<script type="text/javascript" src="topic.js"></script>
</head>
<body>
<h1 class="topicheading">Ненадежные файлы</h1>
<div class="topicbody">
  <p>Для удобства неопытных пользователей, точно не уверенных в том, какие файлы следует, а какие не следует добавлять в дистрибутив программы, компилятор выдаст сообщение об ошибке при попытке установки так называемых &quot;ненадежных&quot; файлов <a href="topic_filessection.htm">секцией [Files]</a>. Эти файлы описаны ниже.</p>
  <p>(Есть возможность отключить выдачу сообщений об ошибках, используя соответствующий флаг для параметра секции [Files], но это делать НЕ рекомендуется).</p>
  <dl>
    <dt><b>Любой DLL файл системной папки Windows.</b></dt>
    <dd>
      <p>Не следует использовать собственные файлы DLL системной папки Windows, т.к. большинство из них используются только одной версией Windows, и при установке на другую версию работать не будут. В большинстве случаев при установке DLL другой версии Windows, система пользователя <b>перестанет загружаться</b>. Также при установке программ на компьютер файлы DLL могут быть заменены несовместимыми/различными версиями, и если вы этого не заметите и не отреагируете, это также может привести к проблемам с системой пользователя при создании новой инсталляции.</p>
      <p>Вместо использования DLL системной папки Windows, можно найти версии, которые являются &quot;общими&quot;. Общие DLL чаще всего работают на нескольких версиях Windows. Для того, чтобы найти общие версии run-time DLL для Visual Basic и Visual C++, обратитесь к Inno Setup FAQ.</p>
      <p>Если вы <b>абсолютно уверены</b> в том, что DLL из системной папки Windows является общим, скопируйте его в папку скрипта и используйте его только оттуда.</p>
    </dd>
    <dt><b>ADVAPI32.DLL, COMDLG32.DLL, GDI32.DLL, KERNEL32.DLL, RICHED32.DLL, SHELL32.DLL, USER32.DLL, UXTHEME.DLL</b></dt>
    <dd>
      <p>Это компоненты ядра Windows, которые не могут использоваться инсталлятором. Пользователь может получить новую версию этих DLL только при установке новой версии Windows, service pack'a или hotfix'a Windows.</p>
    </dd>
    <dt><i>(Для особых случаев)</i> <b>COMCAT.DLL, MSVBVM50.DLL, MSVBVM60.DLL, OLEAUT32.DLL, OLEPRO32.DLL, STDOLE2.TLB</b></dt>
    <dd>
      <p>Если директива <tt>DestDir</tt> имеет значение не равное <tt>{sys}</tt> и используются флаги <tt>regserver</tt> или <tt>regtypelib</tt>, перечисленные файлы будут считаться &quot;ненадежными&quot;. Эти файлы могут использоваться только для директории <tt>{sys}</tt>, т.к. все программы в системе могут начать использовать их по умолчанию вместо файлов в <tt>{sys}</tt>. Проблемы могут возникнуть, если копируемые файлы будут старше уже установленных в папке <tt>{sys}</tt>. Также если копируемые файлы были удалены, другие приложения перестанут работать.</p>
    </dd>
    <dt><b>COMCTL32.DLL</b></dt>
    <dd>
      <p>Microsoft не создает отдельный общий COMCTL32.DLL (и правильно делает - файлы для различных платформ различные), так что помещать COMCTL32.DLL в секцию [Files] нельзя. Однако, можно напрямую <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=cb2cf3a2-8025-4e8f-8511-9b476a8d35d2&amp;DisplayLang=en" target="_blank" title="http://www.microsoft.com/downloads/details.aspx?FamilyID=cb2cf3a2-8025-4e8f-8511-9b476a8d35d2&amp;DisplayLang=en">загрузить обновленный COMCTL32 на сайте Microsoft</a><img src="images/extlink.gif" alt=" [external link]" /> или добавить обновление (апдейт) COMCTL32 к вашей программе отдельно.</p>
    </dd>
    <dt><b>SHDOCVW.DLL, SHLWAPI.DLL, URLMON.DLL, WININET.DLL</b></dt>
    <dd>
      <p>Это компоненты ядра Internet Explorer, также используемые Проводником Windows. Их удаление будет мешать запуску обозревателей. Если ваше приложение напрямую зависит от этих DLL или от более новых их версий, пользователю придется установить более новую версию Internet Explorer.</p>
    </dd>
    <dt><b>MSCOREE.DLL</b></dt>
    <dd>
      <p>Этот файл является частью Microsoft .NET Framework. Невозможно безопасно установить или обновить .NET Framework при наличии этого файла с Вашем инсталляторе. Вместо этого вызовите или направьте своих пользователей к dotnetfx.exe.</p>
    </dd>
  </dl>
</div>
</body>
</html>
