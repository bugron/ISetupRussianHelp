<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Autorun</title><link rel="stylesheet" type="text/css" href="css.css"><script type="text/javascript" src="includer.js"></script><script language='jscript' type='text/javascript' src='copycode.js'></script></head><body><div id="heading"><h1>» Inno Setup Faq. Autorun</h1></div><br><script language="javascript" type="text/javascript">includeSyntax('delphi');</script><code id="delphi_Tc4NTM"> <input type="button" value="Копировать в буфер обмена" onClick="copyToClipboard( taCode1, theCode1 );"> <blockquote id="theCode1"><font>[Setup]<br>AppName=AutoRUN<br>VersionInfoDescription=AutoRUN<br>VersionInfoProductName=AutoRUN<br>AppVerName=AutoRUN<br>VersionInfoProductVersion=1.0.0.0<br>VersionInfoVersion=1.0.0.0<br>VersionInfoCompany=john<br>VersionInfoCopyright=Copyright © John<br>CreateAppDir=no<br>OutputDir=.<br>OutputBaseFilename=Autorun<br>SetupIconFile=Icon.ico<br><br>[Languages]<br>Name: Russian; MessagesFile: compiler:Default.isl<br><br>[Files]<br>Source: 1.bmp; Flags: dontcopy<br><br>[Messages]<br>SetupAppTitle=AutoRUN<br><br>[Code]<br>const<br>&nbsp; BM_CLICK&nbsp; &nbsp; = $00F5;<br><br>var<br>&nbsp; AutoRun: TSetupForm;<br>&nbsp; img1: TBitmapImage;<br>&nbsp; PlayButton, InstallButton, SupportButton, ReadmeButton, WebButton, ExitButton, UninstallButton: TButton;<br>&nbsp; AppPath,UninsPath: string;<br>&nbsp; ResultCode: Integer;<br>procedure CurPageChanged(CurPageID: Integer);<br>begin<br>&nbsp; If CurPageID=wpWelcome then<br>&nbsp; SendMessage(WizardForm.NextButton.Handle, BM_CLICK, 0, 0);<br>end;<br><br>procedure CancelButtonClick(CurPageID: Integer; var Cancel, Confirm: Boolean);<br>begin<br>Confirm:=False<br>Cancel:=True<br>end;<br><br>procedure PlayButtonClick(Sender: TObject);<br>var<br>&nbsp; exe: string;<br>begin<br>&nbsp; exe:='shift.exe';<br>&nbsp; if RegQueryStringValue(HKLM, 'SOFTWARE\Electronic Arts\Game','Install Dir', AppPath) then<br>&nbsp; begin<br>&nbsp; &nbsp; Exec(AddBackslash(AppPath) + Exe, '', ExtractFilePath(AddBackslash(AppPath) + Exe), SW_SHOWNORMAL,ewNoWait,ResultCode)<br>&nbsp; AutoRun.Close;<br>&nbsp; PostMessage(WizardForm.CancelButton.Handle, BM_CLICK, 0, 0);<br>&nbsp; end<br>end;<br><br>procedure InstallButtonClick(Sender: TObject);<br>var<br>&nbsp; CurPageID: Integer;<br>begin<br>&nbsp; Exec(ExpandConstant('{src}\Setup.exe'),'','',SW_SHOW,ewNoWait,ResultCode)<br>&nbsp; AutoRun.Close;<br>&nbsp; PostMessage(WizardForm.CancelButton.Handle, BM_CLICK, 0, 0);<br>end;<br><br>procedure SupportButtonClick(Sender: TObject);<br>begin<br>&nbsp; shellexec('open', ExpandConstant('{src}\Game.exe'), '', '',SW_SHOWNORMAL, ewnowait, ResultCode)<br>end;<br><br>procedure ReadmeButtonClick(Sender: TObject);<br>begin<br>&nbsp; ShellExec('open', ExpandConstant('{src}\readme.txt'),'','', SW_SHOW, ewNoWait, ResultCode)<br>end;<br><br>procedure WebButtonClick(Sender: TObject);<br>begin<br>&nbsp; shellexec('open', 'http://localhost', '', '',SW_SHOWNORMAL, ewnowait, ResultCode)<br>end;<br><br>procedure ExitButtonClick(Sender: TObject);<br>var<br>&nbsp; CurPageID: Integer;<br>begin<br>&nbsp; AutoRun.Close;<br>&nbsp; PostMessage(WizardForm.CancelButton.Handle, BM_CLICK, 0, 0);<br>end;<br><br>procedure UninstallButtonClick(Sender: TObject);<br>begin<br>if RegQueryStringValue(HKLM, 'SOFTWARE\Game','UninstallString', UninsPath) then<br>&nbsp; begin<br>&nbsp; &nbsp; UninsPath:=RemoveQuotes(UninsPath)<br>&nbsp; &nbsp; Exec(UninsPath,'','',SW_SHOWNORMAL,ewNoWait,ResultCode)<br>&nbsp; &nbsp; AutoRun.Close;<br>&nbsp; &nbsp; PostMessage(WizardForm.CancelButton.Handle, BM_CLICK, 0, 0);<br>&nbsp; end<br>end;<br><br>procedure CreateAutoRun;<br>begin<br>&nbsp; ///AutoRun<br>&nbsp; AutoRun := CreateCustomForm;<br>&nbsp; with AutoRun do begin<br>&nbsp; &nbsp; Left := 498;<br>&nbsp; &nbsp; Top := 75;<br>&nbsp; &nbsp; Width := 495;<br>&nbsp; &nbsp; Height := 340;<br>&nbsp; &nbsp; BorderIcons := [];<br>&nbsp; &nbsp; BorderStyle:=bsToolWindow ///(bsNone, bsSingle, bsSizeable, bsDialog, bsToolWindow, bsSizeToolWin)<br>&nbsp; &nbsp; Color := clBtnFace;<br>&nbsp; &nbsp; Font.Color := clWindowText;<br>&nbsp; &nbsp; Font.Height := -11;<br>&nbsp; &nbsp; Font.Name := 'MS Sans Serif';<br>&nbsp; &nbsp; Font.Style := [];<br>&nbsp; &nbsp; Position := poScreenCenter;<br>&nbsp; &nbsp; Caption:='AutoRUN'<br>&nbsp; end;<br>&nbsp; ///img1<br>&nbsp; img1 := TBitmapImage.Create(AutoRun);<br>&nbsp; ExtractTemporaryFile('1.bmp');<br>&nbsp; with img1 do begin<br>&nbsp; &nbsp; Parent := AutoRun;<br>&nbsp; &nbsp; Left := 0;<br>&nbsp; &nbsp; Stretch:= true;<br>&nbsp; &nbsp; Top := 0;<br>&nbsp; &nbsp; Width := Autorun.Width;<br>&nbsp; &nbsp; Height := Autorun.Height;<br>&nbsp; &nbsp; Bitmap.LoadFromFile(ExpandConstant('{tmp}\1.bmp'));<br>&nbsp; end;<br>&nbsp; ///PlayButton<br>&nbsp; PlayButton:= TButton.Create(AutoRun);<br>&nbsp; with PlayButton do begin<br>&nbsp; &nbsp; Parent := AutoRun;<br>&nbsp; &nbsp; Left := 300;<br>&nbsp; &nbsp; Top := 110;<br>&nbsp; &nbsp; Width := 150;<br>&nbsp; &nbsp; Height := 22;<br>&nbsp; &nbsp; Caption:= 'Начать игру';<br>&nbsp; &nbsp; Cursor:= crHand;<br>&nbsp; ///ModalResult:= mrOk;<br>&nbsp; &nbsp; OnClick := @PlayButtonClick;<br>&nbsp; &nbsp; if not RegQueryStringValue(HKLM, 'SOFTWARE\Game','Install Dir', AppPath) then<br>&nbsp; begin<br>&nbsp; &nbsp; PlayButton.Enabled := False;<br>&nbsp; end<br>&nbsp; end;<br>&nbsp; ///InstallButton<br>&nbsp; InstallButton:= TButton.Create(AutoRun);<br>&nbsp; with InstallButton do begin<br>&nbsp; &nbsp; Parent:= AutoRun;<br>&nbsp; &nbsp; Left := 300;<br>&nbsp; &nbsp; Top := 80;<br>&nbsp; &nbsp; Width := 150;<br>&nbsp; &nbsp; Height := 22;<br>&nbsp; &nbsp; Caption:= 'Install Game';<br>&nbsp; &nbsp; Cursor:= crHand;<br>&nbsp; &nbsp; OnClick := @InstallButtonClick;<br>&nbsp; end;<br>&nbsp; ///SupportButton<br>&nbsp; SupportButton:= TButton.Create(AutoRun);<br>&nbsp; with SupportButton do begin<br>&nbsp; &nbsp; Parent:= AutoRun;<br>&nbsp; &nbsp; Left := 300;<br>&nbsp; &nbsp; Top := 140;<br>&nbsp; &nbsp; Width := 150;<br>&nbsp; &nbsp; Height := 22;<br>&nbsp; &nbsp; Caption:= 'Инфо';<br>&nbsp; &nbsp; Cursor:= crHand;<br>&nbsp; &nbsp; OnClick := @SupportButtonClick;<br>&nbsp; end;<br>&nbsp; ///ReadmeButton<br>&nbsp; ReadmeButton:= TButton.Create(AutoRun);<br>&nbsp; with ReadmeButton do begin<br>&nbsp; &nbsp; Parent:= AutoRun;<br>&nbsp; &nbsp; Left := 300;<br>&nbsp; &nbsp; Top := 170;<br>&nbsp; &nbsp; Width := 150;<br>&nbsp; &nbsp; Height := 22;<br>&nbsp; &nbsp; Caption:= 'Readme';<br>&nbsp; &nbsp; Cursor:= crHand;<br>&nbsp; &nbsp; OnClick := @ReadmeButtonClick;<br>&nbsp; end;<br>&nbsp; ///WebButton<br>&nbsp; WebButton:= TButton.Create(AutoRun);<br>&nbsp; with WebButton do begin<br>&nbsp; &nbsp; Parent:= AutoRun;<br>&nbsp; &nbsp; Left := 300;<br>&nbsp; &nbsp; Top := 200;<br>&nbsp; &nbsp; Width := 150;<br>&nbsp; &nbsp; Height := 22;<br>&nbsp; &nbsp; Caption:= 'Веб-сайт';<br>&nbsp; &nbsp; Cursor:= crHand;<br>&nbsp; &nbsp; OnClick := @WebButtonClick;<br>&nbsp; end;<br>&nbsp; ///ExitButton<br>&nbsp; ExitButton:= TButton.Create(AutoRun);<br>&nbsp; with ExitButton do begin<br>&nbsp; &nbsp; Parent:= AutoRun;<br>&nbsp; &nbsp; Left := 300;<br>&nbsp; &nbsp; Top := 260;<br>&nbsp; &nbsp; Width := 150;<br>&nbsp; &nbsp; Height := 22;<br>&nbsp; &nbsp; Caption:= 'Выход';<br>&nbsp; &nbsp; Cursor:= crHand;<br>&nbsp; &nbsp; OnClick := @ExitButtonClick;<br>///&nbsp;ModalResult:= mrCancel;<br>&nbsp; end;<br>&nbsp; ///UninstallButton<br>&nbsp; UninstallButton:= TButton.Create(AutoRun);<br>&nbsp; with UninstallButton do begin<br>&nbsp; &nbsp; Parent:= AutoRun;<br>&nbsp; &nbsp; Left := 300;<br>&nbsp; &nbsp; Top := 230;<br>&nbsp; &nbsp; Width := 150;<br>&nbsp; &nbsp; Height := 22;<br>&nbsp; &nbsp; Caption:= 'Удалить игру';<br>&nbsp; &nbsp; Cursor:= crHand;<br>&nbsp; &nbsp; OnClick := @UninstallButtonClick;<br>&nbsp; end;<br><br>&nbsp; if not RegQueryStringValue(HKLM, 'SOFTWARE\Game','UninstallString', UninsPath) then<br>&nbsp; begin<br>&nbsp; &nbsp; InstallButton.Enabled:=true;<br>&nbsp; &nbsp; UninstallButton.Enabled:=false;<br>&nbsp; end;<br>&nbsp; if RegQueryStringValue(HKLM, 'SOFTWARE\Game','UninstallString', UninsPath) then<br>&nbsp; begin<br>&nbsp; &nbsp; InstallButton.Enabled:=false;<br>&nbsp; &nbsp; UninstallButton.Enabled:=true;<br>&nbsp; end;<br><br>&nbsp; AutoRun.ShowModal;<br>end;<br><br>procedure InitializeWizard;<br>begin<br>&nbsp; CreateAutoRun;<br>end;</font></blockquote><textarea id="taCode1" style="display:none;" rows="1" cols="5"></textarea><textarea id='taCode' style='display:none;' rows='1' cols='20'></textarea></code><script language="javascript" type="text/javascript">highlightSyntax('delphi_Tc4NTM','delphi');</script><br><div id="heading"><h1><font size="1" face="Consolas">Copyright (c) <a href="http://www.krinkels.org/" target="_blank">Krinkels Inc</a></font></h1></div></body></html>