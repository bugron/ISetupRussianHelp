<html xmlns=http://www.w3.org/1999/xhtml xml:lang=en lang=en><head><meta http-equiv=Content-Type content="text/html; charset=windows-1251" /><meta http-equiv=X-UA-Compatible content=IE=8 /><title>Inno Setup FAQ</title><style type="text/css"><!--BODY{background:#ffffff;color:#000000;font:small verdana,arial,sans-serif;}H1,.xxbig{font:bold xx-large verdana,arial,sans-serif;}H2,.xbig{font:bold x-large verdana,arial,sans-serif;}H3,.big{font:bold large verdana,arial,sans-serif;}H4,.medium{font:bold medium verdana,arial,sans-serif;}PRE,TT{font:small"courier new",monospace;}LI{margin-top:0.25em;margin-bottom:0.25em;}P,UL{margin-top:1em;margin-bottom:1em;}A:link{color:#274d99;}A:visited,A:active{color:#5a83d7;}--></style></head><body><table width=100% border=0 cellpadding=5 cellspacing=0><tr><td align=center bgcolor=#264b99><span class=xxbig><font color=#FFFFFF>Inno Setup</font></span><br /> <span class=big><font color=#FFFFFF>Часто задаваемые вопросы</font></span></td></tr></table></p><h3>Выполняемые функции</h3> <ul><li><a href=#lang>Перевод текста Inno Setup</a></li> <li><a href=#mbcs>Поддерживается ли MBCS (multi-byte character sets - многобайтовые наборы символов)?</a></li> <li><a href=#msi>Будет ли в будущем поддерживаться Windows Installer?</a></li> <li><a href=#setupicon>Как изменить иконку Setup.exe?</a></li> <li><a href=#conditional>Можно ли в Inno Setup задать установку с условием - например, чтобы установка начиналась только если в реестре присутствует некоторый ключ или определенный файл уже имеется?</a></li> <li><a href=#webinstall>Можно ли создать "установку через web" ("web install")?</a></li> <li><a href=#silent>Возможна ли быстрая и очень быстрая установка без использования параметров командной строки /SILENT или /VERYSILENT?</a></li> <li><a href=#dirnamereg>Может ли инсталятор использовать значение, взятое из реестра, в качестве имени папки по умолчанию?</a></li> </ul><h3>Проблемы</h3> <ul><li><a href=#errorquotes>Компилятор выдает сообщение: "Mismatched or misplaced quotes on parameter" ("Лишние кавычки у параметра").</a></li> <li><a href=#workingdir>Мое приложение не находит файлы по ярлыкам, созданным инсталятором. Но запускается при двойном щелчке на ЕХЕ-файле приложения в Проводнике.</a></li> <li><a href=#appid>При установке новой версии приложения поверх старой, в <i>Установка и удаление программ</i> панели управления создается новая запись..</a></li> <li><a href=#corrupt>Почему на некоторых системах появляется сообщение об ошибке "The setup files are corrupted" ("Файлы инсталятора повреждены")?</a></li> <li><a href=#noregserver>Инсталятор выдает сообщение "Unable to register the DLL/OCX: DllRegisterServer export not found" ("Невозможно зарегистрировать DLL/OCX: DllRegisterServer не найден").</a></li> <li><a href=#emptydirs>После удаления приложения папки, созданные при установке, не удаляются.</a></li> <li><a href=#batchfile>Я запускаю batch-файл в секции [Run], но окно остается на экране после выполнения. Хотелось бы, чтобы оно закрывалось после выполнения ("close on exit")</a></li> <li><a href=#olddir>Я поменял DefaultDirName в скрипте, но при запуске инсталятор по-прежнему выбирает по умолчанию папку, указанную раньше.</a></li> <li><a href=#twoicons>В секции [Icons] два параметра с одним и тем же именем, но устанавливается только один из них.</a></li> <li><a href=#runwait>Инсталятор не ждет, пока программа, указанная в секции [Run], завершит свою работу.</a></li> <li><a href=#missinglanguages>Некоторые языки не отображаются в диалоге <i>Выбор языка установки</i>.</a></li> </ul><h3>Задания для установки</h3> <ul><li><a href=#urls>Создания ярлыков Internet (URL)</a></li> <li><a href=#quicklaunch>Создание ярлыков быстрого запуска</a></li> <li><a href=#startin>Заполнение поля "Start In" для ярлыка</a></li> <li><a href=#assoc>Ассоциирование файлов</a></li> <li><a href=#env>Задание переменных среды</a></li> <li><a href=#closeonexit>Автоматическое закрытие окна после выполнения программы MS-DOS</a></li> <li><a href=#backup>Резервное копирование (Backup) перед удалением файлов</a></li> <li><a href=#difffiles>Установка различных файлов в зависимости от версии Windows</a></li> <li><a href=#perms>Установка разрешений для файлов, папок и ключей реестра.</a></li> <li><a href=#custom>Моя установка не может сделать чего-либо имеющимися средствами Inno Setup</a></li> </ul><h3>Как установить...?</h3> <ul><li><a href=#ocx>Файлы OCX</a></li> <li><a href=#vb>Системные файлы Visual Basic</a></li> <li><a href=#vc>Системные файлы Visual C++ (MFC)</a></li> <li><a href=#comctl32>COMCTL32.DLL</a></li> <li><a href=#bde>BDE (Borland Database Engine)</a></li> <li><a href=#mdac>MDAC, ADO, Jet и т.д.</a></li> </ul><h3>Совместимость</h3> <ul><li><a href=#oscompat>Совместимость ОС</a></li> <li><a href=#ntsecur>Windows NT/2000/XP &amp; администранивные привилегии</a></li> </ul><h3>Разное</h3> <ul><li><a href=#limits>Существуют ли ограничения на число файлов и пр., включенных в установку?</a></li> <li><a href=#cancel>Что именно происходит, если пользователь нажмет Cancel в процессе установки?</a></li></ul><hr /><h2>Выполняемые функции</h2> <h4><a name=lang>Перевод текста Inno Setup</a></h4><blockquote><p>Для того, чтобы перевести текст Inno Setup на другой язык, менять исходный код инсталятора не потребуется. Просто копируйте файл Default.isl (который находится в папке Inno Setup) и переведите на нужный язык текст в этом файле. (Не переводите оригинал Default.isl, т.к. эти изменения будут утеряны при установке новой версии Inno Setup). Для справки обратитесь к разделу "Секция [Messages]" файла помощи Inno Setup.</p><p>После создания нового .isl файла, в секции [Languages] надо указать компилятору, чтобы он начал его использовать:</p><p><tt><b>[Languages]</b><br /> <font color=blue>Name</font>: mytrans; <font color=blue>MessagesFile</font>: "compiler:MyTranslation.isl"</tt></p><p>При использовании версий старше 4.0 код будет следующим:</p><p><tt><b>[Setup]</b><br /> <font color=blue>MessagesFile</font>=compiler:MyTranslation.isl</tt></p><p>Скачать готовые переводы можно на <a href=http://www.jrsoftware.org/is3rdparty.php>Inno Setup Third-Party Files</a>, там же вы найдете программу, которая поможет отредактировать .isl файл.</p></blockquote><h4><a name=mbcs>Поддерживается ли MBCS (multi-byte character sets - многобайтовые наборы символов)?</a></h4><blockquote><p>Inno Setup 2.0.6 полностью поддерживает MBCS. Он выполняет проверку имени файла или константы и больше не выдает ошибку, если обнаружит следующие за ними бэкслеш ("\") или фигурную скобку ("{").</p><p>Версии до 2.0.6 не включают специальной поддержки MBCS.</p></blockquote><h4><a name=msi>Будет ли в будущем поддерживаться Windows Installer?</a></h4><blockquote><p>На данный момент планов по выпуску Inno Setup с поддержкой Windows Installer нет. "Поддержка" Windows Installer, вероятно, приведет к полному переписыванию программы - на что нет ни времени, ни желания.</p></blockquote><h4><a name=setupicon>Как изменить иконку Setup.exe?</a></h4><blockquote><p>Иконку инсталятора можно поменять с помощью директивы <tt>SetupIconFile</tt> секции [Setup]. Для замены иконки деинсталятора используется директива <tt>UninstallIconFile</tt>.</p></blockquote><h4><a name=conditional>Можно ли в Inno Setup задать установку с условием - например, чтобы установка начиналась только если в реестре присутствует некоторый ключ или определенный файл уже имеется?</a></h4><blockquote><p>В Inno Setup 4 добавлена эта возможность - она реализуется с помощью написания дополнительного скрипта на Pascal.</p><p>Внимание: в более ранних версиях Inno Setup можно только <a href=#difffiles>Установить различные файлы в зависимости от версии Windows</a>.</p></blockquote><h4><a name=webinstall>Можно ли создать "установку через web" ("web install")?</a></h4><blockquote><p>Нет, и на момент написания FAQ планов по реализации этой возможности нет.</p></blockquote><h4><a name=silent>Возможна ли быстрая и очень быстрая установка без использования параметров командной строки /SILENT или /VERYSILENT?</a></h4><blockquote><p>Нет и не будет. Если требуется свести к минимуму участие пользователя в установке, используйле директивы Disable* секции [Setup].</p></blockquote><h4><a name=dirnamereg>Может ли инсталятор использовать значение, взятое из реестра, в качестве имени папки по умолчанию?</a></h4><blockquote><p>Да. Используйте константу {reg:...} в DefaultDirName. Например:</p><p><tt><b>[Setup]</b><br /> <font color=blue>DefaultDirName</font>={reg:HKLM\Software\My Program,Path|{pf}\My Program}<br /></tt></p><p>Для справки о константе {reg:...} обратитесь к разделу "Константы" файла помощи Inno Setup.</p></blockquote><hr /><h2>Проблемы</h2> <h4><a name=errorquotes>Компилятор выдает сообщение: "Mismatched or misplaced quotes on parameter" ("Лишние кавычки у параметра").</a></h4><blockquote><p>Обычно это сообщение выдается при попытке вставить символ кавычкек (") в данные параметра, но не сделали их двойными, как это положено. Прочитайте раздел "Параметры в секциях" файла помощи Inno Setup для справки.</p></blockquote><h4><a name=workingdir>Мое приложение не находит файлы по ярлыкам, созданным инсталятором. Но запускается при двойном щелчке на ЕХЕ-файле приложения в Проводнике.</a></h4><blockquote><p>Скорее всего ваше приложение не определяет путь к файлам, которые пытается открыть; оно ожидает найти их в заданной папке. По умолчанию Inno Setup не заполняет поле "Start In" для создаваемых им ярлыков; в этом случае Windows сама задает папку, которая чаще всего не является на самом деле папкой приложения.</p><p>В таких ситуациях следует исправить что-то в приложении. Правильно созданные GUI приложения не должны запускаться просто из заданной папки; все пути к запускаемым приложением файлам должны быть прописаны полностью. В Delphi или C++Builder, например, есть возможность получить полный путь к папке, содержащей ЕХЕ-файл приложения, вызовом: <tt>ExtractFilePath(ParamStr(0))</tt>. Для получения полного пути к файлу с именем "File.txt" папки приложения, используйте: <tt>ExtractFilePath(ParamStr(0)) + 'File.txt'</tt>.</p><p>Если по какой-либо причине исправить эту ошибку на уровне приложения не получается, можно задать Inno Setup заполнить поле "Start In", добавив "WorkingDir: {app}" в секцию [Icons].</p></blockquote><h4><a name=corrupt>Почему на некоторых системах появляется сообщение об ошибке "The setup files are corrupted" ("Файлы инсталятора повреждены")?</a></h4><blockquote><p>Это сообщение отображается, когда файл, предназначенный для установки (т.е. setup.exe, setup.1) имеет неверный размер или часть файла имеет неверную контрольную сумму CRC check. В других случаях это сообщение не выдается.</p><p>Если файл-инсталятор вашего приложения распространяется через Internet и это сообщение об ошибке отображается несколько раз, возможно, что web-сервер разрывает связь прежде, чем файлы полностью успеют загрузиться. Предупредите пользователей, чтобы после загрузки они проверяли размер скачанных файлов.</p><p>Если файл-инсталятор приложения получен с CD-ROM'a или дискеты, причина может быть в испорченном носителе или некорректрой работе считывающего устройства.</p></blockquote><h4><a name=appid>При установке новой версии приложения поверх старой, в Установка и удаление программ панели управления создается новая запись.</i>.</a></h4><blockquote><p>Это происходит, если у версий приложения разный AppId, или, если AppId не указан, разные AppName. При этом инсталятор не знает, что имеет дело с двумя версиями одного приложения, поэтому создает новую запись в Установка и удаление программ панели управления. Кроме этого создается новый файл деинсталятора. Для того, чтобы этого не происходило, следует задавать двум инсталяторам одинаковые AppId или AppName.</p><p>Если необходимо изменить AppName для новой версии, задайте AppId то же значение, что и AppId или AppName предыдущей версии.</p></blockquote><h4><a name=noregserver>Инсталятор выдает сообщение "Unable to register the DLL/OCX: DllRegisterServer export not found" ("Невозможно зарегистрировать DLL/OCX: DllRegisterServer не найден").</a></h4><blockquote><p>Это сообщение означает, что вы указали флаг "regserver" для файла, который не может быть зарегистрирован. Удалите флаг "regserver" у параметра в секции [Files], и сообщение перестанет отображаться.</p></blockquote><h4><a name=emptydirs>После удаления приложения папки, созданные при установке, не удаляются.</a></h4><blockquote><p>Сцществует несколько причин, по которым папки не удаляются при удалении приложения:</p><ul><li>При установке приложения папки уже существовали. По умолчанию деинсталятор не удаляет папки, которые инсталятор не создавал.</li> <li>Папки содержат файлы или подпапки. Используйте [UninstallDelete], если хотите, чтобы деинсталятор удалял такие файлы/папки.</li> <li>При запуске папка используется как директория по умолчанию.</li></ul><p>Внимание: В версиях Inno Setup, меньших 2.0.1, папки должны быть указаны в секциях [Dirs] или [UninstallDelete], чтобы деинсталятор смог их удалить. В более новых версиях Inno Setup папки, созданные в секции [Files], будут удалены деинсталятором автоматически, если они не существовали до начала установки.</p></blockquote><h4><a name=batchfile>Я запускаю batch-файл в секции [Run], но окно остается на экране после выполнения. Хотелось бы, чтобы оно закрывалось после выполнения ("close on exit")</a></h4><blockquote><p>Ответил Tim Rude:<br /> Самый простой способ автоматически закрыть batch-файл при выходе - очистить экран с помощью команды CLS.</p><p><i>--- batch file 1 ---</i></p><p><tt>@echo off<br /> echo Hello World<br /> echo This batch file does NOT close on exit</tt></p><p><i>--- batch file 2 ---</i></p><p><tt>@echo off<br /> echo Hello World<br /> echo This batch file DOES close on exit<br /> cls</tt></p></blockquote><h4><a name=olddir>Я поменял DefaultDirName в скрипте, но при запуске инсталятор по-прежнему выбирает по умолчанию папку, указанную раньше.</a></h4><blockquote><p>При старте инсталятор проверяет в реестре, устанавливалось ли приложение в системе ранее, и если так, то использует по умолчанию ту папку, в которую приложение по желанию пользователя было установлено раньше. Если вы удалите приложение и снова запустите инсталятор, он будет использовать новую DefaultDirName. Если нужно отменить эту опцию, задайте директиве UsePreviousAppDir значение "no".</p></blockquote><h4><a name=twoicons>В секции [Icons] два параметра с одним и тем же именем, но устанавливается только один из них.</a></h4><blockquote><p>Два файла не могут иметь одинаковые имена, а так как ярлыки являются файлами, они также не могут иметь совпадающих имен.</p></blockquote><h4><a name=runwait>Инсталятор не ждет, пока программа, указанная в секции [Run], завершит свою работу.</a></h4><blockquote><p>Во-первых, убедитесь, что вы <i>не</i> используете флаги "nowait" или "waituntilidle" для параметра секции [Run]. Эти флаги не позволяют инсталятору ждать завершения работы вызванных программ.</p><p>Если вы не используете эти флаги, а инсталятор все равно не дожидается завершения работы программы, то, возможно, вызываемый ЕХЕ-файл порождает другой процесс, а сам прекращает свою работу, и инсталятор думает, что программа завершила свою работу. Это происходит со старыми, основанными на InstallShield инсталяторами (для справки обратитесь к <a href=http://www.installshield.com/news/newsletter/0206-articles/LaunchIS5Setup.asp>/SMS switch</a>).</p><p>Проверить, совершает ли программа подобные действия, можно, запустив "START /WAIT ProgramName.exe" из командной строки, и посмотреть, вернетесь ли вы к командной строке раньше выхода из программы.</p></blockquote><h4><a name=missinglanguages>Некоторые языки не отображаются в диалоге <i>Выбор языка установки</i>.</a></h4><blockquote><p>Начиная с Inno Setup 4.2.2, языки, заданные в секции [Languages], которые не поддерживаются текущей кодовой страницей Windows ANSI не отображаются в списке <i>Выбор языка установки</i>. Например, русский язык будет значиться в списке языков установки только в случае, когда используется кодовая страница 1251; если кодовая страница не 1251, русского языка в списке языков установки не будет.</p><p>В Windows XP текущая кодовая страница может быть изменена в разделе <i>Язык и региональные стандарты</i> Панели управления, секции <i>Язык программ не поддерживающих Юникод</i> вкладки Дополнительно. В Windows 2000 текущая кодовая страница может быть изменена в разделе <i>Региональные стандарты</i> Панели управления, где следует нажать кнопку <i>Значения по умолчанию...</i>.</p><p>Если вы уверены, что инсталятор запущен при верно заданной кодовой странице, а язык все равно не значится в списке, скорее всего <tt>LanguageID</tt> в .isl-файле языка задан неверно.</p><p>Если вы хотите, чтобы все языки значились в списке независимо от возможности их корректного отображения при текущей кодовой странице, добавьте в скрипт следующую строку:</p><p><tt><b>[LangOptions]</b><br /> <font color=blue>LanguageCodePage</font>=0</tt></p></blockquote><hr /><h2>Задания для установки</h2> <h4><a name=urls>Создания ярлыков Internet (URL)</a></h4><blockquote><p>Сначала создается файл с именем, например, "website.url", и в него записывается:</p><p><tt>[InternetShortcut]<br /> URL=http://web.site.address/</tt></p><p>В скрипт добавляется:</p><p><tt><b>[Files]</b><br /> <font color=blue>Source</font>: "website.url"; <font color=blue>DestDir</font>: "{app}"<br /> <br /> <b>[Icons]</b><br /> <font color=blue>Name</font>: "{group}\Visit My Web Site"; <font color=blue>Filename</font>: "{app}\website.url"<br /></tt></p></blockquote><h4><a name=quicklaunch>Создание ярлыков быстрого запуска</a></h4><blockquote><p>В версиях начиная с Inno Setup 1.3.11:</p><p><tt><b>[Icons]</b><br /> <font color=blue>Name</font>: "{userappdata}\Microsoft\Internet Explorer\Quick Launch\My Program"; <font color=blue>Filename</font>: "{app}\MyProg.exe"<br /></tt></p></blockquote><h4><a name=startin>Заполнение поля "Start In" для ярлыка</a></h4><blockquote><p>Используется параметр WorkingDir секции [Icons].</p></blockquote><h4><a name=assoc>Ассоциирование файлов</a></h4><blockquote><p>Сначала директиве "ChangesAssociations" секции [Setup] присваивается значение "yes". Затем задаются параметры секции [Registry], как показано ниже. <i>Внимание:</i> Ломаные линии означают, что далее следует продолжение той же строки --></p><p><tt><b>[Registry]</b><br /> <font color=blue>Root</font>: HKCR; <font color=blue>Subkey</font>: ".myp"; <font color=blue>ValueType</font>: string; <font color=blue>ValueName</font>: ""; ValueData: "MyProgramFile"; <font color=blue>Flags</font>: uninsdeletevalue</tt></p><blockquote>".myp" - расширение файла, с которым ассоциируется приложение. "MyProgramFile" - "внутреннее" имя типа файла, заданное в реестре. Убедитесь, что для этого вы используете уникальное имя, иначе можно нечаянно поменять ключи реестра других приложений.</blockquote><p><tt><font color=blue>Root</font>: HKCR; <font color=blue>Subkey</font>: "MyProgramFile"; <font color=blue>ValueType</font>: string; <font color=blue>ValueName</font>: ""; <font color=blue>ValueData</font>: "My Program File"; <font color=blue>Flags</font>: uninsdeletekey</tt></p><blockquote>"My Program File" - имя типа файла, отображаемое в Проводнике.</blockquote><p><tt><font color=blue>Root</font>: HKCR; <font color=blue>Subkey</font>: "MyProgramFile\DefaultIcon"; <font color=blue>ValueType</font>: string; <font color=blue>ValueName</font>: ""; <font color=blue>ValueData</font>: "{app}\MYPROG.EXE,0"</tt></p><blockquote>"DefaultIcon" - ключ реестра, указывающий имя файла иконки, который будет ассоциироваться с типом файла. ",0" указывает Проводнику использовать первую иконку из MYPROG.EXE. (",1" означает использование второй иконки).</blockquote><p><tt><font color=blue>Root</font>: HKCR; <font color=blue>Subkey</font>: "MyProgramFile\shell\open\command"; <font color=blue>ValueType</font>: string; <font color=blue>ValueName</font>: ""; <font color=blue>ValueData</font>: """{app}\MYPROG.EXE"" ""%1"""</tt></p><blockquote>"shell\open\command" - ключ реестра, в котором указывается программа, которая должна будет запускаться при двойном щелчке в Проводнике на файле с указанным ранее расширением. Кавычки нужны для того, чтобы в командной строке длинные имена отображались правильно. </blockquote></blockquote><h4><a name=env>Задание переменных среды</a></h4><blockquote><p>В Windows NT/2000/XP переменные среды зарезервированы в виде строковых значений в реестре, что дает возможность манипулировать ими с помощью секции [Registry]. Системные переменные среды находятся в:</p><blockquote>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment</blockquote><p>Пользовательские переменные среды находятся в:</p><blockquote>HKEY_CURRENT_USER\Environment</blockquote><p>В Windows 95/98/Me для задания переменных среды придется изменять AUTOEXEC.BAT. Inno Setup не имеет для этих целей встроенных функций, но вы можете написать маленькую программу модификации AUTOEXEC.BAT и затем запустить ее из секции [Run] (<a href=#custom>подробнее</a>).</p></blockquote><h4><a name=closeonexit>Автоматическое закрытие окна после выполнения программы MS-DOS</a></h4><blockquote><p>Inno Setup версий 1.3.15 и выше включает поддержку флагов "closeonexit" и "dontcloseonexit" для секции [Icons].</p></blockquote><h4><a name=backup>Резервное копирование (Backup) перед удалением файлов</a></h4><blockquote><p>Inno Setup не имеет для этого специальных функций, но вы можете сделать копию файла перед его удалением с помощью параметров секции [Files]:</p><p><tt><font color=blue>Source</font>: "{app}\MyProg.exe"; <font color=blue>DestDir</font>: "{app}\backup"; <font color=blue>Flags</font>: external skipifsourcedoesntexist uninsneveruninstall</tt></p></blockquote><h4><a name=difffiles>Установка различных файлов в зависимости от версии Windows</a></h4><blockquote><p>Реализуется с помощью директив MinVersion и/или OnlyBelowVersion. Для справки обратитесь к разделу Общие параметры файла справки Inno Setup.</p><p>Ниже приведен пример установки одного файла на платформу NT (Windows NT/2000/XP) и другого на не-NT платформу (Windows 95/98/Me):</p><p><tt><b>[Files]</b><br /> <font color=blue>Source</font>: "{app}\WinNT2000XP.exe"; <font color=blue>DestDir</font>: "{app}"; <font color=blue>MinVersion</font>: 0, 1<br /> <font color=blue>Source</font>: "{app}\Win9598Me.exe"; <font color=blue>DestDir</font>: "{app}"; <font color=blue>MinVersion</font>: 1, 0</tt></p><p>"0" означает никогда не устанавливать; "1" означает устанавливать на любую версию (т.е. версию 1.0 и далее).</p><p>Внимание: Этот способ не применим к секции [Files]; MinVersion и OnlyBelowVersion используются в большинстве секций.</p></blockquote><h4><a name=perms>Установка разрешений для файлов, папок и ключей реестра.</a></h4><blockquote><p>Начиная с Inno Setup 4.1.0, секции [Dirs], [Files], и [Registry] поддерживают параметры Permissions для задания разрешений для папок, файлов и ключей реестра соответственно.</p><p>Если требования более расширены, обратитесь к <a href=http://setacl.sourceforge.net/>SetACL</a>.</p></blockquote><h4><a name=custom>Моя установка не может сделать чего-либо имеющимися средствами Inno Setup</a></h4><blockquote><p>Обратитесь к статье How-To <a href=http://www.jrsoftware.org/ishowto.phtml?a=custom>Implementing Custom Functionality</a>.</p></blockquote><hr /><h2>Как установить...?</h2> <h4><a name=ocx>Файлы OCX</a></h4><blockquote><p>Рекомендуется устанавливать файлы OCX так:</p><p><tt><b>[Files]</b><br /> <font color=blue>Source</font>: "ComCtl32.ocx"; <font color=blue>DestDir</font>: "{sys}"; <font color=blue>CopyMode</font>: alwaysskipifsameorolder; <font color=blue>Flags</font>: restartreplace sharedfile regserver</tt></p></blockquote><h4><a name=vb>Системные файлы Visual Basic</a></h4><blockquote><p>Обратитесь к <a href=http://www.jrsoftware.org/ishowto.phtml?a=vb>this How-To article</a>.</p></blockquote><h4><a name=vc>Системные файлы Visual C++ (MFC)</a></h4><blockquote><p>Обратитесь к <a href=http://www.jrsoftware.org/ishowto.phtml?a=vc>this How-To article</a>.</p></blockquote><h4><a name=comctl32>COMCTL32.DLL</a></h4><blockquote><p>Если ваше приложение требует обновленную версию COMCTL32.DLL, можно указать пользователю <a href=http://www.microsoft.com/downloads/details.aspx?FamilyID=cb2cf3a2-8025-4e8f-8511-9b476a8d35d2&amp;DisplayLang=en>скачать</a> обновленный COMCTL32 с сайта Microsoft, или обновить COMCTL32 при установке приложения следующим образом:</p><p><tt><b>[Files]</b><br /> <font color=blue>Source</font>: "50comupd.exe"; <font color=blue>DestDir</font>: "{tmp}"<br /> <br /> <b>[Code]</b><br /> function ShouldInstallComCtlUpdate: Boolean;<br /> var<br /> &nbsp;&nbsp;MS, LS: Cardinal;<br /> begin<br /> &nbsp;&nbsp;// Only install if the existing comctl32.dll is &lt; 5.80<br /> &nbsp;&nbsp;Result := False;<br /> &nbsp;&nbsp;if GetVersionNumbers(ExpandConstant('{sys}\comctl32.dll'), MS, LS) then<br /> &nbsp;&nbsp;&nbsp;&nbsp;if MS &lt; $00050050 then<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Result := True;<br /> end;<br /> <br /> <b>[Run]</b><br /> <font color=blue>Filename</font>: "{tmp}\50comupd.exe"; <font color=blue>Parameters</font>: "/r:n /q:1"; <font color=blue>Check</font>: ShouldInstallComCtlUpdate</tt></p><p>Не пытайтесь установить COMCTL32.DLL прямо из секции [Files]; Microsoft <a href=http://www.microsoft.com/permission/copyrgt/cop-soft.htm#COM>не поддерживает</a> этого, кроме того это может привести к нежелательным последствиям.</p></blockquote><h4><a name=bde>BDE (Borland Database Engine)</a></h4><blockquote><p>Обратитесь к статье How-To <a href=http://www.jrsoftware.org/ishowto.phtml?a=bde>Установка BDE</a> для получения сведений об использовании 32-битной версии BDE, используемой в Inno Setup.</p></blockquote><h4><a name=mdac>MDAC, ADO, Jet, и т.д..</a></h4><blockquote><p>Обратитесь к <a href=http://www.jrsoftware.org/ishowto.phtml?a=dcommdac>этой статье How-To </a>.</p></blockquote><hr /><h2>Совместимость</h2> <h4><a name=oscompat>Совместимость ОС</a></h4><blockquote><p>Поддерживаемые платформы: Windows 95, 98, 2000, XP, Me, и NT 4.0.</p><p>Автор использует для работы преимущественно Windows 2000, так что совместимость с Windows 2000 самая лучшая.</p><p>При появлении новых возможностей Inno Setup они тщательно тестируются автором на всех поддерживаемых платформах и версиях Windows.</p><p>16-битные версии Inno Setup не обновляются начиная с версии 1.3. Поддержка Windows NT 3.51 прекращена начиная с версии 3.0.</p></blockquote><h4><a name=ntsecur>Windows NT/2000/XP &amp; администранивные привилегии</a></h4><blockquote><p>Типичная инсталяция Inno Setup для запуска не требует наличия у пользователя прав администратора или опытного пользователя. Тем не менее существуют исключения. Они описаны ниже.</p><p>В Windows NT/2000/XP требуются права администратора или опытного пользователя в следующих случаях:</p><ul><li>Если "AdminPrivilegesRequired=yes" в секции [Setup] скрипта. В этом случае инсталятор прервет установку и выдаст сообщение об ошибке, если текущий пользователь не наделен правами администратора. (По умолчанию "AdminPrivilegesRequired=no".)</li> <li>Используется флаг "restartreplace" секции [Files]. Этот флаг вынуждает Inno Setup вызвать функцию MoveFileEx, которая попытается сделать запись в "HKEY_LOCAL_MACHINE\ SYSTEM\ CurrentControlSet\ Control\ Session Manager". Запись в этот ключ разрешена только администратору.</li> <li>При записи в любой ключ из HKEY_USERS\.DEFAULT с помощью секции [Registry]. Запись в этот ключразрешена только администратору.</li></ul><p>Что разрешается только пользователям, наделенным правами администратори или опытного пользователя в Windows 2000/XP:</p><ul><li>Использование флага "regserver" секции [Files]. В большинстве случаев регистрация DLL In most cases registering a DLL влечет за собой запись в HKEY_CLASSES_ROOT, что запрещено делать обычному пользователю.</li> <li>Использование флага "sharedfile" секции [Files]. Этот флаг вынуждает Inno Setup создать/обновить параметр в "HKEY_LOCAL_MACHINE\ SOFTWARE\ Microsoft\ Windows\ CurrentVersion\ SharedDLLs". Простые пользователи не могут делать записи в этом ключе.</li> <li>Использование параметра FontInstall секции [Files].</li> <li>Запись в любой из ключей HKEY_LOCAL_MACHINE или HKEY_CLASSES_ROOT с помощью секции [Registry]. Простые пользователи не могут делать записи в этих ключах.</li></ul><p>Inno Setup сам посебе не может производить запись в директорию WINNT, или в ключи реестра, не упомянутые выше.</p><p>Что происходит, если установка запущена пользователем, <i>не наделенным</i> правами администратора?</p><ul><li>Ключ реестра для пункта <i>Установка иудаление программ</i> панели управления создается в HKEY_CURRENT_USER, а не в HKEY_LOCAL_MACHINE. Так что только пользователь, установивший программу, увидит запись в <i>Установка и удаление программ</i>.</li> <li>Константа "{group}" всегда указывает на профиль текущего пользователя, а не на профили всех пользователей.</li> <li>Все константы "{common...}" эквивалентны константам "{user...}".</li> <li>Программа может быть удалена любым пользователем. (Когда программу устанавливает администратор, удалить ее сможет только администратор).</li></ul></blockquote><hr /><h2>Разное</h2> <h4><a name=limits>Существуют ли ограничения на число файлов и пр., включенных в установку?</a></h4><blockquote><p>Inno Setup не устанавливает ограничений на число файлов, ярлыков, параметров реестра и т.д., которые будут включены в установку. Впрочем, не следует забывать о том, что для каждого параметра, указанного в скрипте, требуется некоторое количество памяти. Например, примерно 120 байт памяти потребуется для каждого параметра секции [Files].</p><p>В Inno Setup 3.x и ранее инсталятор и отдельные файлы не могли превышать по размеру 2 GB. Это относится к Inno Setup 4.</p></blockquote><h4><a name=cancel>Что именно происходит, если пользователь нажмет Cancel в процессе установки?</a></h4><blockquote><p>При нажатии Cancel инсталятор отменяет изменения, сделанные им в ходе установки, почти как деинсталятор при удалении программы. Поэтому частично установленное приложение не останется в системе пользователя.</p></blockquote></body></html>