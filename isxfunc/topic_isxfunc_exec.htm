<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=8" />
<title>Pascal Scripting: Exec</title>
<link rel="stylesheet" type="text/css" href="../styles.css" />
<script type="text/javascript" src="../topic.js"></script>
</head>
<body>
<h1 class="topicheading">Pascal Scripting: Exec</h1>
<div class="topicbody">
  <div><b>Прототип:</b></div>
  <p><tt>function Exec(const Filename, Params, WorkingDir: String; const ShowCmd: Integer; const Wait: TExecWait; var ResultCode: Integer): Boolean;</tt></p>
  <div><b>Описание:</b></div>
  <p>Executes the specified executable or batch file, using the same credentials as Setup/Uninstall. The Wait parameter specifies whether the function should return immediately or wait until the launched process has termimated or is idle. Returns True if the specified file was executed successfully, False otherwise. If True is returned and Wait is ewWaitUntilTerminated then ResultCode returns the exit code of the process. If False is returned then ResultCode specifies the error that occurred. Use SysErrorMessage(ResultCode) to get a description of the error.</p>
  <div><b>Комментарии:</b></div>
  <p>TExecWait is defined as:</p>
  <p><tt>TExecWait = (ewNoWait, ewWaitUntilTerminated, ewWaitUntilIdle);</tt></p>
  <p>Use the <a href="topic_isxfunc_shellexec.htm">ShellExec</a> function instead if you need to launch a file that is not an executable or batch file.</p>
  <p>Do not include quotes in the Filename parameter; the function will add them automatically.</p>
  <p>The WorkingDir parameter can be an empty string, in which case it will try to extract a pathname from the Filename parameter and use that as the initial current directory for the process. If no pathname was specified in Filename, a default directory will be used.</p>
  <p>If you have a single string containing both a filename and parameters (e.g. a command line obtained from an UninstallString registry value), you need not separate them yourself; just pass <tt>'&gt;'</tt> in the Filename parameter, and the full command line in the Params parameter. (Note that when this is done, the function's special platform-independent support for .bat and .cmd files is disabled; it simply passes the specified command line to CreateProcess without any processing.)</p>
  <p>By default, when Setup/Uninstall is running in <a href="../topic_32vs64bitinstalls.htm">64-bit mode</a>, this function disables WOW64 file system redirection when calling CreateProcess. It is possible to override this by calling <a href="topic_isxfunc_enablefsredirection.htm">EnableFsRedirection</a>.</p>
  <div><b>Например:</b></div>
  <pre>var
  ResultCode: Integer;
begin
  // Launch Notepad and wait for it to terminate
  if Exec(ExpandConstant('{win}\notepad.exe'), '', '', SW_SHOW,
     ewWaitUntilTerminated, ResultCode) then
  begin
    // handle success if necessary; ResultCode contains the exit code
  end
  else begin
    // handle failure if necessary; ResultCode contains the error code
  end;
end;</pre>
  <div><b>См. также:</b></div>
  <p><a href="topic_isxfunc_execasoriginaluser.htm">ExecAsOriginalUser</a></p>
</div>
</body>
</html>