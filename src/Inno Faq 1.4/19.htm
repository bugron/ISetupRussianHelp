<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1251"><title>Ассоциация файлов</title><link rel="stylesheet" type="text/css" href="css.css"><script type="text/javascript" src="includer.js"></script><script language='jscript' type='text/javascript' src='copycode.js'></script></head><body><div id="heading"><h1>» Inno Setup Faq. Ассоциация файлов</h1></div><br><font face="Consolas">Способ 1:</font><br><script language="javascript" type="text/javascript">includeSyntax('delphi');</script><code id="delphi_Tc4NTM">
<input type="button" value="Копировать в буфер обмена" onClick="copyToClipboard( taCode1, theCode1 );">
<blockquote id="theCode1"><font>[Registry]<br>Root: HKLM; Subkey: &quot;Software\Classes\.w3m&quot;; ValueType: string; ValueName: &quot;&quot;; ValueData: &quot;WorldEdit.Scenario&quot;; Flags: uninsdeletevalue<br>Root: HKLM; Subkey: &quot;Software\Classes\WorldEdit.Scenario\DefaultIcon&quot;; ValueType: string; ValueName: &quot;&quot;; ValueData: &quot;{app}\WorldEdit.exe,2&quot;; Flags: uninsdeletevalue<br>Root: HKLM; Subkey: &quot;Software\Classes\WorldEdit.Scenario\shell\open\command&quot;; ValueType: string; ValueName: &quot;&quot;; ValueData: &quot;{app}\World Editor.exe &quot;&quot;%1&quot;&quot;&quot;; Flags: uninsdeletevalue</font></blockquote><textarea id="taCode1" style="display:none;" rows="1" cols="5"></textarea><textarea id='taCode' style='display:none;' rows='1' cols='20'></textarea></code><script language="javascript" type="text/javascript">highlightSyntax('delphi_Tc4NTM','delphi');</script>

<br><font face="Consolas">Способ 2:</font><br><input type="button" value="Копировать в буфер обмена" onClick="copyToClipboard( taCode2, theCode2 );">
<blockquote id="theCode2"><script language="javascript" type="text/javascript">includeSyntax('delphi');</script><code id="delphi_Tc4NTN">[Setup]<br>AppName=My Program<br>AppVerName=My Program<br>DefaultDirName={pf}\My Program<br>DefaultGroupName=My Program<br><br>[Registry]<br>Root: HKLM; Subkey: SOFTWARE\Classes\.v64; Check: CheckOption(0)<br>Root: HKLM; Subkey: SOFTWARE\Classes\.z64; Check: CheckOption(1)<br>Root: HKLM; Subkey: SOFTWARE\Classes\MP64; ValueType: string; ValueData: My Program; Flags: uninsdeletekey<br>Root: HKLM; Subkey: SOFTWARE\Classes\MP64\DefaultIcon; ValueType: string; ValueData: {app}\MyProgram.exe,0<br>Root: HKLM; Subkey: SOFTWARE\Classes\MP64\shell\open\command; ValueType: string; ValueData: {app}\MyProgram.exe %1<br><br>[Code]<br>var<br>&nbsp; Page: TInputOptionWizardPage;<br><br>procedure InitializeWizard();<br>begin<br>&nbsp; Page := CreateInputOptionPage(wpSelectTasks,<br>&nbsp; 'Select File Extension Association', 'Which the file extension you would like to associate?',<br>&nbsp; 'Select the file extension you would like to associate with My Program,'#13#10'then click Next.',<br>&nbsp; False, False);<br><br>&nbsp; {{0} Page.Add('.v64');<br>&nbsp; {{1} Page.Add('.z64');<br><br>Page.Values[0] := True;<br>end;<br><br>function CheckOption(OptionNum: integer): Boolean;<br>begin<br>&nbsp; Result:= Page.Values[OptionNum];<br>end;<br><br>procedure CurPageChanged(CurPageID: Integer);<br>begin<br>&nbsp; if CurPageID = wpReady then<br>&nbsp; &nbsp; begin<br>&nbsp; &nbsp; WizardForm.ReadyMemo.Lines.Add('');<br>&nbsp; &nbsp; &nbsp; if Page.Values[1] or Page.Values[2] then<br>&nbsp; &nbsp; WizardForm.ReadyMemo.Lines.Add('File extension association:');<br>&nbsp; &nbsp; &nbsp; if Page.Values[1] then<br>&nbsp; &nbsp; WizardForm.ReadyMemo.Lines.Add('&nbsp; &nbsp; &nbsp; .v64');<br>&nbsp; &nbsp; &nbsp; if Page.Values[2] then<br>&nbsp; &nbsp; WizardForm.ReadyMemo.Lines.Add('&nbsp; &nbsp; &nbsp; .z64');<br>&nbsp; end;<br>end;<script language="javascript" type="text/javascript">highlightSyntax('delphi_Tc4NTN','delphi');</script></code></blockquote><code id="delphi_Tc4NTN"><textarea id="taCode2" style="display:none;" rows="1" cols="5"></textarea><textarea id='taCode' style='display:none;' rows='1' cols='20'></textarea></code>

<br><font face="Consolas">Способ 3:</font><br><input type="button" value="Копировать в буфер обмена" onClick="copyToClipboard( taCode3, theCode3 );"><blockquote id="theCode3"><td class="code"><script language="javascript" type="text/javascript">includeSyntax('delphi');</script><code id="delphi_Tc4NTB">[Setup]<br>AppName=My Program<br>AppVerName=My Program 1.5<br>DefaultDirName={pf}\My Program<br><br>[Types]<br>Name: full; Description: Полная установка<br>Name: cu stom_clean; Description: Пользовательская установка; Flags: iscustom<br><br>[Components]<br>Name: main; Description: Основные компоненты; Types: full custom_clean; Flags: checkablealone<br>Name: main\ass; Description: Установить ассоциации:; Types: full custom_clean; Flags: checkablealone<br>Name: main\ass\ani; Description: .ani; Types: full custom_clean<br><br>[Registry]<br>Root: HKCU; Subkey: Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.ani; ValueType: string; ValueName: ; ValueData: ; Components: main\ass\ani<br>Root: HKCU; Subkey: Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.ani; ValueType: string; ValueName: ProgID; ValueData: IrfanView.ani; Flags: uninsdeletevalue uninsdeletekeyifempty; Components: main\ass\ani<br><br>[Code]<br>procedure CurStepChanged(CurStep: TSetupStep);<br>var<br>&nbsp; String: String;<br>begin<br>if (CurStep = ssInstall) and (IsComponentSelected('main\ass\ani') = False) then<br>&nbsp; if (ExpandConstant('{reg:HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.ani,ProgID}') = 'IrfanView.ani') or<br>&nbsp; &nbsp; (ExpandConstant('{reg:HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.ani,ProgID}') = 'IrfanView.ANI') then<br>&nbsp; &nbsp; begin<br>&nbsp; &nbsp; RegDeleteValue(HKEY_CURRENT_ USER, 'Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.ani', 'ProgID')<br>&nbsp; &nbsp; if (RegQueryStringValue(HKEY_CURRENT_ USER, 'Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.ani', '', String)) and (String = '') then<br>&nbsp; &nbsp; &nbsp; &nbsp; RegDeleteValue(HKEY_CURRENT_ USER, 'Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.ani', '')<br>&nbsp; &nbsp; RegDeleteKeyIfEmpty(HKEY_CURRENT_USER, 'Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.ani')<br>&nbsp; &nbsp; end<br>end;</code></td><script language="javascript" type="text/javascript">highlightSyntax('delphi_Tc4NTB','delphi');</script></blockquote><textarea id="taCode3" style="display:none;" rows="1" cols="5"></textarea><textarea id='taCode' style='display:none;' rows='1' cols='20'></textarea><br><div id="heading"><h1><font size="1" face="Consolas">Copyright (c) <a href="http://www.krinkels.org/" target="_blank">Krinkels Inc</a></font></h1></div></body></html>