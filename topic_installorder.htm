<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=8" />
<title>Порядок установки</title>
<!--[if IE 6]><style type="text/css">html{overflow-y:scroll}</style><![endif]-->
<link rel="stylesheet" type="text/css" href="styles.css" />
<script type="text/javascript" src="topic.js"></script>
</head>
<body>
<h1 class="topicheading">Порядок установки</h1>
<div class="topicbody">
  <p>Задачи в секциях от начала до завершения установки выполняются в следующем порядке:</p>
  <ul>
    <li>Выполняется <a href="topic_installdeletesection.htm">[InstallDelete]</a>.</li>
    <li>Записи <a href="topic_uninstalldeletesection.htm">секции [UninstallDelete]</a> располагаются в логе деинсталлятора (который в данном этапе находится в оперативной памяти).</li>
    <li>При необходимости создается папка приложения.</li>
    <li>Выполняется <a href="topic_dirssection.htm">[Dirs]</a>.</li>
    <li>При необходимости резервируется имя файла деинсталлятора.</li>
    <li>Выполняется <a href="topic_filessection.htm">[Files]</a>. (Регистрация файлов не происходит.)</li>
    <li>Выполняется <a href="topic_iconssection.htm">[Icons]</a>.</li>
    <li>Выполняется <a href="topic_inisection.htm">[INI]</a>.</li>
    <li>Выполняется <a href="topic_registrysection.htm">[Registry]</a>.</li>
    <li>Регистрируются файлы, нуждающиеся в регистрации, если только не требуется перезагрузка системы - в этом случае ни один файл не будет зарегистрирован до тех пор, пока система не перезагрузится.</li>
    <li>При необходимости создается пункт в <i>Установка/Удаление программ</i>.</li>
    <li>Записи <a href="topic_runsection.htm">[UninstallRun]</a> располагаются в логе деинсталлятора.</li>
    <li>Завершается создание  и сохранение на диске деинсталлятора и его лога. После этого, пользователь не сможет отменить установку, и любые последующие ошибки не будут вызывать откат всех действий.</li>
    <li>Выполняется <a href="topic_runsection.htm">[Run]</a>, за исключением файлов с флагом <tt>postinstall</tt>, которые выполняются после того, как отобразится страница <i>Установка завершена</i>.</li>
    <li>Если <a href="topic_setup_changesassociations.htm">ChangesAssociations</a>=<tt>yes</tt>, обновлются ассоциации файлов.</li>
    <li>Если <a href="topic_setup_changesenvironment.htm">ChangesEnvironment</a>=<tt>yes</tt>, остальные приложения информируются об изменении переменных среды.</li>
  </ul>
  <p>Все записи выполняются инсталлятором в том порядке, в котором они располагаются в секции.</p>
  <p>Все изменения отменяются деинсталлятором <i>обратном</i> в порядке. Это происходит потому, что лог деинсталлятора выполняется от конца к началу.</p>
  <p>Например:</p>
  <pre class="indent examplebox">[INI]<br />Filename: &quot;{win}\MYPROG.INI&quot;; Section: &quot;InstallSettings&quot;; Flags: uninsdeletesectionifempty<br />Filename: &quot;{win}\MYPROG.INI&quot;; Section: &quot;InstallSettings&quot;; Key: &quot;InstallPath&quot;; String: &quot;{app}&quot;; Flags: uninsdeleteentry</pre>
  <p>В приведенном выше примере инсталлятор в первую очередь запишет данные для флага <tt>uninsdeletesectionifempty</tt> первого параметра в лог деинсталлятора, создаст ключ для второго параметра, а потом запишет данные для флага <tt>uninsdeleteentry</tt> в лог деинсталлятора. При удалении программы деинсталлятор сначала обработает флаг <tt>uninsdeleteentry</tt>, удаляющий параметр, а потом флаг <tt>uninsdeletesectionifempty</tt>.</p>
  <p>Обратите внимание, что деинсталлятор обрабатывает <tt>[UninstallRun]</tt> и <tt>[UninstallDelete]</tt> в том же самом порядке, в котом они написаны в скрипте (не в обратном порядке).</p>
</div>
</body>
</html>
