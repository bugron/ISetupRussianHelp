<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=8" />
<title>Ограничения в 64-разрядном режиме</title>
<!--[if IE 6]><style type="text/css">html{overflow-y:scroll}</style><![endif]-->
<link rel="stylesheet" type="text/css" href="styles.css" />
<script type="text/javascript" src="topic.js"></script>
</head>
<body>
<h1 class="topicheading">Ограничения в 64-разрядном режиме</h1>
<div class="topicbody">
  <p>Поскольку Inno Setup&nbsp;32-разрядное приложение, есть некоторые ограничения, которые надо учитывать при использовании 64-разрядных функций и значений констант:</p>
  <ul>
    <li>Путь System32, возвращаемый константой <tt>{sys}</tt>, по умолчанию указывает путь к 64-разрядной папке System, при использовании в секциях [Dirs], [Files], [InstallDelete], [Run], [UninstallDelete] и [UninstallRun], поскольку инсталлятор временно отключает <a href="http://msdn.microsoft.com/en-us/library/aa384187.aspx" target="_blank" title="http://msdn.microsoft.com/en-us/library/aa384187.aspx">перенаправление файловой системы WOW64</a><img src="images/extlink.gif" alt=" [external link]" />, когда к файлам/папкам получают доступ из этих секций. В обратном случае, System32 и <tt>{sys}</tt> указывают путь к 32-разрядному каталогу System, как в 32-разрядном режиме.</li>
    <li>
      <p>Когда инсталлятор/деинсталлятор выполняется в 64-разрядном режиме функции в секции [Code], которые получают доступ к файлам, отключают перенаправление файловой системы WOW64 (если не переопределен вызов <a href="isxfunc/topic_isxfunc_enablefsredirection.htm">EnableFsRedirection</a>). Однако, есть исключения. Нижеприведенные функции никогда не отключают перенаправление файловой системы, что означает, что Вы не можете передать (или возвращать) имя файла, расположенного в 64-разрядной папке System:</p>
      <table>
        <tbody>
          <tr>
            <td class="cellleft"><tt>*Ini*</tt></td>
            <td class="cellright">(все функции, которые манипулируют .INI файлами)</td>
          </tr>
          <tr>
            <td class="cellleft"><tt>BrowseForFolder</tt></td>
          </tr>
          <tr>
            <td class="cellleft"><tt>CreateShellLink</tt></td>
          </tr>
          <tr>
            <td class="cellleft"><tt>GetOpenFileName</tt></td>
          </tr>
          <tr>
            <td class="cellleft"><tt>LoadDLL</tt></td>
            <td class="cellright">(см. следующий пункт)</td>
          </tr>
          <tr>
            <td class="cellleft"><tt>ModifyPifFile</tt></td>
          </tr>
          <tr>
            <td class="cellleft"><tt>SetCurrentDir</tt></td>
          </tr>
          <tr>
            <td class="cellleft"><tt>ShellExec</tt></td>
            <td class="cellright">(вместо этого используйте <tt>Exec</tt>)</td>
          </tr>
          <tr>
            <td class="cellleft"><tt>UnregisterFont</tt></td>
          </tr>
        </tbody>
      </table>
      <p>Ни один из VCL классов  не способен отключить перенаправление файловой системы. Например, Вы не можете вызвать метод <tt>LoadFromFile</tt> класса <tt>TBitmap</tt>, чтобы загрузить файл растровой графики из 64-разрядного каталога System.</p>
    </li>
    <li>Вы не можете загружать/использовать 64-разрядные динамические библиотеки в секции [Code], потому что Windows не позволяет 32-разрядным процессам загружать 64-разрядные DLL (и наоборот). 32-разрядный процесс, однако, может запустить 64-разрядные исполняемые файлы. Используйте функцию <tt>Exec</tt> или секцию [Run] для этих целей.</li>
  </ul>
</div>
</body>
</html>
