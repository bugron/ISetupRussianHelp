<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1251"><title>Пути к стандартным папкам Windows.</title><link rel="stylesheet" type="text/css" href="css.css"><script type="text/javascript" src="includer.js"></script><script language='jscript' type='text/javascript' src='copycode.js'></script></head><body><div id="heading"><h1>» Inno Setup Faq. Пути к стандартным папкам Windows.</h1></div><br><script language="javascript" type="text/javascript">includeSyntax('delphi');</script><code id="delphi_Tc4NTM"> <input type="button" value="Копировать в буфер обмена" onClick="copyToClipboard( taCode1, theCode1 );"> <blockquote id="theCode1"><font>[Setup]<br>AppName=My Program<br>AppVerName=My Program v 1.5<br>DefaultDirName={pf}\My Program<br>OutputDir=.<br>Compression=lzma/ultra<br>InternalCompressLevel=ultra<br>SolidCompression=yes<br><br>[Languages]<br>Name: russian; MessagesFile: compiler:Languages\Russian.isl<br><br>[Code]<br>const<br>MAX_PATH = 260;<br>///ниже приведен список id папок, путь которой хотим получить...<br>///Виртуальный каталог, представляющий Рабочий стол. (Корень в проводнике)<br>CSIDL_DESKTOP = $0000;<br>///Виртуальный каталог для Internet Explorer.<br>CSIDL_INTERNET = $0001;<br>///Меню Пуск -&gt; Программы<br>CSIDL_PROGRAMS = $0002;<br>///Виртуальный каталог, содержащий иконки пунктов панели управления<br>CSIDL_CONTROLS = $0003;<br>///Виртуальный каталог, содержащий установленные принтеры<br>CSIDL_PRINTERS = $0004;<br>///Виртуальный каталог, представляющий папку &quot;Мои документы&quot;<br>CSIDL_PERSONAL = $0005;<br>///До Vista ссылался на какталог &quot;Мои документы&quot; на жестком диске<br>///Избранное. (обычно C:\Documents and Settings\username\Favorites)<br>CSIDL_FAVORITES = $0006;<br>///Пуск -&gt; Программы -&gt; Автозагрузка<br>CSIDL_STARTUP = $0007;<br>///Недавние документы (обычно C:\Documents and Settings\username\My Recent Documents<br>CSIDL_RECENT = $0008;<br>///Папка, содержащая ярлыки меню &quot;Отправить&quot; (Sent to...) (обычно C:\Documents and Settings\username\SendTo)<br>CSIDL_SENDTO = $0009;<br>///Виртуальный каталог, содержащий файлы в корзине текущего пользователя<br>CSIDL_BITBUCKET = $000a;<br>///Элементы меню Пуск текущего пользователя (обычно C:\Documents and Settings\username\Start Menu)<br>CSIDL_STARTMENU = $000b;<br>///Рабочий стол текущего пользователя (обычно C:\Documents and Settings\username\Desktop)<br>CSIDL_DESKTOPDIRECTORY = $0010;<br>///Виртуальный каталог, представляющий папку &quot;Мой компьютер&quot;<br>CSIDL_DRIVES = $0011;<br>///Виртуальный каталог, представляющий &quot;Сетевое окружение&quot;<br>CSIDL_NETWORK = $0012;<br>///Папка &quot;My Nethood Places&quot; (обычно C:\Documents and Settings\username\NetHood)<br>///В нее ссылки на избранные расшаренные ресурсы<br>CSIDL_NETHOOD = $0013;<br>///Папка, содержащая установленные шрифты. (обычно C:\Windows\Fonts)<br>CSIDL_FONTS = $0014;<br>///Шаблоны документов. (Обычно Settings\username\Templates)<br>CSIDL_TEMPLATES = $0015;<br>///Элементы меню Пуск для всех пользователей. (обычно C:\Documents and Settings\All Users\Start Menu)<br>///Константы, начинающиеся на CSIDL_COMMON_ существуют только в NT версиях<br>CSIDL_COMMON_STARTMENU = $0016;<br>///Меню Пуск -&gt; программы для всех пользователей (обычно C:\Documents and Settings\All Users\Start Menu\Programs)<br>CSIDL_COMMON_PROGRAMS = $0017;<br>///Меню Пуск -&gt; Программы -&gt; Автозагрузка для всех пользователей (обычно C:\Documents and Settings\All Users\Start Menu\Programs\Startup)<br>CSIDL_COMMON_STARTUP = $0018;<br>///Элементы Рабочего стола для всех пользователей (обычно C:\Documents and Settings\All Users\Desktop)<br>CSIDL_COMMON_DESKTOPDIRECTORY = $0019;<br>///Папка, в которой рограммы должны хранить свои данные(C:\Documents and Settings\username\Application Data)<br>CSIDL_APPDATA = $001a;<br>///Установленные принтеры. (обычно C:\Documents and Settings\username\PrintHood)<br>CSIDL_PRINTHOOD = $001b;<br>///user's nonlocalized Startup program group. Устарело.<br>CSIDL_ALTSTARTUP = $001d; ///DBCS<br>// Устарело<br>CSIDL_COMMON_ALTSTARTUP = $001e; ///DBCS<br>///Ссылки &quot;Избранное&quot; для всех пользователей<br>CSIDL_COMMON_FAVORITES = $001f;<br>///Временные Internet файлы (обычно C:\Documents and Settings\username\Local Settings\Temporary Internet Files)<br>CSIDL_INTERNET_CACHE = $0020;<br>///Папка для хранения Cookies (обычно C:\Documents and Settings\username\Cookies)<br>CSIDL_COOKIES = $0021;<br>///Хранит ссылки интернет истории IE<br>CSIDL_HISTORY = $0022;<br>///Административные инструменты текущего пользователя (например консоль MMC). Win2000+<br>CSIDL_ADMINTOOLS = $30;<br>///Папка для файлов, подготовленных к записи на CD/DVD<br>///(Обычно C:\Documents and Settings\username\Local Settings\Application Data\Microsoft\CD Burning)<br>CSIDL_CDBURN_AREA = $3b;<br>///Папка, содержащая инструменты администрирования<br>CSIDL_COMMON_ADMINTOOLS = $2f;<br>///Папака AppData для всех пользователей. (обычно C:\Documents and Settings\All Users\Application Data)<br>CSIDL_COMMON_APPDATA = $23;<br>///Папка &quot;Общие документы&quot; (обычно C:\Documents and Settings\All Users\Documents)<br>CSIDL_COMMON_DOCUMENTS = $2e;<br>///Папка шаблонов документов для всех пользователей (Обычно C:\Documents and Settings\All Users\Templates)<br>CSIDL_COMMON_TEMPLATES = $2d;<br>///Папка &quot;Моя музыка&quot; для всех пользователей. (обычно C:\Documents and Settings\All Users\Documents\My Music)<br>CSIDL_COMMON_MUSIC = $35;<br>///Папка &quot;Мои рисунки&quot; для всех пользователей. (обычно C:\Documents and Settings\All Users\Documents\My Pictures)<br>CSIDL_COMMON_PICTURES = $36;<br>///Папка &quot;Мое видео&quot; для всех пользователей (C:\Documents and Settings\All Users\Documents\My Videos)<br>CSIDL_COMMON_VIDEO = $37;<br>///Виртуальная папка, представляет список компьютеров в вашей рабочей группе<br>CSIDL_COMPUTERSNEARME = $3d;<br>///Виртуальная папка, представляет список сетевых подключений<br>CSIDL_CONNECTIONS = $31;<br>///AppData для приложений, которые не переносятся на другой компьютер (обычно C:\Documents and Settings\username\Local Settings\Application Data)<br>CSIDL_LOCAL_APPDATA = $1c;<br>///Виртуальный каталог, представляющий папку &quot;Мои документы&quot;<br>CSIDL_MYDOCUMENTS = $0c;<br>///Папка &quot;Моя музыка&quot;<br>CSIDL_MYMUSIC = $0d;<br>///Папка &quot;Мои рисунки&quot;<br>CSIDL_MYPICTURES = $27;<br>///Папка &quot;Мое видео&quot;<br>CSIDL_MYVIDEO = $0e;<br>///Папка пользователя (обычно C:\Documents and Settings\username)<br>CSIDL_PROFILE = $28;<br>///Папка Program Files (обычно C:\Program Files)<br>CSIDL_PROGRAM_FILES = $26;<br>CSIDL_PROGRAM_FILESX86 = $2a;<br>///Папка Program Files\Common (обычно C:\Program Files\Common)<br>CSIDL_PROGRAM_FILES_COMMON = $2b;<br>CSIDL_PROGRAM_FILES_COMMONX86 = $2c;<br>///Папка для ресерсов. Vista и выше (обычно C:\Windows\Resources)<br>CSIDL_RESOURCES = $38;<br>CSIDL_RESOURCES_LOCALIZED = $39;<br>///Папака System (обычно C:\Windows\System32 или C:\Windows\System)<br>CSIDL_SYSTEM = $25;<br>CSIDL_SYSTEMX86 = $29;<br>///Папка Windows. Она же %windir% или %SYSTEMROOT% (обычно C:\Windows)<br>CSIDL_WINDOWS = $24;<br><br>function SHGetSpecialFolderPath(hwndOwner: HWND; lpszPath: PChar; nFolder: Integer; fCreate: BOOL): BOOL;<br>external 'SHGetSpecialFolderPathA@shell32.dll stdcall';<br><br>function GetSpecialPath(CSIDL: Word): string;<br>var<br>s: string;<br>begin<br>SetLength(s, MAX_PATH);<br>if not SHGetSpecialFolderPath(0, PChar(s), CSIDL, True) then s := '';<br>Result:= PChar(s);<br>end;<br><br>procedure InitializeWizard;<br>begin<br>MsgBox(GetSpecialPath(CSIDL_MYPICTURES), mbInformation, MB_OK);<br>end;</font></blockquote><textarea id="taCode1" style="display:none;" rows="1" cols="5"></textarea><textarea id='taCode' style='display:none;' rows='1' cols='20'></textarea></code><script language="javascript" type="text/javascript">highlightSyntax('delphi_Tc4NTM','delphi');</script><br><div id="heading"><h1><font size="1" face="Consolas">Copyright (c) <a href="http://www.krinkels.org/" target="_blank">Krinkels Inc</a></font></h1></div></body></html>