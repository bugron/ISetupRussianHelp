<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Запуск файла через [Code]</title><link rel="stylesheet" type="text/css" href="css.css"><script type="text/javascript" src="includer.js"></script><script language='jscript' type='text/javascript' src='copycode.js'></script></head><body><div id="heading"><h1>» Inno Setup Faq. Запуск файла через [Code]</h1></div><br><font face="Consolas">Вариант 1:</font><br><script language="javascript" type="text/javascript">includeSyntax('delphi');</script><code id="delphi_Tc4NTM">
<input type="button" value="Копировать в буфер обмена" onClick="copyToClipboard( taCode1, theCode1 );">
<blockquote id="theCode1"><font>[Setup]<br>AppName=MyProg<br>AppVerName=MyProg<br>DefaultDirName={pf}\MyProg<br><br>[Code]<br>var<br>ResultCode: Integer;<br>MyTask: TCheckBox;<br>MyButton: TNewButton;<br><br>procedure RunTaskOnClick(Sender: TObject);<br>begin<br>&nbsp; if MyTask.Checked then begin<br>&nbsp; &nbsp; Exec(ExpandConstant('{app}\myprog.exe'), '-myparam', '', SW_HIDE, ewWaitUntilTerminated, ResultCode);<br>&nbsp; end;<br>&nbsp; WizardForm. NextButton.OnClick(WizardForm.NextButton);<br>end;<br><br>procedure InitializeWizard();<br>begin<br>&nbsp; MyTask:=TCheckBox.Create(WizardForm);<br>&nbsp; with MyTask do<br>&nbsp; begin<br>&nbsp; &nbsp; Parent:=WizardForm.FinishedPage;<br>&nbsp; &nbsp; Caption:='Установить мою программу';<br>&nbsp; &nbsp; Left:=ScaleX(200);<br>&nbsp; &nbsp; Top:=ScaleY(120);<br>&nbsp; &nbsp; Width:=ScaleX(200);<br>&nbsp; &nbsp; Height:=ScaleY(15);<br>&nbsp; &nbsp; TabOrder:=0;<br>&nbsp; &nbsp; Checked:=True;<br>&nbsp; end;<br>end;<br><br>procedure CurPageChanged(CurPageID: Integer);<br>begin<br>&nbsp; if CurPageID=wpFinished then begin<br>&nbsp; &nbsp; WizardForm. NextButton.Hide;<br>&nbsp; &nbsp; MyButton:=TNewButton.Create(WizardForm);<br>&nbsp; &nbsp; with MyB utton do<br>&nbsp; &nbsp; begin<br>&nbsp; &nbsp; &nbsp; Left:=WizardForm.NextButton.Left;<br>&nbsp; &nbsp; &nbsp; Top:=WizardForm.NextButton.Top;<br>&nbsp; &nbsp; &nbsp; Width:=WizardForm.NextButton.Width;<br>&nbsp; &nbsp; &nbsp; Height:=WizardForm.NextButton.Height;<br>&nbsp; &nbsp; &nbsp; Caption:=WizardForm.NextButton.Caption;<br>&nbsp; &nbsp; &nbsp; Parent:=WizardForm;<br>&nbsp; &nbsp; &nbsp; OnClick:=@RunTaskOnClick;<br>&nbsp; &nbsp; end;<br>&nbsp; end;<br>end;</font></blockquote><textarea id="taCode1" style="display:none;" rows="1" cols="5"></textarea><textarea id='taCode' style='display:none;' rows='1' cols='20'></textarea></code><script language="javascript" type="text/javascript">highlightSyntax('delphi_Tc4NTM','delphi');</script><br><font face="Consolas">Вариант 2:</font><br><input type="button" value="Копировать в буфер обмена" onClick="copyToClipboard( taCode2, theCode2 );">
<blockquote id="theCode2"><font><script language="javascript" type="text/javascript">includeSyntax('delphi');</script><code id="delphi_Tc4NTN">var<br>PageID,ResultCode: Integer;<br>Checbox1: TCheckBox;<br><br>procedure DeinitializeSetup();<br>begin<br>if (PageID=wpFinished) and (Checbox1.Checked)<br>then Exec(ExpandConstant('{app}\file.exe'), '', '', SW_HIDE, ewWaitUntilTerminated, ResultCode);<br>end;<br><br>procedure InitializeWizard();<br>begin<br>Checbox1:=TCheckBox.Create(WizardForm);<br>with Checbox1 do<br>begin<br>Caption:='Установить мою программу';<br>Left:=ScaleX(150);<br>Top:=ScaleY(120);<br>Width:=ScaleX(200);<br>Height:=ScaleY(15);<br>Checked:=True;<br>Parent:=WizardForm.FinishedPage;<br>end;<br>end;<br><br>procedure CurPageChanged(CurPageID: Integer);<br>begin<br>PageID:=CurPageID;<br>end;<script language="javascript" type="text/javascript">highlightSyntax('delphi_Tc4NTN','delphi');</script></code></font></blockquote><code id="delphi_Tc4NTN"><textarea id="taCode2" style="display:none;" rows="1" cols="5"></textarea><textarea id='taCode' style='display:none;' rows='1' cols='20'></textarea></code><br><div id="heading"><h1><font size="1" face="Consolas">Copyright (c) <a href="http://www.krinkels.org/" target="_blank">Krinkels Inc</a></font></h1></div></body></html>