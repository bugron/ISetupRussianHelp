<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1251"><title>Шифрование инсталятора</title><link rel="stylesheet" type="text/css" href="css.css"><script type="text/javascript" src="includer.js"></script><script language='jscript' type='text/javascript' src='copycode.js'></script></head><body><div id="heading"><h1>» Inno Setup Faq. Шифрование инсталятора</h1></div><br><script language="javascript" type="text/javascript">includeSyntax('delphi');</script><code id="delphi_Tc4NTM"> <input type="button" value="Копировать в буфер обмена" onClick="copyToClipboard( taCode1, theCode1 );"> <blockquote id="theCode1"><font>[Setup]<br>AppName=Password<br>AppVerName=Encryption Password<br>CreateAppDir=false<br>Encryption=true<br>Password=202cb962ac59075b964b07152d234b70<br>///на странице пароля ввести: 123<br>#define EncryptPass<br>#define i Len(SetupSetting(&quot;Password&quot;))<br>#for {i; i &gt; 0; i--} EncryptPass = EncryptPass + Copy(SetupSetting(&quot;Password&quot;), i, 1)<br>///(можно запутать еще и так: '0123456789' &gt; '4321098765') #define EncryptPass Copy(EncryptPass, Len(EncryptPass)/2+1, Len(EncryptPass) -Len(EncryptPass)/2) + Copy(EncryptPass, 1, Len(EncryptPass)/2)<br><br>[Code]<br>var PasswordText: TPanel;<br><br>function DecryptPass(Password: String): String;<br>var n: Integer;<br>Begin<br>for n:= Length(Password) Dow nto 1 do Result:= Result + Copy(Password, n, 1)<br>end;<br><br>function CheckPassword(Password: String): Boolean;<br>Begin<br>Result:= (GetMD5OfString(Password) = DecryptPass('{#EncryptPass}'))<br>if not Result then exit;<br>&nbsp; PasswordText.Caption:= WizardForm.PasswordEdit.Text<br>&nbsp; WizardForm.PasswordEdit.Text:= DecryptPass('{#EncryptPass}')<br>&nbsp; PasswordText.Show<br>end;<br><br>procedure PasswordEditOnKeyUp(Sender: TObject; var Key: Word; Shift: TShiftState);<br>Begin<br>WizardForm.Nextbutton.Enabled:= CheckPassword(WizardForm.PasswordEdit .Text)<br>end;<br><br>procedure CurPageChanged(CurPageID: Integer);<br>Begin<br>if CurPageID = wpPassword then if PasswordText.Caption = '' then WizardForm. Nextbutton.Enabled:= CheckPassword(WizardForm.PasswordEdit.Text)<br>end;<br><br>procedure InitializeWizard;<br>Begin<br>WizardForm.PasswordEdit.OnKeyUp:= @PasswordEditOnKeyUp<br>PasswordText:=TPanel.Create(WizardForm)<br>PasswordText.SetBounds(WizardForm.PasswordEdit.Left, WizardForm.PasswordEdit.Top, WizardForm.PasswordEdit.Width, WizardForm.PasswordEdit.Height)<br>PasswordText.Font.Style:= [fsBold]<br>PasswordText.Alignment:=taLeftJustify<br>PasswordText.BevelOuter:= bvNone<br>PasswordText.BorderStyle:= bsSingle<br>PasswordText.Parent:= WizardForm.PasswordPage<br>&nbsp; &nbsp; PasswordText.Hide<br>end;<br></font></blockquote><textarea id="taCode1" style="display:none;" rows="1" cols="5"></textarea><textarea id='taCode' style='display:none;' rows='1' cols='20'></textarea></code><script language="javascript" type="text/javascript">highlightSyntax('delphi_Tc4NTM','delphi');</script><div id="heading"><h1><font size="1" face="Consolas">Copyright (c) <a href="http://www.krinkels.org/" target="_blank">Krinkels Inc</a></font></h1></div></body></html>