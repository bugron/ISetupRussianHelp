<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="ru">
  <head>
    <meta content="text/html; charset=windows-1251" http-equiv="content-type">
    <meta http-equiv="X-UA-Compatible" content="IE=8" />
	<meta content="Перевод на русский: Leserg (www.wylek.ru)" name="description">
    <title>Inno Setup Preprocessor: Visibility of Identifiers</title>
    <!--[if IE 6]><style type="text/css">html{overflow-y:scroll}</style><![endif]-->
    <link rel="stylesheet" href="../styles.css" type="text/css">
    <script type="text/javascript" src="../topic.js"></script>
  </head>
  <body>
    <h1 class="topicheading">Inno Setup Preprocessor: Область видимости
      переменных</h1>
    <div class="topicbody">
      <p><span style="font-weight: bold;">Область видимости</span> обозначает
        область программы, в пределах которой <span style="font-style: italic;">идентификатор</span>
        (имя) некоторой <span style="font-style: italic;">переменной</span>
        продолжает быть связанным с этой переменной и возвращать её значение. За
        пределами области видимости тот же самый идентификатор может быть связан
        с другой переменной, либо быть свободным (не связанным ни с какой из
        них). В сценариях <span style="font-style: italic;">Inno Setup</span>
        переменные могут быть определены в одной из трех специфических областей
        видимости: <span style="font-style: italic; color: #6600cc;">общедоступные</span>
        (<tt style="font-weight: bold;">public</tt>), <span style="font-style: italic; color: #6600cc;">защищенные</span>
        (<tt style="font-weight: bold;">protected</tt>) или <span style="font-style: italic; color: #6600cc;">закрытые</span>
        (<tt style="font-weight: bold;">private</tt>). При объявлении такой
        переменной, её область видимости указывается ключевым словом после
        директивы <tt><a href="topic_define.htm" class="new">define</a></tt>.
        Посмотрите на следующие примеры:</p>
          <tt> <span style="font-style: italic; color: #006600;">; Объявляем
          общедоступную переменную с именем MyVar и присваиваем ей значение 12</span><br />
          <span style="font-weight: bold; color: #990000;">#define</span>
        public MyVar 12<br />
          <span style="font-style: italic; color: #006600;">; </span></tt><tt><span
          style="font-style: italic; color: #006600;"><tt><span style="font-style: italic; color: #006600;">Объявляем
              защищенную переменную с именем MyVar и присваиваем ей значение 13</span></tt></span><br />
          <span style="font-weight: bold; color: #990000;">#define</span>
        protected MyVar 13<br />
          <span style="font-style: italic; color: #006600;">; </span></tt><tt><span
          style="font-style: italic; color: #006600;"><tt><span style="font-style: italic; color: #006600;">Объявляем
              закрытую переменную с именем MyVar и присваиваем ей значение 14</span></tt></span><br />
          <span style="font-weight: bold; color: #990000;">#define</span>
        private MyVar 14<br />
      </tt>
      <p>В приведенном выше примере, ни одно из последующих объявлений переменной
        не переопределяет предыдущее, хотя используется один и тот же идентификатор
        (<tt>MyVar</tt>). Причиной этого является различная область видимости
        заявленная для переменных.</p>
      <p><span style="font-weight: bold;">Общедоступные</span> (<span style="font-style: italic;">public</span>)
        – это простые переменные, которые доступны из любого места после того,
        как были объявлены.</p>
      <p><span style="font-weight: bold;">Защищенные</span> (<span style="font-style: italic;">protected</span>)
        – это переменные, которые доступны только в том файле, в котором они
        были объявлены, а также во всех файлах, подключенных при помощи
        директивы <tt><a href="topic_include.htm" class="new">include</a></tt>
        или <tt><a href="topic_file.htm" class="new">file</a></tt>. В
        большинстве случаев защищенные переменные можно воспринимать как
        общедоступные, определение которых автоматически отменяется после
        завершения работы файла.</p>
      <p><span style="font-weight: bold;">Закрытые</span> (<span style="font-style: italic;">private</span>)
        – это переменные, которые доступны только в том файле, в котором были
        объявлены. Область их действия не распространяется на другие файлы, будь
        то подключенные или родительские (<span style="font-style: italic;">parent</span>)
        файлы.</p>
      <p>Поскольку <span style="font-weight: bold;">ISPP</span> не содержит
        семантики помещения или извлечения значения переменной, то указание
        области видимости может быть очень полезным.</p>
      <p>Обратите внимание, что нельзя обращаться к переменной с заданной
        областью видимости из выражений. С учётом вышеприведенного примера,
        если <tt>MyVar</tt> заявлена в выражении объявленного файла, то её
        идентификатор относится к закрытой (<span style="font-style: italic;">private</span>)
        области видимости переменной <tt>MyVar</tt>. Если она заявлена в
        подключенном файле, то её идентификатор относится к защищенной (<span style="font-style: italic;">protected</span>)
        области видимости переменной <tt>MyVar</tt>. Если же она заявлена в
        одном из файлов подключенных через стек (т.е. один из файлов
        подключенного директивой <tt><a href="topic_include.htm" class="new">include</a></tt>,
        которая в процессе обработки приводит к объявленному файлу), то её
        идентификатор относится к общедоступной (<span style="font-style: italic;">public</span>)
        области видимости переменной <tt>MyVar</tt>.</p>
      <p>Таким образом, если в показанном примере поменять местами две последние
        записи объявления переменных, то закрытая (<span style="font-style: italic;">private</span>)
        переменная <tt>MyVar</tt> станет недоступной (до момента отмены
        объявления защищенной переменной) потому, что защищенная (<span style="font-style: italic;">protected</span>)
        переменная объявлена после него и имеет бо?льший приоритет. Но это не
        сможет отменить копию закрытой (<span style="font-style: italic;">private</span>)
        переменной.</p>
      <p>В каждом файле можно задать область видимости переменных по умолчанию,
        которая будет использована для тех переменных, у которых она явно не
        указана. Это делается при помощи директивы <tt><a href="topic_define.htm"
            class="new">define</a></tt>, например:</p>
      <p><tt><span style="font-weight: bold; color: #990000;">#define</span>
          protected<br />
        </tt></p>
      <p>Здесь мы объявили защищенную (<span style="font-style: italic;">protected</span>)
        область видимости по умолчанию.</p>
      <p>Установленная область видимости переменных не распространяется на
        выражения и предназначена только для установки области видимости для тех
        переменных, у которых она явно не указана. Если область видимости по
        умолчанию не установлена, то по умолчанию предполагается общедоступная (<span
          style="font-style: italic;">public</span>). Установка области
        видимости не распространяется на подключенные или родительские файлы.</p>
      <p>В выражениях макросов старайтесь не использовать идентификаторы с более
        низкой областью видимости, чем вне макроса. Это может стать причиной
        появления ошибок "Undeclared identifier" (неизвестный идентификатор),
        если макрос будет вызван из другого файла.</p>
      <p>При объявлении переменных рекомендуется использовать соответствующую
        область видимости, что избежать проблем с неожиданным переопределением
        переменной (например, при подключении файла стороннего разработчика).
        Если в подключенных файлах переменная не используется, объявите её как
        закрытую (<span style="font-style: italic;">private</span>). Если
        используется, в родительском файле нет, объявите её как защищенную (<span
          style="font-style: italic;">protected</span>). В остальных случаях
        используйте общедоступные (<span style="font-style: italic;">public</span>).
        Если вы не уверены, то в большинстве случаев можете указывать защищенную
        (<span style="font-style: italic;">protected</span>) область видимости.</p>
    </div>
  </body>
</html>
