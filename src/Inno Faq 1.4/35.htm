<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1251"><title>Дата и время компиляции</title><link rel="stylesheet" type="text/css" href="css.css"><script type="text/javascript" src="includer.js"></script><script language='jscript' type='text/javascript' src='copycode.js'></script></head><body><div id="heading"><h1>» Inno Setup Faq. Дата и время компиляции</h1></div>

<br>Вариант 1:<br>

<script language="javascript" type="text/javascript">includeSyntax('delphi');</script><code id="delphi_Tc4NTM">
<input type="button" value="Копировать в буфер обмена" onClick="copyToClipboard( taCode1, theCode1 );">
<blockquote id="theCode1"><font>#expr Exec(&quot;cmd /c echo #define DateTime '%DATE% %TIME%' &gt; data.iss&quot;)<br>#include &quot;data.iss&quot;<br><br>#define MyAppVerName &quot;My Program version 1.5 from &quot; + DateTime<br><br>[Setup]<br>AppName=My Program<br>AppVerName={#MyAppVerName}<br>DefaultDirName={pf}\My Program<br><br>[Files]<br>Source: Files\*; DestDir: {app}<br><br>[Code]<br>function InitializeSetup(): Boolean;<br>begin<br>MsgBox('Copyright © 2007, ' + ExpandConstant('{#MyAppVerName}'), mbInformation, mb_Ok);<br>Result:= True;<br>end;</font></blockquote><textarea id="taCode1" style="display:none;" rows="1" cols="5"></textarea><textarea id='taCode' style='display:none;' rows='1' cols='20'></textarea></code><script language="javascript" type="text/javascript">highlightSyntax('delphi_Tc4NTM','delphi');</script>

<br>Вариант 2:<br>

<input type="button" value="Копировать в буфер обмена" onClick="copyToClipboard( taCode2, theCode2 );">
<blockquote id="theCode2"><script language="javascript" type="text/javascript">includeSyntax('delphi');</script><code id="delphi_Tc4NTN">[Setup]<br>AppName=My Program<br>AppVerName=My Program version 1.5<br>DefaultDirName={pf}\My Program<br><br>[Files]<br>Source: Files\*; DestDir: {app}<br><br>#include &quot;LangLib.iss&quot;<br><br>[Code]<br>type<br>&nbsp; TFileTime = record<br>&nbsp; &nbsp; lowdatatime: longint;<br>&nbsp; &nbsp; highdatatime: longint;<br>&nbsp; end;<br><br>&nbsp; TSystemTime = record<br>&nbsp; &nbsp; wYear : Word;<br>&nbsp; &nbsp; wMonth : Word;<br>&nbsp; &nbsp; wDayOfWeek : Word;<br>&nbsp; &nbsp; wDay : Word;<br>&nbsp; &nbsp; wHour : Word;<br>&nbsp; &nbsp; wMinute : Word;<br>&nbsp; &nbsp; wSecond : Word;<br>&nbsp; &nbsp; wMilliseconds : Word;<br>&nbsp; end;<br><br>function GetFileTime(hfile: longint; var lpcreation,lpaccess,lpwrite:TFileTime): boolean;<br>external 'GetFileTime@kernel32.dll stdcall';<br><br>function FileTimeToSystemTime(var tftm: TFileTime; var systm: TSystemTime): boolean;<br>external 'FileTimeToSystemTime@kernel32.dll stdcall';<br><br>function FileTimeToLocalFileTime( utct: TFileTime; var loct: TFileTime): boolean;<br>external 'FileTimeToLocalFileTime@kernel32.dll stdcall';<br><br>function GetDateFormat(Locale: Integer;dwFlags: LongInt;<br>&nbsp; var lpDate: TSystemTime; lpFormat: PAnsiChar; lpDateStr: String;<br>&nbsp; cchDate: Integer): Integer; external<br>&nbsp; 'GetDateFormatA@kernel32.dll';<br><br>function GetTimeFormat(Locale: Integer;dwFlags: LongInt;<br>&nbsp; var lpTime: TSystemTime;lpFormat: PAnsiChar;lpTimeStr: String;<br>&nbsp; cchDate: Integer): Integer; external<br>&nbsp; 'GetTimeFormatA@kernel32.dll';<br><br>var<br>&nbsp; strFile: string;<br>&nbsp; strCreTime: string;<br>&nbsp; strModTime: string;<br>&nbsp; strAccessTime: string;<br><br>function FormattedTime(t: TSystemTime) : String;<br>var<br>&nbsp; &nbsp; s, fmt: String;<br>begin<br>&nbsp; &nbsp; &nbsp; &nbsp; fmt := StringOfChar(' ',64);<br>&nbsp; &nbsp; &nbsp; &nbsp; GetDateFormat( GetUserDefaultLCID , DATE_LONGDATE, t, '' , fmt ,63);<br>&nbsp; &nbsp; &nbsp; &nbsp; fmt := CastIntegerToString(CastStringToInteger(fmt));<br><br>&nbsp; &nbsp; &nbsp; &nbsp; s := fmt;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; fmt := StringOfChar(' ',64);<br>&nbsp; &nbsp; &nbsp; &nbsp; GetTimeFormat(GetUserDefaultLCID , 0, t , '' , fmt ,63);<br>&nbsp; &nbsp; &nbsp; &nbsp; fmt := CastIntegerToString(CastStringToInteger(fmt));<br><br>&nbsp; &nbsp; &nbsp; &nbsp; s := s + ' ' + fmt;<br><br>&nbsp; &nbsp; Result := s;<br>end;<br><br>function GetFileSysTime(nomef: String ; var stime: String; idx : Integer ): TSystemTime;<br>Var<br>&nbsp; &nbsp; fs: TFileStream;<br>&nbsp; &nbsp; risul: TSystemTime;<br>&nbsp; &nbsp; creat, access, write, local: TFileTime;<br>Begin<br>&nbsp; &nbsp; fs := TFileStream.Create(nomef,fmOpenRead);<br>&nbsp; &nbsp; GetFileTime(fs.handle,creat,access,write);<br>&nbsp; &nbsp; fs.Free;<br>&nbsp; &nbsp; Case idx of<br>&nbsp; &nbsp; &nbsp; 1: FileTimeToLocalFileTime(creat,local);<br>&nbsp; &nbsp; &nbsp; 2: FileTimeToLocalFileTime(access,local);<br>&nbsp; &nbsp; &nbsp; 3: FileTimeToLocalFileTime(write,local);<br>&nbsp; &nbsp; end;<br>&nbsp; &nbsp; FileTimeToSystemTime(local,risul);<br>&nbsp; &nbsp; stime := FormattedTime(risul);<br>&nbsp; &nbsp; Result := risul;<br>end;<br><br>function InitializeSetup(): Boolean;<br>var<br>&nbsp; &nbsp; filename, s : String;<br>&nbsp; &nbsp; t&nbsp; : TSystemTime;<br>begin<br>&nbsp; &nbsp; filename:= ExpandConstant('{srcexe}');<br>&nbsp; &nbsp; &nbsp; &nbsp; strFile:= filename;<br>&nbsp; &nbsp; &nbsp; &nbsp; t := GetFileSysTime(filename, s, 1 );<br>&nbsp; &nbsp; &nbsp; &nbsp; strCreTime:= s;<br>&nbsp; &nbsp; &nbsp; &nbsp; t := GetFileSysTime(filename, s, 2 );<br>&nbsp; &nbsp; strAccessTime:= s;<br>&nbsp; &nbsp; t := GetFileSysTime(filename, s, 3 );<br>&nbsp; &nbsp; strModTime:= s;<br><br>&nbsp; MsgBox(strFile + #10#13 +<br>&nbsp; &nbsp; &nbsp; &nbsp; 'Создан: ' + strCreTime + #10#13 +<br>&nbsp; &nbsp; &nbsp; &nbsp; 'Открыт: ' + strAccessTime + #10#13 +<br>&nbsp; &nbsp; &nbsp; &nbsp; 'Изменен: ' + strModTime + #10#13, mbInformation, MB_OK);<br>&nbsp; Result:= True;<br>end;<script language="javascript" type="text/javascript">highlightSyntax('delphi_Tc4NTN','delphi');</script></code></blockquote><code id="delphi_Tc4NTN"><textarea id="taCode2" style="display:none;" rows="1" cols="5"></textarea><textarea id='taCode' style='display:none;' rows='1' cols='20'></textarea></code>


<br>LangLib.iss: <br>
<input type="button" value="Копировать в буфер обмена" onClick="copyToClipboard( taCode3, theCode3 );"><blockquote id="theCode3"><font style="BACKGROUND-COLOR: #ffffe3"><td class="code"><script language="javascript" type="text/javascript">includeSyntax('delphi');</script><code id="delphi_Tc4NTB">;;Language Libray<br><br><br>[Code]<br><br>type LCID = LongInt;<br>type LANGID = WORD;<br><br>///<br>///  Language IDs.<br>///<br>///  The following two combinations of primary language ID and<br>///  sublanguage ID have special semantics:<br>///<br>///    Primary Language ID  Sublanguage ID      Result<br>///    -------------------  ---------------    ------------------------<br>///    LANG_NEUTRAL          SUBLANG_NEUTRAL    Language neutral<br>///    LANG_NEUTRAL          SUBLANG_DEFAULT    User default language<br>///    LANG_NEUTRAL          SUBLANG_SYS_DEFAULT System default language<br>///<br><br>///<br>///  Primary language IDs.<br>///<br><br>Const LANG_NEUTRAL                    = $00;<br><br>Const LANG_AFRIKAANS                  = $36;<br>Const LANG_ALBANIAN                    = $1c;<br>Const LANG_ARABIC                      = $01;<br>Const LANG_ARMENIAN                    = $2b;<br>Const LANG_ASSAMESE                    = $4d;<br>Const LANG_AZERI                      = $2c;<br>Const LANG_BASQUE                      = $2d;<br>Const LANG_BELARUSIAN                  = $23;<br>Const LANG_BENGALI                    = $45;<br>Const LANG_BULGARIAN                  = $02;<br>Const LANG_CATALAN                    = $03;<br>Const LANG_CHINESE                    = $04;<br>Const LANG_CROATIAN                    = $1a;<br>Const LANG_CZECH                      = $05;<br>Const LANG_DANISH                      = $06;<br>Const LANG_DUTCH                      = $13;<br>Const LANG_ENGLISH                    = $09;<br>Const LANG_ESTONIAN                    = $25;<br>Const LANG_FAEROESE                    = $38;<br>Const LANG_FARSI                      = $29;<br>Const LANG_FINNISH                    = $0b;<br>Const LANG_FRENCH                      = $0c;<br>Const LANG_GEORGIAN                    = $37;<br>Const LANG_GERMAN                      = $07;<br>Const LANG_GREEK                      = $08;<br>Const LANG_GUJARATI                    = $47;<br>Const LANG_HEBREW                      = $0d;<br>Const LANG_HINDI                      = $39;<br>Const LANG_HUNGARIAN                  = $0e;<br>Const LANG_ICELANDIC                  = $0f;<br>Const LANG_INDONESIAN                  = $21;<br>Const LANG_ITALIAN                    = $10;<br>Const LANG_JAPANESE                    = $11;<br>Const LANG_KANNADA                    = $4b;<br>Const LANG_KASHMIRI                    = $60;<br>Const LANG_KAZAK                      = $3f;<br>Const LANG_KONKANI                    = $57;<br>Const LANG_KOREAN                      = $12;<br>Const LANG_LATVIAN                    = $26;<br>Const LANG_LITHUANIAN                  = $27;<br>Const LANG_MACEDONIAN                  = $2f;<br>Const LANG_MALAY                      = $3e;<br>Const LANG_MALAYALAM                  = $4c;<br>Const LANG_MANIPURI                    = $58;<br>Const LANG_MARATHI                    = $4e;<br>Const LANG_NEPALI                      = $61;<br>Const LANG_NORWEGIAN                  = $14;<br>Const LANG_ORIYA                      = $48;<br>Const LANG_POLISH                      = $15;<br>Const LANG_PORTUGUESE                  = $16;<br>Const LANG_PUNJABI                    = $46;<br>Const LANG_ROMANIAN                    = $18;<br>Const LANG_RUSSIAN                    = $19;<br>Const LANG_SANSKRIT                    = $4f;<br>Const LANG_SERBIAN                    = $1a;<br>Const LANG_SINDHI                      = $59;<br>Const LANG_SLOVAK                      = $1b;<br>Const LANG_SLOVENIAN                  = $24;<br>Const LANG_SPANISH                    = $0a;<br>Const LANG_SWAHILI                    = $41;<br>Const LANG_SWEDISH                    = $1d;<br>Const LANG_TAMIL                      = $49;<br>Const LANG_TATAR                      = $44;<br>Const LANG_TELUGU                      = $4a;<br>Const LANG_THAI                        = $1e;<br>Const LANG_TURKISH                    = $1f;<br>Const LANG_UKRAINIAN                  = $22;<br>Const LANG_URDU                        = $20;<br>Const LANG_UZBEK                      = $43;<br>Const LANG_VIETNAMESE                  = $2a;<br><br>///<br>///  Sublanguage IDs.<br>///<br>///  The name immediately following SUBLANG_ dictates which primary<br>///  language ID that sublanguage ID can be combined with to form a<br>///  valid language ID.<br>///<br><br>Const SUBLANG_NEUTRAL                  = $00;    ///language neutral<br>Const SUBLANG_DEFAULT                  = $01;    ///user default<br>Const SUBLANG_SYS_DEFAULT              = $02;    ///system default<br><br>Const SUBLANG_ARABIC_SAUDI_ARABIA      = $01;    ///Arabic (Saudi Arabia)<br>Const SUBLANG_ARABIC_IRAQ              = $02;    ///Arabic (Iraq)<br>Const SUBLANG_ARABIC_EGYPT            = $03;    ///Arabic (Egypt)<br>Const SUBLANG_ARABIC_LIBYA            = $04;    ///Arabic (Libya)<br>Const SUBLANG_ARABIC_ALGERIA          = $05;    ///Arabic (Algeria)<br>Const SUBLANG_ARABIC_MOROCCO          = $06;    ///Arabic (Morocco)<br>Const SUBLANG_ARABIC_TUNISIA          = $07;    ///Arabic (Tunisia)<br>Const SUBLANG_ARABIC_OMAN              = $08;    ///Arabic (Oman)<br>Const SUBLANG_ARABIC_YEMEN            = $09;    ///Arabic (Yemen)<br>Const SUBLANG_ARABIC_SYRIA            = $0a;    ///Arabic (Syria)<br>Const SUBLANG_ARABIC_JORDAN            = $0b;    ///Arabic (Jordan)<br>Const SUBLANG_ARABIC_LEBANON          = $0c;    ///Arabic (Lebanon)<br>Const SUBLANG_ARABIC_KUWAIT            = $0d;    ///Arabic (Kuwait)<br>Const SUBLANG_ARABIC_UAE              = $0e;    ///Arabic (U.A.E)<br>Const SUBLANG_ARABIC_BAHRAIN          = $0f;    ///Arabic (Bahrain)<br>Const SUBLANG_ARABIC_QATAR            = $10;    ///Arabic (Qatar)<br>Const SUBLANG_AZERI_LATIN              = $01;    ///Azeri (Latin)<br>Const SUBLANG_AZERI_CYRILLIC          = $02;    ///Azeri (Cyrillic)<br>Const SUBLANG_CHINESE_TRADITIONAL      = $01;    ///Chinese (Taiwan Region)<br>Const SUBLANG_CHINESE_SIMPLIFIED      = $02;    ///Chinese (PR China)<br>Const SUBLANG_CHINESE_HONGKONG        = $03;    ///Chinese (Hong Kong)<br>Const SUBLANG_CHINESE_SINGAPORE        = $04;    ///Chinese (Singapore)<br>Const SUBLANG_CHINESE_MACAU            = $05;    ///Chinese (Macau)<br>Const SUBLANG_DUTCH                    = $01;    ///Dutch<br>Const SUBLANG_DUTCH_BELGIAN            = $02;    ///Dutch (Belgian)<br>Const SUBLANG_ENGLISH_US              = $01;    ///English (USA)<br>Const SUBLANG_ENGLISH_UK              = $02;    ///English (UK)<br>Const SUBLANG_ENGLISH_AUS              = $03;    ///English (Australian)<br>Const SUBLANG_ENGLISH_CAN              = $04;    ///English (Canadian)<br>Const SUBLANG_ENGLISH_NZ              = $05;    ///English (New Zealand)<br>Const SUBLANG_ENGLISH_EIRE            = $06;    ///English (Irish)<br>Const SUBLANG_ENGLISH_SOUTH_AFRICA    = $07;    ///English (South Africa)<br>Const SUBLANG_ENGLISH_JAMAICA          = $08;    ///English (Jamaica)<br>Const SUBLANG_ENGLISH_CARIBBEAN        = $09;    ///English (Caribbean)<br>Const SUBLANG_ENGLISH_BELIZE          = $0a;    ///English (Belize)<br>Const SUBLANG_ENGLISH_TRINIDAD        = $0b;    ///English (Trinidad)<br>Const SUBLANG_ENGLISH_ZIMBABWE        = $0c;    ///English (Zimbabwe)<br>Const SUBLANG_ENGLISH_PHILIPPINES      = $0d;    ///English (Philippines)<br>Const SUBLANG_FRENCH                  = $01;    ///French<br>Const SUBLANG_FRENCH_BELGIAN          = $02;    ///French (Belgian)<br>Const SUBLANG_FRENCH_CANADIAN          = $03;    ///French (Canadian)<br>Const SUBLANG_FRENCH_SWISS            = $04;    ///French (Swiss)<br>Const SUBLANG_FRENCH_LUXEMBOURG        = $05;    ///French (Luxembourg)<br>Const SUBLANG_FRENCH_MONACO            = $06;    ///French (Monaco)<br>Const SUBLANG_GERMAN                  = $01;    ///German<br>Const SUBLANG_GERMAN_SWISS            = $02;    ///German (Swiss)<br>Const SUBLANG_GERMAN_AUSTRIAN          = $03;    ///German (Austrian)<br>Const SUBLANG_GERMAN_LUXEMBOURG        = $04;    ///German (Luxembourg)<br>Const SUBLANG_GERMAN_LIECHTENSTEIN    = $05;    ///German (Liechtenstein)<br>Const SUBLANG_ITALIAN                  = $01;    ///Italian<br>Const SUBLANG_ITALIAN_SWISS            = $02;    ///Italian (Swiss)<br>Const SUBLANG_KASHMIRI_INDIA          = $02;    ///Kashmiri (India)<br>Const SUBLANG_KOREAN                  = $01;    ///Korean (Extended Wansung)<br>Const SUBLANG_LITHUANIAN              = $01;    ///Lithuanian<br>Const SUBLANG_LITHUANIAN_CLASSIC      = $02;    ///Lithuanian (Classic)<br>Const SUBLANG_MALAY_MALAYSIA          = $01;    ///Malay (Malaysia)<br>Const SUBLANG_MALAY_BRUNEI_DARUSSALAM  = $02;    ///Malay (Brunei Darussalam)<br>Const SUBLANG_NEPALI_INDIA            = $02;    ///Nepali (India)<br>Const SUBLANG_NORWEGIAN_BOKMAL        = $01;    ///Norwegian (Bokmal)<br>Const SUBLANG_NORWEGIAN_NYNORSK        = $02;    ///Norwegian (Nynorsk)<br>Const SUBLANG_PORTUGUESE              = $02;    ///Portuguese<br>Const SUBLANG_PORTUGUESE_BRAZILIAN    = $01;    ///Portuguese (Brazilian)<br>Const SUBLANG_SERBIAN_LATIN            = $02;    ///Serbian (Latin)<br>Const SUBLANG_SERBIAN_CYRILLIC        = $03;    ///Serbian (Cyrillic)<br>Const SUBLANG_SPANISH                  = $01;    ///Spanish (Castilian)<br>Const SUBLANG_SPANISH_MEXICAN          = $02;    ///Spanish (Mexican)<br>Const SUBLANG_SPANISH_MODERN          = $03;    ///Spanish (Modern)<br>Const SUBLANG_SPANISH_GUATEMALA        = $04;    ///Spanish (Guatemala)<br>Const SUBLANG_SPANISH_COSTA_RICA      = $05;    ///Spanish (Costa Rica)<br>Const SUBLANG_SPANISH_PANAMA          = $06;    ///Spanish (Panama)<br>Const SUBLANG_SPANISH_DOMINICAN_REPUBLIC = $07;  ///Spanish (Dominican Republic)<br>Const SUBLANG_SPANISH_VENEZUELA        = $08;    ///Spanish (Venezuela)<br>Const SUBLANG_SPANISH_COLOMBIA        = $09;    ///Spanish (Colombia)<br>Const SUBLANG_SPANISH_PERU            = $0a;    ///Spanish (Peru)<br><br>Const SUBLANG_SPANISH_ARGENTINA        = $0b;    ///Spanish (Argentina)<br>Const SUBLANG_SPANISH_ECUADOR          = $0c;    ///Spanish (Ecuador)<br>Const SUBLANG_SPANISH_CHILE            = $0d;    ///Spanish (Chile)<br>Const SUBLANG_SPANISH_URUGUAY          = $0e;    ///Spanish (Uruguay)<br>Const SUBLANG_SPANISH_PARAGUAY        = $0f;    ///Spanish (Paraguay)<br>Const SUBLANG_SPANISH_BOLIVIA          = $10;    ///Spanish (Bolivia)<br>Const SUBLANG_SPANISH_EL_SALVADOR      = $11;    ///Spanish (El Salvador)<br>Const SUBLANG_SPANISH_HONDURAS        = $12;    ///Spanish (Honduras)<br>Const SUBLANG_SPANISH_NICARAGUA        = $13;    ///Spanish (Nicaragua)<br>Const SUBLANG_SPANISH_PUERTO_RICO      = $14;    ///Spanish (Puerto Rico)<br>Const SUBLANG_SWEDISH                  = $01;    ///Swedish<br>Const SUBLANG_SWEDISH_FINLAND          = $02;    ///Swedish (Finland)<br>Const SUBLANG_URDU_PAKISTAN            = $01;    ///Urdu (Pakistan)<br>Const SUBLANG_URDU_INDIA              = $02;    ///Urdu (India)<br>Const SUBLANG_UZBEK_LATIN              = $01;    ///Uzbek (Latin)<br>Const SUBLANG_UZBEK_CYRILLIC          = $02;    ///Uzbek (Cyrillic)<br><br>///<br>///SortingIDs.<br>///<br><br>Const SORT_DEFAULT                    = $0;    ///sorting default<br><br>Const SORT_JAPANESE_XJIS              = $0;    ///Japanese XJIS order<br>Const SORT_JAPANESE_UNICODE            = $1;    ///Japanese Unicode order<br><br>Const SORT_CHINESE_BIG5                = $0;    ///Chinese BIG5 order<br>Const SORT_CHINESE_PRCP                = $0;    ///PRC Chinese Phonetic order<br>Const SORT_CHINESE_UNICODE            = $1;    ///Chinese Unicode order<br>Const SORT_CHINESE_PRC                = $2;    ///PRC Chinese Stroke Count order<br>Const SORT_CHINESE_BOPOMOFO            = $3;    ///Traditional Chinese Bopomofo order<br><br>Const SORT_KOREAN_KSC                  = $0;    ///KoreanKSC order<br>Const SORT_KOREAN_UNICODE              = $1;    ///Korean Unicode order<br><br>Const SORT_GERMAN_PHONE_BOOK          = $1;    ///German Phone Book order<br><br>Const SORT_HUNGARIAN_DEFAULT          = $0;    ///Hungarian Default order<br>Const SORT_HUNGARIAN_TECHNICAL        = $1;    ///Hungarian Technical order<br><br>Const SORT_GEORGIAN_TRADITIONAL        = $0;    ///Georgian Traditional order<br>Const SORT_GEORGIAN_MODERN            = $1;    ///Georgian Modern order<br><br>///<br>///Time Flags for GetTimeFormat.<br>///<br>Const TIME_NOMINUTESORSECONDS  = $1;  ///do not use minutes or seconds<br>Const TIME_NOSECONDS            = $2;  ///do not use seconds<br>Const TIME_NOTIMEMARKER        = $4;  ///do not use time marker<br>Const TIME_FORCE24HOURFORMAT    = $8;  ///always use 24 hour format<br><br><br>///<br>///Date Flags for GetDateFormat.<br>///<br>Const LOCALE_NOUSEROVERRIDE    = $80000000;<br>Const DATE_SHORTDATE            = $1;  ///use short date picture<br>Const DATE_LONGDATE            = $2;  ///use long date picture<br>Const DATE_USE_ALT_CALENDAR    = $4;  ///use alternate calendar (if any)<br>Const DATE_YEARMONTH            = $8;  ///use year month picture<br>Const DATE_LTRREADING          = $10;  ///add marks for left to right reading order layout<br>Const DATE_RTLREADING          = $20;  ///add marks for right to left reading order layout<br><br><br>function MakeLangId(usPrimaryLanguage,usSubLanguage : byte) : LANGID;<br>begin<br>Result := (usSubLanguage shl 10) or usPrimaryLanguage;<br>end;<br><br>function MakeLCID(wLanguageID,wSortID : word) : LCID;<br>begin<br>Result := (wSortId shl 16) or wLanguageID;<br>end;<br><br><br>///LCID GetUserDefaultLCID(VOID)<br>function GetUserDefaultLCID() : LCID; external<br>'GetUserDefaultLCID@kernel32.dll stdcall';<br><br>///LCID GetSystemDefaultLCID(VOID)<br>function GetSystemDefaultLCID() : LCID; external<br>'GetSystemDefaultLCID@kernel32.dll stdcall';<br><br><br>///<br>///  Default System and User IDs for language and locale. ///<br> var<br>LANG_SYSTEM_DEFAULT, LANG_USER_DEFAULT : LANGID;<br>LOCALE_USER_DEFAULT, LOCALE_NEUTRAL : LCID;<br> procedure InitLang();<br>begin<br>LANG_SYSTEM_DEFAULT := MakeLangId(LANG_NEUTRAL, SUBLANG_SYS_DEFAULT);<br>LANG_USER_DEFAULT := MakeLangId(LANG_NEUTRAL, SUBLANG_DEFAULT);<br>LOCALE_USER_DEFAULT  := MakeLCID(LANG_USER_DEFAULT, SORT_DEFAULT);<br>LOCALE_NEUTRAL        := MakeLCID(MakeLangId(LANG_NEUTRAL, SUBLANG_NEUTRAL), SORT_DEFAULT);<br>end;</code></td><script language="javascript" type="text/javascript">highlightSyntax('delphi_Tc4NTB','delphi');</script></font></blockquote><font style="BACKGROUND-COLOR: #ffffe3"><textarea id="taCode3" style="display:none;" rows="1" cols="5"></textarea><textarea id='taCode' style='display:none;' rows='1' cols='20'></textarea><br><div id="heading"><h1><font size="1" face="Consolas">Copyright (c) <a href="http://www.krinkels.org/" target="_blank">Krinkels Inc</a></font></h1></div></font></body></html>